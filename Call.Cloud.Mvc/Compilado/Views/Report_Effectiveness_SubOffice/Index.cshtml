@model Call.Cloud.Mvc.Models.Effectiveness.ListaReportSubOffice
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<head>
    <script type="text/javascript">
        var Report = Report || {};
        Report.Urls = Report.Urls || {};
        Report.Urls.baseUrl = '@Url.Action("~")';
        Report.Urls.reportSubOffice = '@Url.Action("Chart_SubOffice_Year_Vertical", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportMonthSubOffice = '@Url.Action("Chart_SubOffice_Month", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportDaySubOffice = '@Url.Action("Chart_SubOffice_Day", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportBusiness = '@Url.Action("Chart_Business_Year", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportMonthBusiness = '@Url.Action("Chart_Business_Month", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportDayBusiness = '@Url.Action("Chart_Business_Day", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportBoss = '@Url.Action("Chart_Boss_Year", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportMonthBoss = '@Url.Action("Chart_Boss_Month", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportDayBoss = '@Url.Action("Chart_Boss_Day", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportAgent = '@Url.Action("Chart_Agent_Year", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportMonthAgent = '@Url.Action("Chart_Agent_Month", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportDayAgent = '@Url.Action("Chart_Agent_Day", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportCallAgent = '@Url.Action("Agent_LLamada", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportSegmentadoBoss = '@Url.Action("Report_Effectiveness_Year", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportSegmentadoMonthBoss = '@Url.Action("Report_Effectiveness_Month", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportSegmentadoDayBoss = '@Url.Action("Report_Effectiveness_Day", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportSegmentadoAgent = '@Url.Action("Agent_Year", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportSegmentadoMonthAgent = '@Url.Action("Agent_Month", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportSegmentadoDayAgent = '@Url.Action("Agent_Day", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportSegmentadoCallAgent = '@Url.Action("Report_Agent_call", "Report_Effectiveness_SubOffice")';
   
        //dinámico
        Report.Urls.reportBossDinamico = '@Url.Action("dinamico0001", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportBossMonthDinamico = '@Url.Action("dinamico_Boss_Month", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportBossDayDinamico = '@Url.Action("dinamico_Boss_Day", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportAgentYearDinamico = '@Url.Action("dinamico_agent_Year", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportAgentMonthDinamico = '@Url.Action("dinamico_agent_Month", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportAgentDayDinamico = '@Url.Action("dinamico_Agent_Day", "Report_Effectiveness_SubOffice")';
        Report.Urls.reportAgentCallDinamico = '@Url.Action("dinamico_Agent_Call", "Report_Effectiveness_SubOffice")';

     </script>

    <link href="~/Content/css/chartist.min.css" rel="stylesheet" />

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>

<div class="page animsition">
    <div class="page-header">                   
        <div class="form-group form-material">
            <div class="col-sm-12">
                <div class="col-sm-3" style="width:150px;height:40px;"></div>
                <div class="col-sm-3" style="width:150px;height:40px;">
                    <h5>@Html.Label("pkOffice", "OFFICE", htmlAttributes: new { @class = "control-label col-sm-2" })</h5>
                </div>
                <div class="col-sm-3 text-right" style="width:700px;height:40px;">
                    @Html.DropDownListFor(model => model.Filtro.pk_office, Model.ListaOffice, new { @class = "form-control" })
                </div>
                <div class="col-sm-3 text-right" style="width:100px;height:40px;">
                    <button id="btnBuscar" class="btn btn-primary" type="button" onclick="graficaSubOfficeYear();">Buscar</button>
                </div>
            </div>
          </div>           
        </div>

        <!--Navegacion-->
        <div class="panel-body">
            <div class="form-group form-material">
                <h2 id="idEmpresa" style="text-align:center;color:chocolate"> </h2>                   
                <ul class="nav nav-tabs" style="float:left;">
                    <li id="subOfficeYear"><a href="#aaa" id="SubOfficeYear" style="color:chocolate; border-bottom:groove"></a></li>
                    <li id="businessYear"><a href="#bbb" id="BusinessYear" style="color:chocolate; border-bottom:groove"></a></li>
                    <li id="bossYear"><a href="#ccc" id="BossYear" style="color:chocolate; border-bottom:groove"></a></li>
                    <li id="agentYear"><a href="#ddd" id="AgentYear" style="color:chocolate; border-bottom:groove"></a></li>
                    <li id="subOfficeMonth"><a href="#kkk" id="SubOfficeMonth" style="color:darkred; border-bottom:groove"></a></li>
                    <li id="subOfficeDay"><a href="#lll" id="SubOfficeDay" style="color:darkred; border-bottom:groove"></a></li>
                    <li id="businessMonth"><a href="#nnn" id="BusinessMonth" style="color:darkred; border-bottom:groove"></a></li>
                    <li id="businessDay"><a href="#mmm" id="BusinessDay" style="color:darkred; border-bottom:groove"></a></li>
                    <li id="bossMonth"><a href="#ppp" id="BossMonth" style="color:darkred; border-bottom:groove"></a></li>
                    <li id="bossDay"><a href="#sss" id="BossDay" style="color:darkred; border-bottom:groove"></a></li>
                    <li id="agentMonth"><a href="#ttt" id="AgentMonth" style="color:darkred; border-bottom:groove"></a></li>
                    <li id="agentDay"><a href="#ñññ" id="AgentDay" style="color:darkred; border-bottom:groove"></a></li>
                    <li id="agentCall"><a href="#yyy" id="AgentCall" style="color:chocolate; border-bottom:groove"></a></li>
                </ul>             
            </div>

<!--Los div donde se ven las barras-->
            <div class="form-group form-material">
                <div id="divGrid01" class="col-sm-12">
                    <br />
                    <div class="col-sm-1">
                        <ul class="nav nav-tabs" style="float:left;">
                            <li><a href="#vistBA01" data-toggle="tab" id="btnBossAño1" style="display:none; ">Vista1</a></li>
                            <li><a href="#vistBA02" data-toggle="tab" id="btnBossAño2" style="display: none;">Vista2</a></li>
                        </ul>

                        <ul class="nav nav-tabs" style="float:left;">
                            <li><a href="#vistBM01" data-toggle="tab" id="btnBossMes1" style="display:none; ">Vista1</a></li>
                            <li><a href="#vistBM02" data-toggle="tab" id="btnBossMes2" style="display:none; ">Vista2</a></li>
                        </ul>

                        <ul class="nav nav-tabs" style="float:left;">
                            <li><a href="#vistBD01" data-toggle="tab" id="btnBossDia1" style="display:none; ">Vista1</a></li>
                            <li><a href="#vistBD02" data-toggle="tab" id="btnBossDia2" style="display: none; ">Vista2</a></li>
                        </ul>

                        <ul class="nav nav-tabs" style="float:left;">
                            <li><a href="#vistAA01" data-toggle="tab" id="btnAgentAño1" style="display:none; ">Vista1</a></li>
                            <li><a href="#vistAA02" data-toggle="tab" id="btnAgentAño2" style="display: none; ">Vista2</a></li>
                        </ul>

                        <ul class="nav nav-tabs" style="float:left;">
                            <li><a href="#vistAM01" data-toggle="tab" id="btnAgentMes1" style="display:none; ">Vista1</a></li>
                            <li><a href="#vistAM02" data-toggle="tab" id="btnAgentMes2" style="display: none; ">Vista2</a></li>
                        </ul>

                        <ul class="nav nav-tabs" style="float:left;">
                            <li><a href="#vistAD01" data-toggle="tab" id="btnAgentDia1" style="display:none; ">Vista1</a></li>
                            <li><a href="#vistAD02" data-toggle="tab" id="btnAgentDia2" style="display: none; ">Vista2</a></li>
                        </ul>

                        <ul class="nav nav-tabs" style="float:left;">
                            <li><a href="#vistAL01" data-toggle="tab" id="btnAgentLlamada1" style="display:none; ">Vista1</a></li>
                            <li><a href="#vistAL02" data-toggle="tab" id="btnAgentLlamada2" style="display: none; ">Vista2</a></li>
                        </ul>
                    </div>

                    <div id="contenedor" class="tab-content" style="overflow-x:scroll; overflow-y:hidden">
                        <div class="col-sm-11">
                            <div id="suboffice_div_chart" style="width:auto;"></div>
                        </div>
                    </div>
                </div>
            </div>
     </div>
</div>

<script type="text/javascript" src="https://www.google.com/jsapi"></script>

<!--Activar tabs-->
<script>
    function activaTab(tab) {
        $('.nav-tabs a[href="#' + tab + '"]').tab('show');
    };
    function desactivartab(tab) {
        $('.nav-tabs a[href="#' + tab + '"]').tab('hide');
    }
</script>

<!--Ocultar navegacion-->
<script>
    $(document).ready(function () {
        document.getElementById("subOfficeYear").style.display = 'none';
        document.getElementById("subOfficeMonth").style.display = 'none';
        document.getElementById("subOfficeDay").style.display = 'none';
        document.getElementById("businessYear").style.display = 'none';
        document.getElementById("businessMonth").style.display = 'none';
        document.getElementById("businessDay").style.display = 'none';
        document.getElementById("bossYear").style.display = 'none';
        document.getElementById("bossMonth").style.display = 'none';
        document.getElementById("bossDay").style.display = 'none';
        document.getElementById("agentYear").style.display = 'none';
        document.getElementById("agentMonth").style.display = 'none';
        document.getElementById("agentDay").style.display = 'none';
        document.getElementById("agentCall").style.display = 'none';
        document.getElementById("contenedor").style.display = 'none';

    })
</script>

<!--SubOffice por año-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });;
    var pk_suboffice01 = 0;
    var año01 = 0;
    var office = 0;
    function graficaSubOfficeYear() {
        office = $("#Filtro_pk_office").val();
        $("#contenedor").show();
        var parametros = {
            pk_office: office
        }
        
        var urlSubOffice = Report.Urls.reportSubOffice;
        
        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlSubOffice,
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'SubOffice');
                    data1.addColumn('number', 'Porcentaje de Eficacia por año- SubOficina');
                    data1.addColumn('number', 'Por debajo del criterio');

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].nameSubOffice, data[i].result, null]);
                                
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].nameSubOffice, null, data[i].result]);
                                
                            }
                        }
                    };
                    
                    var options = {

                        legend: { position: 'top', maxLines: 15 },
                        fontSize: "12",
                        chartArea: { width: '90%', },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        vAxis: { format: '#\'%\'' ,ticks:[0,20,40,60,80,100]},
                        bar: { groupWidth: 40 },
                        tooltip: { trigger: 'selection' },
                        isStacked: true,
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },
                    }
                    $(document).ready(function () {
                        $("#SubOfficeYear").click(function () {
                           
                                graficaSubOfficeYear();
                                //alert("mensaje");
                                $("#contenedor").show();
                                $("#officeYear").show();
                                $("#subOfficeYear").show();
                                $("#businessYear").hide();
                                $("#bossYear").hide();
                                $("#agentYear").hide();
                                $("#agentCall").hide();
                                $("#enterpriseMonth").hide();
                                $("#enterpriseDay").hide();
                                $("#officeMonth").hide();
                                $("#officeDay").hide();
                                $("#subOfficeMonth").hide();
                                $("#subOfficeDay").hide();
                                $("#businessMonth").hide();
                                $("#businessDay").hide();
                                $("#bossMonth").hide();
                                $("#bossDay").hide();
                                $("#agentMonth").hide();
                                $("#agentDay").hide();
                                $("#btnBossAño1").hide();
                                $("#btnBossAño2").hide();
                                $("#btnBossMes1").hide();
                                $("#btnBossMes2").hide();
                                $("#btnBossDia1").hide();
                                $("#btnBossDia2").hide();
                                $("#btnAgentAño1").hide();
                                $("#btnAgentAño2").hide();
                                $("#btnAgentMes1").hide();
                                $("#btnAgentMes2").hide();
                                $("#btnAgentDia1").hide();
                                $("#btnAgentDia2").hide();
                                $("#btnAgentLlamada1").hide();
                                $("#btnAgentLlamada2").hide();
                            
                        });
                    });

                    document.getElementById("SubOfficeYear").innerHTML = "Reporte de SubOficinas";
                    $("#subOfficeYear").show();
                    document.getElementById("idEmpresa").innerHTML = "Reporte de SubOficinas";
                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);

                    activaTab('aaa');
                    if (data.length <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));

                    chart.setAction({
                        id: 'Business',
                        text: 'Negocio',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                             data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            for (var i = 0; i < data.length; i++) {
                             
                                if (data[i].nameSubOffice == name) {
                                    pk_suboffice01 = data[i].pkSubOffice;
                                   
                                    año01 = data[i].año;
                                    
                                }
                            }
                            chart.draw(view, options);

                            if (pk_suboffice01!=0 && año01!=0) {
                                
                                    grafica_Business_year(pk_suboffice01, año01);
                                   
                                    document.getElementById("BusinessYear").innerHTML =
                                        "Reporte de Negocio del " + " " + año01;
                                    document.getElementById("businessYear").style.display = 'inline';
                                    document.getElementById("idEmpresa").innerHTML =
                                        "Reportes de Negocios del " + " " + año01;
                                    activaTab('bbb');

                                $(document).ready(function () {
                                    $("#BusinessYear").click(function () {
                                        
                                         grafica_Business_year(pk_suboffice01, año01);
                                            
                                            $("#officeYear").show();
                                            $("#subOfficeYear").show();
                                            $("#businessYear").show();
                                            $("#bossYear").hide();
                                            $("#agentYear").hide();
                                            $("#agentCall").hide();
                                            $("#enterpriseMonth").hide();
                                            $("#enterpriseDay").hide();
                                            $("#officeMonth").hide();
                                            $("#officeDay").hide();
                                            $("#subOfficeMonth").hide();
                                            $("#subOfficeDay").hide();
                                            $("#businessMonth").hide();
                                            $("#businessDay").hide();
                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").hide();
                                            $("#agentDay").hide();
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();

                                        
                                    });
                                });
                            }
                        }

                    });

                    chart.setAction({
                        id: 'mes',
                        text: 'Mes',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            
                            for (var i = 0; i < data.length; i++) {
                                var array = new Array();
                                if (data[i].nameSubOffice == name) {
                                    pk_suboffice01 = data[i].pkSubOffice;
                                     año01 = data[i].año;
                                    
                                }
                            }

                            chart.draw(view, options);
                            if (pk_suboffice01!=0 && año01!=0) {
                              
                                    grafica_subOffice_month(pk_suboffice01, año01);
                                    
                                    document.getElementById("idEmpresa").innerHTML =
                                        " Reporte de la SubOficina " + name + "del" + " "
                                        + año01 + " " + "por meses";
                                    document.getElementById("SubOfficeMonth").innerHTML =
                                     "SubOficina " + " " + name;
                                    document.getElementById("subOfficeMonth").style.display = 'inline';
                                    activaTab('kkk');

                                $(document).ready(function () {
                                    $("#SubOfficeMonth").click(function () {
                                        
                                           grafica_subOffice_month(pk_suboffice01, año01);
                               
                                            
                                            $("#officeYear").hide();
                                            $("#subOfficeYear").show();
                                            $("#businessYear").hide();
                                            $("#bossYear").hide();
                                            $("#agentYear").hide();
                                            $("#agentCall").hide();
                                            $("#enterpriseMonth").hide();
                                            $("#enterpriseDay").hide();
                                            $("#officeMonth").hide();
                                            $("#officeDay").hide();
                                            $("#subOfficeMonth").show();
                                            $("#subOfficeDay").hide();
                                            $("#businessMonth").hide();
                                            $("#businessDay").hide();
                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").hide();
                                            $("#agentDay").hide();
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();
                                        

                                    });
                                });
                            }
                        }
                    });
                    chart.draw(view, options);
                    
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }
</script>

<!--SubOffice por Mes-->
<script type="text/javascript">
    var mes01 = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    
    function grafica_subOffice_month(pkSubOffice, año) {
        var parametros = {
            pkSubOffice: pkSubOffice,
            año: año
        }
        
        var urlMesSubOffice = Report.Urls.reportMonthSubOffice;
        
        $(function () {
            $.ajax({
                type: 'POST',
                url: urlMesSubOffice,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Reporte de Eficacia por month- SubOffice');
                    data1.addColumn('number', 'Por debajo del criterio');

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);
                    
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };

                    $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                          mes01 = data1.getValue(select.row, 0);
                          
                            año01 = parametros.año;
                      
                            pk_suboffice01= parametros.pkSubOffice;
                           
                            for (var i = 0; i < data.length; i++) {
                                array = new Array();
                                if (data[i].pkSubOffice == pk_suboffice01) {
                                    var name = data[i].name;
                                 
                                }
                            }
                            if (pk_suboffice01!=0 && año01!=0 && mes01!="") {
                              
                                    graficasubOffice_Day(pk_suboffice01, año01, mes01);
                                    
                                    if (document.getElementById("idEmpresa")) {
                                        document.getElementById("idEmpresa").innerHTML =
                                            " Reporte de la SubOficina " + name + " " + "de" + " "
                                            + mes + " " + "del" + " " + año01;
                                        document.getElementById("SubOfficeDay").innerHTML = mes01
                                            + " " + "del" + " " + año01;
                                        document.getElementById("subOfficeDay").style = "inline";
                                        activaTab('lll');
                                    }                                
                            }
                        }
                        console.log(parametros);
                        
                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }
</script>

<!--SubOffice por dia-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function graficasubOffice_Day(pkSubOffice, año, month) {
        
        var parametros = {
            pkSubOffice: pkSubOffice,
            año: año,
            month: month
        }
        
        var urlDaySubOffice = Report.Urls.reportDaySubOffice;
        
        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDaySubOffice,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Reporte de Eficacia por dia- SubOffice');
                    data1.addColumn('number', 'Por debaje del criterio');

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);
                    
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                            }
                        }
                    };

                    if (data.length <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Business por Año-->
<script type="text/javascript">
    var pk_business01 = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Business_year(pkSubOffice, año) {
        
        var parametros = {
            pkSubOffice: pkSubOffice,
            año: año
        }
        
        var urlYearBusiness = Report.Urls.reportBusiness;
        

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlYearBusiness,

                data: { filtro: parametros },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'Business');
                    data1.addColumn('number', 'Reporte de Eficacia por mes - Business');
                    data1.addColumn('number', 'Por debajo del criterio');

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].nameBusiness, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].nameBusiness, null, data[i].result]);
                            }
                        }
                    };

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);

                    if (data.length <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));

                    chart.setAction({
                        id: 'Boss',
                        text: 'Supervisor',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                           año01 = parametros.año;
                          
                            for (var i = 0; i < data.length; i++) {
                                var array = new Array();
                                if (data[i].nameBusiness == name) {
                                    pk_business01 = data[i].pkBusiness;
                                  
                                }
                            }

                            chart.draw(view, options);
                            if (pk_business01!=0 && año01!=0) {
                               
                                    grafica_Boss_Year(pk_business01, año01);
                                    document.getElementById("BossYear").innerHTML =
                                        "Reporte de Supervisor del" + " " + año01;
                                    document.getElementById("bossYear").style.display = 'inline';
                                    document.getElementById("idEmpresa").innerHTML =
                                        "Reporte de Supervisores del " + " " + año01;
                                    activaTab('ccc');
                                
                                $(document).ready(function () {
                                    $("#BossYear").click(function () {
                                      
                                            grafica_Boss_Year(pk_business01, año01);
                                     
                                            
                                            $("#officeYear").show();
                                            $("#subOfficeYear").show();
                                            $("#businessYear").show();
                                            $("#bossYear").show();
                                            $("#agentYear").hide();
                                            $("#agentCall").hide();
                                            $("#enterpriseMonth").hide();
                                            $("#enterpriseDay").hide();
                                            $("#officeMonth").hide();
                                            $("#officeDay").hide();
                                            $("#subOfficeMonth").hide();
                                            $("#subOfficeDay").hide();
                                            $("#businessMonth").hide();
                                            $("#businessDay").hide();
                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").hide();
                                            $("#agentDay").hide();
                                            $("#btnBossAño1").show();
                                            $("#btnBossAño2").show();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();
                                        
                                    });
                                });

                                $(document).ready(function () {
                                    
                                    $("#btnBossAño1").click(function () {
                                        
                                       
                                            grafica_Boss_Year(pk_business01, año01);
                                         
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();

                                        
                                    });
                                });

                                $(document).ready(function () {
                                    
                                    $("#btnBossAño2").click(function () {
                                        
                                      
                                        grafica01BossSegmentado(pk_business01, año01);
                                           
                                        

                                    });
                                });

                            }
                        }

                    });

                    chart.setAction({
                        id: 'month',
                        text: 'Mes',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            año01 = parametros.año;
                            for (var i = 0; i < data.length; i++) {
                            
                                if (data[i].nameBusiness == name) {
                                    pk_business01 = data[i].pkBusiness;
                                   
                                }
                            }
                        
                            chart.draw(view, options);
                            if (pk_business01!=0 && año01!=0) {
                                
                                    grafica_Business_Month(pk_business01, año01);
                                    document.getElementById("idEmpresa").innerHTML =
                                        "Reporte del Negocio " + name + " " + "del" + " " + año01
                                        + " " + "por meses";
                                    document.getElementById("businessMonth").style.display = 'inline';
                                    document.getElementById("BusinessMonth").innerHTML = "Negocio " + " " + name;
                                    activaTab('nnn');

                                $(document).ready(function () {
                                    $("#BusinessMonth").click(function () {
                                        
                                            grafica_Business_Month(pk_business01, año01);
                                          
                                           
                                            $("#officeYear").show();
                                            $("#subOfficeYear").show();
                                            $("#businessYear").show();
                                            $("#bossYear").hide();
                                            $("#agentYear").hide();
                                            $("#agentCall").hide();
                                            $("#enterpriseMonth").hide();
                                            $("#enterpriseDay").hide();
                                            $("#officeMonth").hide();
                                            $("#officeDay").hide();
                                            $("#subOfficeMonth").hide();
                                            $("#subOfficeDay").hide();
                                            $("#businessMonth").show();
                                            $("#businessDay").hide();
                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").hide();
                                            $("#agentDay").hide();
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").show();
                                            $("#btnBossMes2").show();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();
                                        
                                    });
                                });
                            }
                        }
                    });
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Business por Mes-->
<script type="text/javascript">
    var mes02 = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Business_Month(pkBusiness, año) {
        
        var parametros = {
            pkBusiness: pkBusiness,
            año: año,
        }
        
        var urlMesBusiness = Report.Urls.reportMonthBusiness;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlMesBusiness,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Reporte de Eficacia por mes - Business');
                    data1.addColumn('number', 'Por debajo del criterio');

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);
                    
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };

                    $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                             mes02 = data1.getValue(select.row, 0);
                           
                            año01 = parametros.año;
                             pk_business01 = parametros.pkBusiness;
                            for (var i = 0; i < data.length; i++) {
                                var array = new Array();
                                if (data[i].pkBusiness == pk_business01) {
                                    var name = data[i].nameBusiness;
                                
                                }
                            }
                            if (pk_business01!=0 && mes02!="" && año01!=0) {
                               
                                    grafica_Business_Day(pk_business01, año01, mes02);
                                    document.getElementById("idEmpresa").innerHTML = " Reporte del Negocio " + name + " " + "de" + " " + mes02 + " " + "del" + " " + año01;
                                    document.getElementById("BusinessDay").innerHTML = mes + " " + "del" + " " + año01;
                                    document.getElementById("businessDay").style.display = 'inline';
                                    activaTab('mmm');
                                

                            }
                        }
                        console.log(parametros);
                        
                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Business por Dia-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Business_Day(pkBusiness, año, month) {
        
        var parametros = {
            pkBusiness: pkBusiness,
            año: año,
            month: month
        }
        
        var urlDiaBusiness = Report.Urls.reportDayBusiness;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDiaBusiness,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Reporte de Eficacia por dia - Business');
                    data1.addColumn('number', 'Por debajo del criterio');

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);
                   
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                            }
                        }
                    };

                    if (data.length <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Boss por Año-->
<script type="text/javascript">
    var pk_boss01 = 0;
    var PKbUSINESS = 0;
    var name_Boss = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Boss_Year(pkBusiness, año) {
        
        var parametros = {
            pkBusiness: pkBusiness,
            año: año
        }
        
        var urlYearBoss = Report.Urls.reportBoss;
        

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlYearBoss,
                data: { filtro: parametros },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'supervisor');
                    data1.addColumn('number', 'Reporte de Eficacia por Año - Boss');
                    data1.addColumn('number', 'Por debajo del criterio');

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].nameBoss, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].nameBoss, null, data[i].result]);
                            }
                        }
                    };

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    $("#btnBossAño1").show();
                    $("#btnBossAño2").show();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);

                    if (data.length <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistBA01');

                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));

                    chart.setAction({
                        id: 'Agent',
                        text: 'Agente',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            name_Boss = name;
                            año01= parametros.año;
                        
                            for (var i = 0; i < data.length; i++) {
                                array = new Array();
                                if (data[i].nameBoss == name) {
                                    pk_boss01 = data[i].pkBoss;
                                    PKbUSINESS = data[i].pkBusiness;
                                }
                            }

                            chart.draw(view, options);
                            if (pk_boss01!=0 && año01!=0) {
                                
                                grafica_Agent_Year(parametros.pkBusiness,pk_boss01, año01);
                                    document.getElementById("AgentYear").innerHTML = " Reporte de Agentes del " + " " + año01;
                                    document.getElementById("agentYear").style.display = 'inline';
                                    document.getElementById("idEmpresa").innerHTML =
                                        "Agentes del " + " " + año01;
                                    activaTab('ddd');
                                    activaTab('vistAA01');

                                $(document).ready(function () {
                                    $("#AgentYear").click(function () {
                                        
                                        grafica_Agent_Year(parametros.pkBusiness,pk_boss01, año01);
                                            activaTab('vistAA01');
                                            $("#officeYear").show();
                                            $("#subOfficeYear").show();
                                            $("#businessYear").show();
                                            $("#bossYear").show();
                                            $("#agentYear").show();
                                            $("#agentCall").hide();
                                            $("#enterpriseMonth").hide();
                                            $("#enterpriseDay").hide();
                                            $("#officeMonth").hide();
                                            $("#officeDay").hide();
                                            $("#subOfficeMonth").hide();
                                            $("#subOfficeDay").hide();
                                            $("#businessMonth").hide();
                                            $("#businessDay").hide();
                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").hide();
                                            $("#agentDay").hide();
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").show();
                                            $("#btnAgentAño2").show();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();
                                      
                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnAgentAño1").click(function () {
                                       
                                        grafica_Agent_Year(parametros.pkBusiness,pk_boss01, año01);
                                         
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                         
                                       
                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentAño2").click(function () {
                                       
                                           
                                        grafica01_Agent_Year(PKbUSINESS,pk_boss01, año01);
                                            
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                   
                                      

                                    });
                                });


                            }
                        }
                    });
                    chart.setAction({
                        id: 'month',
                        text: 'Mes',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                           año01 = parametros.año;

                            for (var i = 0; i < data.length; i++) {
                                var array = new Array();
                                if (data[i].nameBoss == name) {
                                    pk_boss01 = data[i].pkBoss;
                                   
                                    PKbUSINESS = data[i].pkBusiness;
                                }
                            }
                           
                            chart.draw(view, options);
                            if (pk_boss01!=0 && año01!=0) {
                                
                                    Boss_Month(pk_boss01, año01);
                                    document.getElementById("idEmpresa").innerHTML =
                                        "Reporte del Supervisor " + name + " " + "del" + " " + año01
                                        + " " + "por meses";
                                    document.getElementById("BossMonth").innerHTML = "Supervisor "
                                        + " " + name;
                                    document.getElementById("bossMonth").style.display = 'inline';
                                    activaTab('ppp');
                                    activaTab('vistBM01');
                                $(document).ready(function () {
                                    $("#BossMonth").click(function () {
                                       
                                           Boss_Month(pk_boss01, año01);
                                           activaTab('vistBM01');
                                            $("#officeYear").show();
                                            $("#subOfficeYear").show();
                                            $("#businessYear").show();
                                            $("#bossYear").show();
                                            $("#agentYear").hide();
                                            $("#agentCall").hide();
                                            $("#enterpriseMonth").hide();
                                            $("#enterpriseDay").hide();
                                            $("#officeMonth").hide();
                                            $("#officeDay").hide();
                                            $("#subOfficeMonth").hide();
                                            $("#subOfficeDay").hide();
                                            $("#businessMonth").hide();
                                            $("#businessDay").hide();
                                            $("#bossMonth").show();
                                            $("#bossDay").hide();
                                            $("#agentMonth").hide();
                                            $("#agentDay").hide();
                                            
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").show();
                                            $("#btnBossMes2").show();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();
                                     
                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnBossMes1").click(function () {
                                        
                                            Boss_Month(pk_boss01, año01);
                                      
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                           
                                      
                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossMes2").click(function () {
                                       
                                        grafica02(PKbUSINESS,pk_boss01, año01);
                                           
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                   

                                    });
                                });
                            }
                        }
                    });

                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Boss por Mes-->
<script type="text/javascript">
    var mes03 = "";
    var pkBusiness = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function Boss_Month(pkBoss, año) {
        
        var parametros = {
            pkBoss: pkBoss,
            año: año,
        }
        
        var urlMesBoss = Report.Urls.reportMonthBoss;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlMesBoss,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Reporte de Eficacia por Mes - Boss');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnBossMes1").show();
                    $("#btnBossMes2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };

                    $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            mes03 = data1.getValue(select.row, 0);
                          
                            año01= parametros.año;
                           
                            pk_boss01 = parametros.pkBoss;
                            

                            for (var i = 0; i < data.length; i++) {
                                var array = new Array();
                                if (data[i].pkBoss == pk_boss01) {
                                  var  name = data[i].nameBoss;
                                  pkBusiness = data[i].pkBusiness;
                                }
                            }

                            if (pk_boss01!=0 && mes03!="" && año01!=0) {
                             
                                    grafica_Boss_Day(pk_boss01, mes03, año01);
                                    document.getElementById("idEmpresa").innerHTML =
                                        " Reporte del Supervisor " + name + " " + "de" + " " + mes03
                                        + " " + "del" + " " + año01;
                                    document.getElementById("BossDay").innerHTML = mes03 + " "
                                        + "del" + " " + año01;
                                    document.getElementById("bossDay").style.display = 'inline';
                                    activaTab('sss');
                                    activaTab('vistBD01');

                                $(document).ready(function () {
                                    $("#btnBossDia1").click(function () {
                                       
                                            grafica_Boss_Day(pk_boss01, mes03, año01);
                                           
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                           
                                       
                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossDia2").click(function () {
                                      
                                        grafica03(pkBusiness,pk_boss01, mes03, año01);
                                          
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                       

                                    });
                                });

                            }
                        }

                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Boss por Día-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Boss_Day(pkBoss, month, año) {
        
        var parametros = {
            pkBoss: pkBoss,
            month: month,
            año: año
        }
        
        var urlDiaBoss = Report.Urls.reportDayBoss;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDiaBoss,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Reporte de Eficacia por dia - Boss');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").show();
                    $("#btnBossDia2").show();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);
                    
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                            }
                        }
                    };

                    if (data.length <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Agente por Año-->
<script type="text/javascript">
    var pk_agente01 = 0;
    var pkBusiness = 0;
    var name_Agent = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Agent_Year(pkBusiness,pkBoss, año) {
        
        var parametros = {
            pkBoss: pkBoss,
            año: año,
            pkBusiness: pkBusiness,
        }
        //alert(pkBusiness.toString());

        
        var urlAgente = Report.Urls.reportAgent;
        
        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlAgente,
                data: { filtro: parametros },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'Agent');
                    data1.addColumn('number', 'Reporte de Eficacia por Año - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnAgentAño1").show();
                    $("#btnAgentAño2").show();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].nameAgent, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].nameAgent, null, data[i].result]);
                            }
                        }
                    };

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);

                    if (data.length <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            año01 = parametros.año;
                            var name = data1.getValue(select.row, 0);
                            name_Agent = name;
                            for (var i = 0; i < data.length; i++) {
                              
                                if (data[i].nameAgent == name) {
                                    pk_agente01 = data[i].pkAgent;
                                    pkBusiness = data[i].pkBusiness;

                                }
                            }
                           
                            if (pk_agente01!=0 && año01!=0) {
                               
                                    grafica_Agent_Month(pk_agente01, año01);
                                    document.getElementById("idEmpresa").innerHTML =
                                        "Reporte del Agente " + name + " " + "del" + " " + año01
                                        + " " + "por meses";
                                    document.getElementById("AgentMonth").innerHTML = "Agente "
                                        + " " + name;
                                    document.getElementById("agentMonth").style.display = 'inline';
                                    activaTab('ttt');
                                    activaTab('vistAM01');
                                $(document).ready(function () {
                                    $("#AgentMonth").click(function () {                                   
                                           grafica_Agent_Month(pk_agente01, año01);
                                           activaTab('vistAM01');
                                            $("#officeYear").show();
                                            $("#subOfficeYear").show();
                                            $("#businessYear").show();
                                            $("#bossYear").show();
                                            $("#agentYear").show();
                                            $("#agentCall").hide();
                                            $("#enterpriseMonth").hide();
                                            $("#enterpriseDay").hide();
                                            $("#officeMonth").hide();
                                            $("#officeDay").hide();
                                            $("#subOfficeMonth").hide();
                                            $("#subOfficeDay").hide();
                                            $("#businessMonth").hide();
                                            $("#businessDay").hide();
                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").show();
                                            $("#agentDay").hide();
                                            
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").show();
                                            $("#btnAgentMes2").show();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();
                                      
                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnAgentMes1").click(function () {
                                       
                                            grafica_Agent_Month(pk_agente01, año01);
                                          
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                         
                                       
                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentMes2").click(function () {
                                      
                                        grafica02_Agent_Month(pkBusiness,pk_agente01, año01);
                                          
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                     

                                    });
                                });

                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Agente por Mes-->
<script type="text/javascript">
    var mes04 = "";
    var pkBusiness=0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Agent_Month(pkAgent, año) {
        
        var parametros = {
            pkAgent: pkAgent,
            año: año,
        }
        
        var urlMesAgent = Report.Urls.reportMonthAgent;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlMesAgent,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Reporte de Eficacia por Mes - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").show();
                    $("#btnAgentMes2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);
                    
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };

                    $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            mes04= data1.getValue(select.row, 0);
                       
                            año01 = parametros.año;
                          pk_agente01 = parametros.pkAgent;
                            for (var i = 0; i < data.length; i++) {
                         
                                if (data[i].pkAgent == pk_agente01) {
                                    name = data[i].nameAgent;
                                    pkBusiness = data[i].pkBusiness;
                                }
                            }
                          
                            if (pk_agente01!=0 && mes04!="" && año01!=0) {
                              
                                    grafica_Agent_Day(pk_agente01, mes04, año01);
                                    document.getElementById("idEmpresa").innerHTML =
                                        "Reporte del Agente " + name + " " + "de" + " " + mes04
                                        + " " + "del" + " " + año01;
                                    document.getElementById("AgentDay").innerHTML = mes04 + " " + "del" + " " + año01;
                                    document.getElementById("agentDay").style.display = 'inline';
                                    activaTab('ñññ');
                                    activaTab('vistAD01');
                             
                                $(document).ready(function () {
                                    $("#AgentDay").click(function () {
                                       
                                          grafica_Agent_Day(pk_agente01, mes04, año01);
                                          activaTab('vistAD01');
                                            $("#officeYear").show();
                                            $("#subOfficeYear").show();
                                            $("#businessYear").show();
                                            $("#bossYear").show();
                                            $("#agentYear").show();
                                            $("#agentCall").hide();
                                            $("#enterpriseMonth").hide();
                                            $("#enterpriseDay").hide();
                                            $("#officeMonth").hide();
                                            $("#officeDay").hide();
                                            $("#subOfficeMonth").hide();
                                            $("#subOfficeDay").hide();
                                            $("#businessMonth").hide();
                                            $("#businessDay").hide();
                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").show();
                                            $("#agentDay").show();
                                            
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").show();
                                            $("#btnAgentDia2").show();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();
                                      
                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentDia1").click(function () {
                                      
                                            grafica_Agent_Day(pk_agente01, mes04, año01);
                                           
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                           
                                         
                                       
                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentDia2").click(function () {
                                      
                                        grafica03_Agent_Day(pkBusiness,pk_agente01, mes04, año01);
                                          
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                          
                                       

                                    });
                                });

                            }
                        }
                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Agente por Día-->
<script type="text/javascript">
    var day01 = "";
    var pkBusiness = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Agent_Day(pkAgent, month, año) {
        var parametros = {
            pkAgent: pkAgent,
            month: month,
            año: año
        }
        
        var urlDiaAgent = Report.Urls.reportDayAgent;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDiaAgent,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Reporte de Eficacia por dia - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").show();
                    $("#btnAgentDia2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);

                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);
                   
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                            }
                        }
                    };

                    console.log(data);

                    if (data.length <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));

                    function selectItem() {
                        for (var i = 0; i < data.length; i++) {
                          
                            if (data[i].pkAgent == pk_agente01) {
                                var name = [data[i].nameAgent];
                                pkBusiness = data[i].pkBusiness;
                            }
                        };

                        var select = chart.getSelection()[0];
                        if (select) {
                           pk_agente01= parametros.pkAgent;
                            
                            day01 = data1.getValue(select.row, 0);
                        
                            if (pk_agente01!=0 && day01!="") {
                              
                                    Report_Call(pk_agente01, day01);
                                    
                                    document.getElementById("agentCall").style.display = 'inline';
                                    document.getElementById("AgentCall").innerHTML =
                                        "Llamadas del agente " + name + " " +
                                        "del" + " " + day01;
                                    activaTab('yyy');
                                    activaTab('vistAL01');

                                $(document).ready(function () {
                                    $("#btnAgentLlamada1").click(function () {                                      
                                            Report_Call(pk_agente01, day01);
                                            activaTab('vistAL01');
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                          
                                       
                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentLlamada2").click(function () {
                                     
                                        Report_Call_Segmentado(pkBusiness, pk_agente01, day01);
                                            
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                         
                                    

                                    });
                                });

                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Agente por llamada-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function Report_Call(pkAgent, dias) {
        
        var parametros = {
            pkAgent: pkAgent,
            dias: dias
        };
        
        var urlCallAgent = Report.Urls.reportCallAgent;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlCallAgent,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'Call');
                    data1.addColumn('number', 'Reporte de Eficacia por Llamada - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").show();
                    $("#btnAgentLlamada2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);

                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }

                    ]);

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].hora, data[i].result, null]);
                                
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].hora, null, data[i].result]);
                            }
                        }
                    };

                    console.log(data);

                    if (data.length <= 12) {
                        $("#suboffice_div_chart").css({ "height": "500px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#suboffice_div_chart").css({ "height": "500px", "width": ancho });
                    }

                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));

                    chart.draw(view, options);
                    
                },
                error: function () {
                    
                    console.log(data);

                }

            })

        });
    }

</script>

<!--Seccionado por Boss-->
<!--Seccionado de Boss por Año-->
<script type="text/javascript">
    google.load("visualization", "1", { packages: ['corechart'] });
    function grafica01BossSegmentado(pkBusiness,año) {
        var parametros = {
            pkBusiness: pkBusiness,
            año: año,
        }
        
        urlBossAnio = Report.Urls.reportBossDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlBossAnio,
                data: { filtro: parametros },
                success: function (data) {

                    var data1 = new google.visualization.DataTable();

                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var countdata = countReg - 1;
                    var result = [];
                    var totl = countReg;


                    //Ingresa los datos
                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "nameBoss") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            if (parseInt(data[i].Value) == "") {
                                data[i].Value = 0;

                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "nameBoss") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);

                    $("#btnBossAño1").show();
                    $("#btnBossAño2").show();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();



                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection', showColorCode: true, isHtml: false },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistBA02');
                    document.getElementById("idEmpresa").innerHTML = "Reporte de Supervisores del " + " " + año01;
                    document.getElementById("BossYear").innerHTML = "Reporte de Supervisores por año";
                    $("#BossYear01").show();

                    
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));

                    chart.setAction({
                        id: 'Agent1',
                        text: 'Agente',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1) + 20);
                            var name = data1.getValue(chart.getSelection()[0].row, 0);

                            for (var i = 0; i < data.length; i++) {

                                if (data[i].Header == "nameBoss") {
                                    if (data[i].Value == name) {
                                        pk_boss01 = data[i].pk_boss;
                                        año01 = data[i].year;
                                    }
                                }
                            }



                            chart.draw(data1, options);
                            if (pk_boss01 != 0 && año01 != 0) {

                                grafica01_Agent_Year(parametros.pkBusiness, pk_boss01, año01);

                                document.getElementById("AgentYear").innerHTML = "Reporte de Agentes del" + " " + año01;
                                document.getElementById("agentYear").style.display = 'inline';
                                activaTab('rrr');

                                $(document).ready(function () {
                                    $("#AgentYear").click(function () {
                                        grafica_agent_year(pk_boss01, año01);
                                        $("#subOfficeYear").show();
                                        $("#businessYear").show();
                                        $("#BossYear01").show();
                                        $("#agentYear").show();

                                        $("#btnAgentAño1").show();
                                        $("#btnAgentAño2").show();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();



                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnAgentAño1").click(function () {

                                        grafica_Agent_Year(parametros.pkBusiness,pk_boss01, año01);


                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentAño2").click(function () {



                                        grafica01_Agent_Year(parametros.pkBusiness, pk_boss01, año01);
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });


                            }
                        }

                    });
                    chart.setAction({
                        id: 'Month',
                        text: 'Mes',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1) - 20);
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            name_Boss = name;
                            for (var i = 0; i < data.length; i++) {

                                if (data[i].Header == "nameBoss") {
                                    if (data[i].Value == name) {
                                        pk_boss01 = data[i].pk_boss;
                                        año01 = data[i].year;
                                    }
                                }
                            }

                            chart.draw(data1, options);
                            if (pk_boss01 != 0 && año01 != "") {

                                grafica02(parametros.pkBusiness ,pk_boss01, año01);

                                document.getElementById("BossMonth").innerHTML = "Supervisor " + " " + name;
                                document.getElementById("bossMonth").style.display = 'inline';
                                activaTab('ppp');

                                $(document).ready(function () {
                                    $("#BossMonth").click(function () {

                                        Boss_Month(pk_boss01, año01);

                                        $("#subOfficeYear").show();
                                        $("#businessYear").show();
                                        $("#BossYear01").show();

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").show();
                                        $("#btnBossMes2").show();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossMes1").click(function () {
                                        Boss_Month(pk_boss01, año01);
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossMes2").click(function () {

                                        grafica02(parametros.pkBusiness, pk_boss01, año01);


                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });
                            }

                        }
                    })
                    //chart.draw(data1, options);
                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);

                    }
                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Seccionado de Boss por Mes-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });

    function grafica02(pk_business,pkBoss, año) {
        var parametros = {
            pkBusiness: pk_business,
            pkBoss: pkBoss,
            año: año,
        };
        
        urlBossMes = Report.Urls.reportBossMonthDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlBossMes,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', 'mes');
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "Month") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }


                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "Month") {

                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);


                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnBossMes1").show();
                    $("#btnBossMes2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistBD02');

                    document.getElementById("idEmpresa").innerHTML = "Reporte del Supervisor " + '<b>' + '«' + name_Boss + '»' + '</b>' + " " + "por meses de" + " " + '<b>' + parametros.año + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));
                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            mes03 = data1.getValue(select.row, 0);

                           año01 = parametros.año;
                           pk_boss01 = parametros.pkBoss;
                            for (var i = 0; i < data.length; i++) {
                                var array = new Array();
                                if (data[i].pkBoss == pk_boss01) {
                                    var name = data[i].nameBoss;

                                }
                            }
                            if (pk_boss01!=0 && mes03!="" && año01!=0) {

                                    grafica03(parametros.pkBusiness ,pk_boss01, mes03, año01);

                                    document.getElementById("BossDay").innerHTML = mes01 + " " + "del" + " " + año01;
                                    document.getElementById("bossDay").style.display = 'inline';
                                    activaTab('sss');

                                $(document).ready(function () {
                                    $("#btnBossDia1").click(function () {

                                            grafica_Boss_Day(pk_boss01, mes03, año01);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossDia2").click(function () {

                                        grafica03(parametros.pkBusiness, pk_boss01, mes03, año01);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();



                                    });
                                });

                            }
                        }

                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    //chart.draw(data1, options);
                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);

                    }
                    chart.draw(view, options);
                },
                error: function () {

                    console.log(data);
                }
            })
        });
    }

</script>

<!--Seccionado de Boss por Dia-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica03(pk_business,pkBoss, month, año) {
        var parametros = {
            pkBusiness:pk_business,
            pkBoss: pkBoss,
            month: month,
            año: año
        };
        
        urlBossDia = Report.Urls.reportBossDayDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlBossDia,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', 'mes');
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "Datecreated") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }

                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "Datecreated") {

                            var value = data[i].Value.toString();
                            var rs = value.substring(0, 10);
                            result.push(rs);
                        }


                    }
                    data1.addRow(result);

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        tooltip: { showColorCode: true, isHtml: false },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };



                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").show();
                    $("#btnBossDia2").show();



                    if (data1.getNumberOfRows() <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistBD02');
                    document.getElementById("idEmpresa").innerHTML = "Reporte del Supervisor " + '<b>' + '«' + name_Boss + '»' + '</b>' + " por dias del mes " + '<b>' + parametros.month + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));
                    //chart.draw(data1, options);
                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);

                    }
                    chart.draw(view, options);

                },
                error: function () {
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Seccionado por Agente-->
<!--Seccionado de Agente por Año-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica01_Agent_Year(pk_business,pkBoss, año) {
        var parametros = {
            pkBusiness: pk_business,
            pkBoss: pkBoss,
            añoPa: año
        }
        
        urlAgenteanio = Report.Urls.reportAgentYearDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlAgenteanio,
                data: { filtro: parametros },
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "nameAgent") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "nameAgent") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);

                    $("#btnAgentAño1").show();
                    $("#btnAgentAño2").show();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();



                    $(document).ready(function () {
                        $("#agente1").click(function () {
                            if ($("#chart04").val().length == 0) {
                                $("#chart04").show();
                                window.setTimeout(grafica01_Agent_Year(parametros.pkBusiness,pkBoss, año), 100);
                                $("#chart02").hide();
                                $("#chart03").hide();
                                $("#chart05").hide();
                                $("#chart06").hide();
                                $("#chart01").hide();
                                $("#dayBoss").hide();
                                $("#chart07").hide();

                                $("#llamadas").hide();
                                $("#ejemplo05").show();
                                $("#ejemplo06").hide();

                            }
                        });
                    });

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection', showColorCode: true, isHtml: false },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };




                    if (data1.getNumberOfRows() <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAA02');

                    document.getElementById("idEmpresa").innerHTML = "Reporte de Agentes del " + " " + parametros.añoPa;
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));
                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            año01 = parametros.añoPa;

                            var name = data1.getValue(select.row, 0);
                            name_Agent = name;;
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].Header == "nameAgent") {
                                    if (data[i].Value == name) {
                                        pk_agente01 = data[i].pk_agent;

                                    }
                                }
                            }


                            if (pk_agente01!=0 && año01!=0) {


                                    grafica02_Agent_Month(parametros.pkBusiness, pk_agente01, año01);

                                    document.getElementById("AgentMonth").innerHTML = "Agente " + " " + name;
                                    document.getElementById("agentMonth").style.display = 'inline';
                                    activaTab('ttt');

                                $(document).ready(function () {
                                    $("#AgentMonth").click(function () {

                                           grafica_Agent_Month(pk_agente01, año01);


                                            $("#officeYear").show();
                                            $("#subOfficeYear").show();
                                            $("#businessYear").show();
                                            $("#bossYear").show();
                                            $("#agentYear").show();
                                            $("#agentCall").hide();
                                            $("#enterpriseMonth").hide();
                                            $("#enterpriseDay").hide();
                                            $("#officeMonth").hide();
                                            $("#officeDay").hide();
                                            $("#subOfficeMonth").hide();
                                            $("#subOfficeDay").hide();
                                            $("#businessMonth").hide();
                                            $("#businessDay").hide();
                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").show();
                                            $("#agentDay").hide();

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").show();
                                            $("#btnAgentMes2").show();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentMes1").click(function () {

                                            grafica_Agent_Month(pk_agente01, año01);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentMes2").click(function () {


                                        grafica02_Agent_Month(parametros.pkBusiness, pk_agente01, año01);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();


                                    });
                                });

                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    //chart.draw(data1, options);
                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);

                    }
                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Seccionado de Agente por Mes-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });

    function grafica02_Agent_Month(pk_business,pkAgent, año) {
        var parametros = {
            pkBusiness: pk_business,
            pkAgent: pkAgent,
            año: año
        }
        
        urlAgenteMes = Report.Urls.reportAgentMonthDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlAgenteMes,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "MONTH") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "MONTH") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);


                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").show();
                    $("#btnAgentMes2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        tooltip: { showColorCode: true, isHtml: false },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAM02');

                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + '<b>' + '«' + name_Agent + '»' + '</b>' + " " + "por meses de" + " " + '<b>' + parametros.año + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                           mes04= data1.getValue(select.row, 0);

                            año01 = parametros.año;
                           pk_agente01= parametros.pkAgent;
                            for (var i = 0; i < data.length; i++) {
                                var array = new Array();
                                if (data[i].pkAgent == pk_agente01) {
                                   var name = data[i].nameAgent;


                                }
                            }
                            if (pk_agente01!=0 && mes04!="" && año01!=0) {

                                    grafica03_Agent_Day(parametros.pkBusiness, pk_agente01, mes04, año01);

                                    document.getElementById("AgentDay").innerHTML = mes04 + " "
                                        + "del" + " " + año01;
                                    document.getElementById("agentDay").style.display = 'inline';
                                    activaTab('ñññ');



                                $(document).ready(function () {
                                    $("#AgentDay").click(function () {

                                            grafica_Agent_Day(pk_agente01, mes04, año01);

                                            $("#officeYear").show();
                                            $("#subOfficeYear").show();
                                            $("#businessYear").show();
                                            $("#BossYear01").show();
                                            $("#agentYear").show();
                                            $("#agentCall").hide();
                                            $("#enterpriseMonth").hide();
                                            $("#enterpriseDay").hide();
                                            $("#officeMonth").hide();
                                            $("#officeDay").hide();
                                            $("#subOfficeMonth").hide();
                                            $("#subOfficeDay").hide();
                                            $("#businessMonth").hide();
                                            $("#businessDay").hide();
                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").show();
                                            $("#agentDay").show();

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").show();
                                            $("#btnAgentDia2").show();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();


                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnAgentDia1").click(function () {

                                            grafica_Agent_Day(pk_agente01, mes04, año01);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentDia2").click(function () {

                                        grafica03_Agent_Day(parametros.pkBusiness, pk_agente01, mes04, año01);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();



                                    });
                                });

                            }
                        }

                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    //chart.draw(data1, options);
                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);

                    }
                    chart.draw(view, options);

                },
                error: function () {

                    console.log(data);
                }
            })
        });
    }

</script>

<!--Seccionado de Agente por Dia-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica03_Agent_Day(pk_business ,pkAgent, month, año) {
        var parametros = {
            pkBusiness: pk_business,
            pkAgent: pkAgent,
            month: month,
            año: año
        }
        
        urlAgenteDia = Report.Urls.reportAgentDayDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlAgenteDia,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "DateCreated") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "DateCreated") {
                            var values = data[i].Value.toString();
                            var value = values.substring(0, 10);
                            result.push(value);
                        }


                    }
                    data1.addRow(result);
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();
                    $("#btnAgentDia1").show();
                    $("#btnAgentDia2").show();


                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        tooltip: { showColorCode: true, isHtml: false },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAD02');
                    
                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + '<b>' + '«' + name_Agent + '»' + '</b>' + " por dias del mes " + '<b>' + parametros.month + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));
                    function selectItem() {
                        var select = chart.getSelection()[0];
                        pk_agente01 = parametros.pkAgent;
                        dia01 = data1.getValue(select.row, 0);

                        var name = "";
                        for (var i = 0; i < data.length; i++) {

                            if (data[i].pkAgent == pk_agente01) {
                                name = data[i].nameAgent;
                            }
                        }

                        if (select) {
                            if (pk_agente01 != 0 && dia01 != "") {

                                Report_Call_Segmentado(parametros.pkBusiness, pk_agente01, dia01);
                                document.getElementById("AgentCall").innerHTML = "Llamadas del Agente " + name_Agent + " " + "del mes" + " " + parametros.month;


                                document.getElementById("agentCall").style.display = 'inline';
                                activaTab('yyy');

                                $(document).ready(function () {
                                    $("#btnAgentLlamada1").click(function () {

                                        Report_Call(pk_agente01, dia01);
                                        $("#agent_div_call").show();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentLlamada2").click(function () {

                                        Report_Call_Segmentado(parametros.pkBusiness, pk_agente01, dia01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    //chart.draw(data1, options);
                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);

                    }
                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Seccionado de Agente por Llamada-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function Report_Call_Segmentado(pk_business,pkAgent, dias) {
        var parametros = {
            pkBusiness: pk_business,
            pkAgent: pkAgent,
            dias: dias
        };
        
        urlAgenteLlamada = Report.Urls.reportAgentCallDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlAgenteLlamada,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "hours") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "hours") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").show();
                    $("#btnAgentLlamada2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };


                    if (data1.getNumberOfRows() <= 12) {
                        $("#suboffice_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#suboffice_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAL02');
                    
                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + '<b>' + '«' + name_Agent + '»' + '</b>' + " de las llamadas del " + '<b>' + parametros.dias + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("suboffice_div_chart"));
                    //chart.draw(data1, options);
                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);

                    }
                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);
                }

            })

        });
    }

</script>