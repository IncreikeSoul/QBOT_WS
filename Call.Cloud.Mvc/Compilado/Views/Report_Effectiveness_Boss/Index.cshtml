@model Call.Cloud.Mvc.Models.Effectiveness.ListaReportBoss
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<head>
    <script type="text/javascript">
        var Report = Report || {};
        Report.Urls = Report.Urls || {};
        Report.Urls.baseUrl = '@Url.Action("~")';
        Report.Urls.reportBoss = '@Url.Action("Chart_Boss_Year_Vertical", "Report_Effectiveness_Boss")';
        Report.Urls.reportMonthBoss = '@Url.Action("Chart_Boss_Month", "Report_Effectiveness_Boss")';
        Report.Urls.reportDayBoss = '@Url.Action("Chart_Boss_Day", "Report_Effectiveness_Boss")';
        Report.Urls.reportAgent = '@Url.Action("Chart_Agent_Year", "Report_Effectiveness_Boss")';
        Report.Urls.reportMonthAgent = '@Url.Action("Chart_Agent_Month", "Report_Effectiveness_Boss")';
        Report.Urls.reportDayAgent = '@Url.Action("Chart_Agent_Day", "Report_Effectiveness_Boss")';
        Report.Urls.reportCallAgent = '@Url.Action("Agent_LLamada", "Report_Effectiveness_Boss")';
        Report.Urls.reportSegmentadoBoss = '@Url.Action("Report_Effectiveness_Year", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoMonthBoss = '@Url.Action("Report_Effectiveness_Month", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoDayBoss = '@Url.Action("Report_Effectiveness_Day", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoAgent = '@Url.Action("Agent_Year", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoMonthAgent = '@Url.Action("Agent_Month", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoDayAgent = '@Url.Action("Agent_Day", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoCallAgent = '@Url.Action("Report_Agent_call", "Report_Effectiveness_Business")';
   
        //dinámico
        Report.Urls.reportBossDinamico = '@Url.Action("dinamico0001", "Report_Effectiveness_Boss")';
        Report.Urls.reportBossMonthDinamico = '@Url.Action("dinamico_Boss_Month", "Report_Effectiveness_Boss")';
        Report.Urls.reportBossDayDinamico = '@Url.Action("dinamico_Boss_Day", "Report_Effectiveness_Boss")';
        Report.Urls.reportAgentYearDinamico = '@Url.Action("dinamico_agent_Year", "Report_Effectiveness_Boss")';
        Report.Urls.reportAgentMonthDinamico = '@Url.Action("dinamico_agent_Month", "Report_Effectiveness_Boss")';
        Report.Urls.reportAgentDayDinamico = '@Url.Action("dinamico_Agent_Day", "Report_Effectiveness_Boss")';
        Report.Urls.reportAgentCallDinamico = '@Url.Action("dinamico_Agent_Call", "Report_Effectiveness_Boss")';
     </script>

    <link href="~/Content/css/chartist.min.css" rel="stylesheet" />
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>

<div class="page animsition">
    <div class="page-header">
        <div class="form-group form-material">
            <div class="col-sm-12">
                <div class="col-sm-3" style="width:150px;height:40px;"></div>
                <div class="col-sm-3" style="width:150px;height:40px;">
                    <h5>@Html.Label("pkBusiness", "BUSINESS", htmlAttributes: new { @class = "control-label col-sm-2" })</h5>
                </div>
                <div class="col-sm-3 text-right" style="width:700px;height:40px;">
                    @Html.DropDownListFor(model => model.Filtro.pkBusiness, Model.ListarBusiness, new { @class = "form-control" })
                </div>
                <div class="col-sm-3 text-right" style="width:100px;height:40px;">
                    <button id="btnBuscar" class="btn btn-primary" type="button" onclick="grafica_Boss_Year();">Buscar</button>
                </div>
            </div>
        </div>
    </div>           

    <!--Navegacion-->
    <div class="panel-body">
        <div class="form-group form-material">
            <h2 id="idEmpresa" style="text-align:center;color:chocolate"> </h2>                       
            <ul class="nav nav-tabs" style="float:left;">
                <li id="bossYear"><a href="#aaa" id="BossYear" style="color:chocolate; border-bottom:groove"></a></li>
                <li id="agentYear"><a href="#bbb" id="AgentYear" style="color:chocolate; border-bottom:groove"></a></li>

                <li id="bossMonth"><a href="#ppp" id="BossMonth" style="color:darkred; border-bottom:groove"></a></li>
                <li id="bossDay"><a href="#sss" id="BossDay" style="color:darkred; border-bottom:groove"></a></li>

                <li id="agentMonth"><a href="#ttt" id="AgentMonth" style="color:darkred; border-bottom:groove"></a></li>
                <li id="agentDay"><a href="#ñññ" id="AgentDay" style="color:darkred; border-bottom:groove"></a></li>

                <li id="agentCall"><a href="#yyy" id="AgentCall" style="color:chocolate; border-bottom:groove"></a></li>
            </ul>                     
        </div>

    <!--Los div donde se ven las barras-->
        <div class="form-group form-material">
            <div id="divGrid01" class="col-sm-12">
                <br />
                <div class="col-sm-1">
                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistBA01" data-toggle="tab" id="btnBossAño1" style="display:none; ">Vista1</a></li>
                        <li><a href="#vistBA02" data-toggle="tab" id="btnBossAño2" style="display: none;">Vista2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistBM01" data-toggle="tab" id="btnBossMes1" style="display:none; ">Vista1</a></li>
                        <li><a href="#vistBM02" data-toggle="tab" id="btnBossMes2" style="display:none; ">Vista2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistBD01" data-toggle="tab" id="btnBossDia1" style="display:none; ">Vista1</a></li>
                        <li><a href="#vistBD02" data-toggle="tab" id="btnBossDia2" style="display: none; ">Vista2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistAA01" data-toggle="tab" id="btnAgentAño1" style="display:none; ">Vista1</a></li>
                        <li><a href="#vistAA02" data-toggle="tab" id="btnAgentAño2" style="display: none; ">Vista2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistAM01" data-toggle="tab" id="btnAgentMes1" style="display:none; ">Vista1</a></li>
                        <li><a href="#vistAM02" data-toggle="tab" id="btnAgentMes2" style="display: none; ">Vista2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistAD01" data-toggle="tab" id="btnAgentDia1" style="display:none; ">Vista 1</a></li>
                        <li><a href="#vistAD02" data-toggle="tab" id="btnAgentDia2" style="display: none; ">Vista 2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistAL01" data-toggle="tab" id="btnAgentLlamada1" style="display:none; ">Vista 1</a></li>
                        <li><a href="#vistAL02" data-toggle="tab" id="btnAgentLlamada2" style="display: none; ">Vista 2</a></li>
                    </ul>
                </div>

                <div id="contenedor" class="tab-content" style="overflow-x:scroll; overflow-y:hidden">
                    <div class="col-sm-11">
                        <div id="boss_div_chart"></div>
                    </div>
                </div>
</div>
</div>
</div>
</div>

<!--Activar Tabs-->
<script>
    function activaTab(tab) {
        $('.nav-tabs a[href="#' + tab + '"]').tab('show');
    };
    function desactivartab(tab) {
        $('.nav-tabs a[href="#' + tab + '"]').tab('hide');
    }

</script>

<!--Ocultar navegacion-->
<script>
    $(document).ready(function () {
        document.getElementById("bossYear").style.display = 'none';
        document.getElementById("bossMonth").style.display = 'none';
        document.getElementById("bossDay").style.display = 'none';
        document.getElementById("agentYear").style.display = 'none';
        document.getElementById("agentMonth").style.display = 'none';
        document.getElementById("agentDay").style.display = 'none';
        document.getElementById("agentCall").style.display = 'none';
        document.getElementById("contenedor").style.display = 'none';
    })
</script>

<!--Boss por Año-->
<script type="text/javascript">
    var business = 0;
    var pkBoss00 = 0;
    var año00 = 0;
    var name_Boss = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Boss_Year() {
        
        business = $("#Filtro_pkBusiness").val();
        $("#contenedor").show();

        var parametros = {
            pkBusiness: business,
        };
        var urlYearBoss = Report.Urls.reportBoss;
        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlYearBoss,
                data: { filtro: parametros },
                success: function (data) {

                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'supervisor');
                    data1.addColumn('number', 'Reporte de Eficacia por Año - Boss');
                    data1.addColumn('number', 'Por debajo del criterio');

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].nameBoss, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].nameBoss, null, data[i].result]);
                            }
                        }
                    };

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    $("#btnBossAño1").show();
                    $("#btnBossAño2").show();


                    for (var i = 0; i < data.length; i++) {
                        if (data[i].pkBusiness==parametros.pkBusiness) {
                            año00 = data[i].año;
                        }
                    }


                    $(document).ready(function () {
                        // btn 01
                        $("#btnBossAño1").on("click", function () {
                            grafica_Boss_Year();
                        });

                        //btn 02
                        $("#btnBossAño2").on("click", function () {

                            if (business!=0) {
                                grafica01BossSegmentado(business);
                            }
                        });

                    });

                    //boton de regresar
                    $(document).ready(function () {
                        $("#BossYear").click(function () {
                            if (business!=0) {
                                grafica_Boss_Year(business);
                            }
                                $("#bossMonth").hide();
                                $("#bossDay").hide();
                                $("#agentYear").hide();
                                $("#agentMonth").hide();
                                $("#agentDay").hide();
                                
                                $("#btnBossAño1").show();
                                $("#btnBossAño2").show();
                                $("#btnBossMes1").hide();
                                $("#btnBossMes2").hide();
                                $("#btnBossDia1").hide();
                                $("#btnBossDia2").hide();
                                $("#btnAgentAño1").hide();
                                $("#btnAgentAño2").hide();
                                $("#btnAgentMes1").hide();
                                $("#btnAgentMes2").hide();
                                $("#btnAgentDia1").hide();
                                $("#btnAgentDia2").hide();
                                $("#btnAgentLlamada1").hide();
                                $("#btnAgentLlamada2").hide();

                        });
                    });

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);

                    $("#bossYear").show();
                    document.getElementById("BossYear").innerHTML = "Reporte de Surpervisores";
                    document.getElementById("idEmpresa").innerHTML = "Reporte de Supervisores";
                    activaTab('aaa');

                    
                    if (data.length <= 12) {
                        $("#boss_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#boss_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    activaTab('vistBA01');

                    var chart = new google.visualization.ColumnChart(document.getElementById("boss_div_chart"));

                    chart.setAction({
                        id: 'Agent',
                        text: 'Agente',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            name_Boss = name;
                            for (var i = 0; i < data.length; i++) {

                                if (data[i].nameBoss == name) {
                                    pkBoss00 = data[i].pkBoss;
                                    año00 = data[i].año;
                                }
                            }
                            chart.draw(view, options);
                            if (pkBoss00 != 0 && año00!=0) {
                            grafica_Agent_Year(business,pkBoss00, año00);

                            $("#agentYear").show();
                            document.getElementById("AgentYear").innerHTML = " Reporte de Agentes del " + " " + año00;
                            document.getElementById("idEmpresa").innerHTML = "Agentes del " + " " + año00;
                            activaTab('bbb');
                            activaTab('vistAA01');

                                $(document).ready(function () {
                                    $("#AgentYear").click(function () {
                                            grafica_Agent_Year(business,pkBoss00, año00);
                                            activaTab('vistAA01');
                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").hide();
                                            $("#agentDay").hide();
                                            $("#AgentCall").hide();
                                            
                                            $("#agentCall").hide();
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").show();
                                            $("#btnAgentAño2").show();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();

                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnAgentAño1").click(function () {

                                            grafica_Agent_Year(business,pkBoss00, año00);

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentAño2").click(function () {
                                                grafica01_Agent_Year(parametros.pkBusiness,pkBoss00, año00);
                                    });
                                });


                            }
                        }
                    });
                    chart.setAction({
                        id: 'month',
                        text: 'Mes',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            for (var i = 0; i < data.length; i++) {
                                var array = new Array();
                                if (data[i].nameBoss == name) {
                                    pkBoss00 = data[i].pkBoss;
                                    año00 = data[i].año;
                                }
                            }
                            chart.draw(view, options);
                            if (pkBoss00 != 0 && año00 !=0) {

                                     Boss_Month(pkBoss00, año00);
                                    document.getElementById("idEmpresa").innerHTML ="Reporte del Supervisor " + name + " " + "del" + " " + año00+ " " + "por meses";

                                    document.getElementById("BossMonth").innerHTML = "Supervisor " + " " + name;
                                    $("#bossMonth").show();
                                    activaTab('ppp');
                                    activaTab('vistBM01');

                                $(document).ready(function () {
                                    $("#BossMonth").click(function () {
                                        Boss_Month(pkBoss00, año00);
                                        activaTab('vistBM01');
                                            $("#bossMonth").show();
                                            $("#bossDay").hide();
                                            $("#agentMonth").hide();
                                            $("#agentDay").hide();
                                            
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").show();
                                            $("#btnBossMes2").show();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();


                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnBossMes1").click(function () {


                                            Boss_Month(pkBoss00, año00);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();

                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnBossMes2").click(function () {

                                            grafica02(parametros.pkBusiness,pkBoss00, año00);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();

                                    });
                                });
                            }
                        }
                    });

                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Boss por Mes-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
  var  month = "";
  var   año = 0;
  var pk_Boss = 0;
  var pkBusiness = 0;
    function Boss_Month(pkBoss, año) {

        var parametros = {
            pkBoss: pkBoss,
            año: año,
        }

        var urlMesBoss = Report.Urls.reportMonthBoss;


        $(function () {
            $.ajax({
                type: 'POST',
                url: urlMesBoss,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {

                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Reporte de Eficacia por Mes - Boss');
                    data1.addColumn('number', 'Por debajo del criterio');
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnBossMes1").show();
                    $("#btnBossMes2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };

                    $("#boss_div_chart").css({ "height": "400px", "width": "auto" });

                    var chart = new google.visualization.ColumnChart(document.getElementById("boss_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];

                        if (select) {
                          var  mes = data1.getValue(select.row, 0);
                            month = mes;
                            año = parametros.año;
                            pk_Boss = parametros.pkBoss;
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].pkBoss == pk_Boss) {
                                    name = data[i].nameBoss;
                                    pkBusiness = data[i].pkBusiness;
                                }
                            }
                            if (parametros.pkBoss == pk_Boss && mes == month && parametros.año == año) {
                                    grafica_Boss_Day(pk_Boss, month, año);
                                    document.getElementById("idEmpresa").innerHTML =" Reporte del Supervisor " + name + " " + "de" + " " + mes + " " + "del" + " " + año;
                                    document.getElementById("BossDay").innerHTML = mes + " " + "del" + " " + año;
                                    $("#bossDay").show();
                                    activaTab('sss');
                                    activaTab('vistBD01');

                                $(document).ready(function () {
                                    $("#btnBossDia1").click(function () {
                                            grafica_Boss_Day(pk_Boss, month, año);
                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossDia2").click(function () {
                                        grafica03(pkBusiness,pk_Boss, month, año);
                                    });
                                });

                            }
                        }

                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    //
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Boss por Día-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });

    function grafica_Boss_Day(pkBoss, month, año) {
        //
        var parametros = {
            pkBoss: pkBoss,
            month: month,
            año: año
        }
        //
        var urlDiaBoss = Report.Urls.reportDayBoss;
        //

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDiaBoss,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Reporte de Eficacia por dia - Boss');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").show();
                    $("#btnBossDia2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);
                    console.log(parametros);
                    //

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                            }
                        }
                    };

                    if (data.length <= 12) {
                        $("#boss_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#boss_div_chart").css({ "height": "400px", "width": ancho });
                    }


                    var chart = new google.visualization.ColumnChart(document.getElementById("boss_div_chart"));
                    chart.draw(view, options);
                },
                error: function () {
                    //
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Agente por Año-->
<script type="text/javascript">
    var YEAR = 0;
    var PKAGENT = 0;
    var name_Agent = "";
    var pkBusiness = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Agent_Year(pkBusiness,pkBoss, año) {
        //
        var parametros = {
            pkBoss: pkBoss,
            año: año,
            pkBusiness, pkBusiness,
        }
        //
        var urlAgente = Report.Urls.reportAgent;
        //
        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlAgente,
                data: { filtro: parametros },
                success: function (data) {
                    //
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'Agent');
                    data1.addColumn('number', 'Reporte de Eficacia por Año - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnAgentAño1").show();
                    $("#btnAgentAño2").show();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].nameAgent, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].nameAgent, null, data[i].result]);
                            }
                        }
                    };

                    console.log(data);
                    //
                    
                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);

                    if (data.length <= 12) {
                        $("#boss_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#boss_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    var chart = new google.visualization.ColumnChart(document.getElementById("boss_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];


                        if (select) {

                            var name = data1.getValue(select.row, 0);
                            name_Agent = name;

                            for (var i = 0; i < data.length; i++) {
                                if (data[i].nameAgent == name) {
                                    PKAGENT = data[i].pkAgent;
                                    pkBusiness = data[i].pkBusiness;
                                }
                            }
                            YEAR = parametros.año;
                            if (PKAGENT != 0 && YEAR != 0) {
                                    grafica_Agent_Month(PKAGENT, YEAR);
                                    document.getElementById("idEmpresa").innerHTML ="Reporte del Agente " + name + " " + "del" + " " + año + " " + "por meses";
                                    document.getElementById("AgentMonth").innerHTML = "Agente "+ " " + name;
                                    $("#agentMonth").show();
                                    activaTab('ttt');
                                    activaTab('vistAM01');

                                $(document).ready(function () {
                                    $("#AgentMonth").click(function () {
                                            grafica_Agent_Month(PKAGENT, YEAR);
                                            activaTab('vistAM01');
                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").show();
                                            $("#agentDay").hide();
                                            
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").show();
                                            $("#btnAgentMes2").show();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();

                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnAgentMes1").click(function () {

                                            grafica_Agent_Month(PKAGENT, YEAR);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentMes2").click(function () {

                                        grafica02_Agent_Month(pkBusiness,PKAGENT, YEAR);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();

                                    });
                                });

                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Agente por Mes-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    var AÑO = 0;
    var Agent_id = 0;
    var MONTH = "";
    var pkBusiness = 0;
    function grafica_Agent_Month(pkAgent, año) {
        //
        var parametros = {
            pkAgent: pkAgent,
            año: año,
        }
        //
        var urlMesAgent = Report.Urls.reportMonthAgent;
        //

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlMesAgent,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    //
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Reporte de Eficacia por Mes - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").show();
                    $("#btnAgentMes2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);



                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };

                    $("#boss_div_chart").css({ "height": "400px", "width": "auto" });

                    var chart = new google.visualization.ColumnChart(document.getElementById("boss_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            var name = "";
                            var mes = data1.getValue(select.row, 0);
                            MONTH = mes
                            AÑO = parametros.año;
                            Agent_id = parametros.pkAgent;
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].pkAgent == Agent_id) {
                                    name = [data[i].nameAgent];
                                    pkBusiness = data[i].pkBusiness;
                                }
                            }
                            if (Agent_id != 0 && MONTH != "" && AÑO != 0) {

                                    grafica_Agent_Day(Agent_id, MONTH, AÑO);
                                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + name + " " + "de" + " " + MONTH + " " + "del" + " " + AÑO;
                                    document.getElementById("AgentDay").innerHTML = MONTH + " " + "del" + " " + AÑO;
                                    $("#agentDay").show();
                                    activaTab('ñññ');
                                    activaTab('vistAD01');

                                $(document).ready(function () {
                                    $("#AgentDay").click(function () {
                                            grafica_Agent_Day(Agent_id, MONTH, AÑO);
                                            activaTab('vistAD01');
                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").show();
                                            $("#agentDay").show();
                                            
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").show();
                                            $("#btnAgentDia2").show();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();


                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnAgentDia1").click(function () {

                                            grafica_Agent_Day(Agent_id, MONTH, AÑO);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();



                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentDia2").click(function () {

                                        grafica03_Agent_Day(pkBusiness,Agent_id, MONTH, AÑO);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();


                                    });
                                });

                            }
                        }

                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    //
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Agente por Día-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    var Agente_id = 0;
    var Day = "";
    var pkBusiness = 0;
    function grafica_Agent_Day(pkAgent, month, año) {
        var parametros = {
            pkAgent: pkAgent,
            month: month,
            año: año
        }
        //
        var urlDiaAgent = Report.Urls.reportDayAgent;
        //

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDiaAgent,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Reporte de Eficacia por dia - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');


                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").show();
                    $("#btnAgentDia2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);

                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);


                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                            }
                        }
                    };

                    if (data.length <= 12) {
                        $("#boss_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#boss_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    var chart = new google.visualization.ColumnChart(document.getElementById("boss_div_chart"));
                    function selectItem() {
                        var name = "";
                        for (var i = 0; i < data.length; i++) {
                            if (data[i].pkAgent == parametros.pkAgent) {
                                name = data[i].nameAgent;
                                pkBusiness = data[i].pkBusiness;
                            }
                        };

                        var select = chart.getSelection()[0];
                        if (select) {
                            Agente_id = parametros.pkAgent;
                            var dias = data1.getValue(select.row, 0);
                             Day = dias;
                             if (Agente_id!=0 && dias == Day) {

                                    Report_Call(Agente_id, Day);
                                    $("#agentCall").show();
                                    document.getElementById("AgentCall").innerHTML ="Llamadas del agente " + name + " " + "del" + " " + Day;
                                    activaTab('yyy');
                                    activaTab('vistAL01');


                                $(document).ready(function () {
                                    $("#btnAgentLlamada1").click(function () {
                                            Report_Call(Agente_id, Day);
                                            
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentLlamada2").click(function () {

                                        Report_Call_Segmentado(pkBusiness,Agente_id, Day);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();



                                    });
                                });

                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    //
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Agente por llamada-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function Report_Call(pkAgent, dias) {
        //
        var parametros = {
            pkAgent: pkAgent,
            dias: dias
        };
        //
        var urlCallAgent = Report.Urls.reportCallAgent;
        //

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlCallAgent,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    //
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'Call');
                    data1.addColumn('number', 'Reporte de Eficacia por Llamada - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").show();
                    $("#btnAgentLlamada2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);

                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }

                    ]);

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].hora, data[i].result, null]);
                                
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].hora, null, data[i].result]);
                            }
                        }
                    };


                    if (data.length <= 12) {
                        $("#boss_div_chart").css({ "height": "500px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#boss_div_chart").css({ "height": "500px", "width": ancho });
                    }

                    var chart = new google.visualization.ColumnChart(document.getElementById("boss_div_chart"));

                    chart.draw(view, options);

                },
                error: function () {

                    console.log(data);

                }

            })

        });
    }

</script>

<!--Seccionado por Boss-->
<!--Seccionado de Boss por Año-->
<script type="text/javascript">

    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica01BossSegmentado(pkBusiness) {
        var parametros = {
            pkBusiness: pkBusiness,
        }

        urlBossAnio = Report.Urls.reportBossDinamico;

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlBossAnio,
                data: { filtro: parametros },
                success: function (data) {

                    var data1 = new google.visualization.DataTable();
                    $("#btnBossAño1").show();
                    $("#btnBossAño2").show();
                    $(document).ready(function () {
                        // btn 01
                        $("#btnBossAño1").click(function () {
                            grafica_Boss_Year();
                        });
                        //btn 02
                        $("#btnBossAño2").click(function () {

                            if (business!=0) {
                                grafica01BossSegmentado(business);
                            }

                        });

                    });

                    var countReg = data[0].TotalColumn ;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                            //data1.addColumn({ type: 'number', role: 'annotation' });
                        }
                    }


                    var countdata = countReg - 1;
                    var result = [];
                    var totl = countReg;

                    ////modelo de vista


                    var view = new google.visualization.DataView(data1);

                    var contador=1;
                    while (contador < countdata) {
                        if (contador >= 1) {
                            view.setColumns([0, contador,
                               {
                                   calc: "stringify",
                                   sourceColumn: contador,
                                   type: "string",
                                   role: "annotation"
                               }, 2,
                               {
                                   calc: "stringify",
                                   sourceColumn: 2,
                                   type: "string",
                                   role: "annotation"
                               },3,
                               {
                                   calc: "stringify",
                                   sourceColumn: 3,
                                   type: "string",
                                   role: "annotation"
                               }
                            ]);
                        }

                        contador += 1;
                    }


                    //Ingresa los datos
                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "nameBoss" && data[i].Header != "year") {
                            if (parseInt(data[i].Value) == "") {
                                result.push(null);

                            }
                            if (parseInt(data[i].Value) == "") {


                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "nameBoss") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);




                   //opciones de la vista

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,

                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection', showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        //hAxis: { textStyle: { fontSize: 15, color: 'black', bold: true }, viewWindowMode: 'maximized', gridlines: { count: 40 } },
                        //vAxis: { textStyle: { fontSize: 15, color: 'black' }, logScale: false, gridlines: { count: 40 }, format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //duration: 2000,
                        //easing: 'linear',
                        //startup: true
                        //},
                        annotations: {
                            textStyle: {
                                color: 'black',
                                fontSize: 11,
                            },
                            alwaysOutside: true
                        },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    //boton de regresar
                    $(document).ready(function () {
                        $("#BossYear").click(function () {

                            if (business != 0) {
                                grafica_Boss_Year(business);
                            }
                            activaTab('btnBoss');
                            $("#bossMonth").hide();
                            $("#bossDay").hide();
                            $("#agentYear").hide();
                            $("#agentMonth").hide();
                            $("#agentDay").hide();

                            $("#btnBossAño1").show();
                            $("#btnBossAño2").show();
                            $("#btnBossMes1").hide();
                            $("#btnBossMes2").hide();
                            $("#btnBossDia1").hide();
                            $("#btnBossDia2").hide();
                            $("#btnAgentAño1").hide();
                            $("#btnAgentAño2").hide();
                            $("#btnAgentMes1").hide();
                            $("#btnAgentMes2").hide();
                            $("#btnAgentDia1").hide();
                            $("#btnAgentDia2").hide();
                            $("#btnAgentLlamada1").hide();
                            $("#btnAgentLlamada2").hide();

                        });
                    });


                    activaTab('vistBA02');
                    document.getElementById("idEmpresa").innerHTML = "Reporte de Supervisores " + año00;
                    document.getElementById("BossYear").innerHTML = "Reporte de Supervisores";
                    document.getElementById("bossYear").style.display = 'inline';

                    if (data1.getNumberOfRows() <= 12) {
                        $("#boss_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#boss_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    var chart = new google.visualization.ColumnChart(document.getElementById("boss_div_chart"));

                    chart.setAction({
                        id: 'Agent1',
                        text: 'Agente',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1) + 20);
                            var name = data1.getValue(chart.getSelection()[0].row, 0);

                            for (var i = 0; i < data.length; i++) {

                                if (data[i].Header == "nameBoss") {
                                    if (data[i].Value == name) {
                                        pkBoss00 = data[i].pk_boss;
                                        año00 = data[i].year;
                                    }
                                }
                            }


                            chart.draw(data1, options);
                            if (pkBoss00 != 0 && año00 != 0) {
                                grafica01_Agent_Year(business, pkBoss00, año00);
                                    $("#agentYear").show();

                                    document.getElementById("AgentYear").innerHTML = "Reporte de Agentes del" + " " + año00;
                                    activaTab('bbb');

                                //regresar a agente

                                $(document).ready(function () {
                                    $("#AgentYear").click(function () {

                                        grafica_Agent_Year(business,pkBoss00, año00);

                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").hide();
                                            $("#agentDay").hide();
                                            $("#AgentCall").hide();
                                            $("#agentCall").hide();

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").show();
                                            $("#btnAgentAño2").show();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();

                                    });
                                });


                            }
                        }

                    });
                    chart.setAction({
                        id: 'Month',
                        text: 'Mes',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1) - 20);
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            name_Boss = name;
                            for (var i = 0; i < data.length; i++) {

                                if (data[i].Header == "nameBoss") {
                                    if (data[i].Value == name) {
                                        pkBoss00 = data[i].pk_boss;
                                        año00 = data[i].year;



                                    }
                                }
                            }

                            chart.draw(data1, options);
                            if (business!='' && pkBoss00 != '' && año00 !='') {


                                grafica02(business, pkBoss00, año00);


                                    document.getElementById("BossMonth").innerHTML = "Supervisor " + " " + name;
                                    $("#bossMonth").show();
                                    $("#monthBoss").show();
                                    activaTab('ppp');




                                $(document).ready(function () {
                                    $("#btnBossMes1").click(function () {

                                            Boss_Month(pkBoss02, año02);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();


                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnBossMes2").click(function () {

                                        grafica02(business, pkBoss00, año00);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#BossMonth").click(function () {
                                        grafica02(business, pkBoss00, año00);
                                        $("#bossMonth").show();
                                        $("#bossDay").hide();
                                        $("#agentMonth").hide();
                                        $("#agentDay").hide();

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").show();
                                        $("#btnBossMes2").show();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });


                            }

                        }
                    })
                    chart.draw(data1, options);
                },
                error: function () {
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Seccionado de Boss por Mes-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    var pkBoss03 = 0;
    var año03 = 0;
    var month03 = "";
    function grafica02(pk_business,pkBoss, año) {
        var parametros = {
            pkBusiness:pk_business,
            pkBoss: pkBoss,
            año: año,
        };

        urlBossMes = Report.Urls.reportBossMonthDinamico;

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlBossMes,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    var data1 = new google.visualization.DataTable();


                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnBossMes1").show();
                    $("#btnBossMes2").show();

                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', 'mes');
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "Month") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }


                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "Month") {

                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);


                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        //hAxis: { textStyle: { fontSize: 15, color: 'black', bold: true }, viewWindowMode: 'maximized', gridlines: { count: 40 } },
                        //vAxis: { textStyle: { fontSize: 15, color: 'black' }, logScale: false, gridlines: { count: 40 }, format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#boss_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#boss_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistBM02');

                    document.getElementById("idEmpresa").innerHTML = "Reporte del Supervisor " + '<b>' + '«' + name_Boss + '»' + '</b>' + " " + "por meses de" + " " + '<b>' + parametros.año + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("boss_div_chart"));
                    function selectItem() {
                        var select = chart.getSelection()[0];

                        if (select) {
                            month = data1.getValue(select.row, 0);
                            var pk_businesss = parametros.pkBusiness;
                            año = parametros.año;
                            pk_Boss = parametros.pkBoss;


                            if (pk_businesss!="" && pk_Boss !=0 && month!="" &&  año!=0) {

                                grafica03(pk_businesss, pk_Boss, month, año);

                                    $("#bossDay").show();


                                    document.getElementById("BossDay").innerHTML = month + " " + "del" + " " + año;

                                    activaTab('sss');

                            }


                            $(document).ready(function () {
                                $("#btnBossDia1").click(function () {

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        grafica_Boss_Day(pk_Boss, month, año);

                                });
                            });

                            $(document).ready(function () {
                                $("#btnBossDia2").click(function () {

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        grafica03(pk_businesss, pk_Boss, month, año);


                                });
                            });

                        }

                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(data1, options);
                },
                error: function () {

                    console.log(data);
                }
            })
        });
    }

</script>

<!--Seccionado de Boss por Dia-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica03(pk_business,pkBoss, month, año) {
        var parametros = {
            pkBusiness: pk_business,
            pkBoss: pkBoss,
            month: month,
            año: año
        };
        //
        urlBossDia = Report.Urls.reportBossDayDinamico;
        //

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlBossDia,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();


                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', 'mes');
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "Datecreated") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }

                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "Datecreated") {

                            var value = data[i].Value.toString();
                            var rs =value.substring(0, 10);
                            result.push(rs);
                        }


                    }
                    data1.addRow(result);


                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        //hAxis: { textStyle: { fontSize: 15, color: 'black', bold: true }, viewWindowMode: 'maximized', gridlines: { count: 40 } },
                        //vAxis: { textStyle: { fontSize: 15, color: 'black' }, logScale: false, gridlines: { count: 40 }, format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };



                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").show();
                    $("#btnBossDia2").show();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();


                    if (data1.getNumberOfRows() <= 12) {
                        $("#boss_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#boss_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistBD02');
                    document.getElementById("idEmpresa").innerHTML = "Reporte del Supervisor " + '<b>' + '«' + name_Boss + '»' + '</b>' + " por dias del mes " + '<b>' + parametros.month + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("boss_div_chart"));
                    chart.draw(data1, options);
                },
                error: function () {
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Seccionado por Agente-->
<!--Seccionado de Agente por Año-->
<script type="text/javascript">
    var Year04 = 0;
    var pk_agent04 = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica01_Agent_Year(pk_Business,pkBoss, año) {
        var parametros = {
            pkBusiness: pk_Business,
            pkBoss: pkBoss,
            añoPa: año
        }
        //
        urlAgenteanio = Report.Urls.reportAgentYearDinamico;
        //

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlAgenteanio,
                data: { filtro: parametros },
                success: function (data) {

                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "nameAgent") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "nameAgent") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);





                    $("#btnAgentAño1").show();
                    $("#btnAgentAño2").show();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();


                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection', showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        //hAxis: { textStyle: { fontSize: 15, color: 'black', bold: true }, viewWindowMode: 'maximized', gridlines: { count: 40 } },
                        //vAxis: { textStyle: { fontSize: 15, color: 'black' }, logScale: false, gridlines: { count: 40 }, format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#boss_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#boss_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    
                    activaTab('vistAA02');
                    document.getElementById("idEmpresa").innerHTML = "Reporte de Agentes del " + " " + parametros.añoPa;
                    var chart = new google.visualization.ColumnChart(document.getElementById("boss_div_chart"));
                    function selectItem() {
                        var select = chart.getSelection()[0];

                        if (select) {

                            var name = data1.getValue(select.row, 0);
                            name_Agent = name;
                            var pkbus = parametros.pkBusiness;
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].Header == "nameAgent") {
                                    if (data[i].Value == name) {
                                        PKAGENT = data[i].pk_agent;
                                        YEAR = data[i].year;
                                    }
                                }
                            }


                            if (pkbus!="" && PKAGENT !=0 && YEAR!=0) {

                                    grafica02_Agent_Month(pkbus,PKAGENT , YEAR);

                                    document.getElementById("AgentMonth").innerHTML = "Agente " + " " + name;
                                    $("#agentMonth").show();
                                    activaTab('ttt');

                                    $(document).ready(function () {
                                        $("#AgentMonth").click(function () {

                                            grafica02_Agent_Month(pkbus, PKAGENT, YEAR);

                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").show();
                                            $("#agentDay").hide();

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").show();
                                            $("#btnAgentMes2").show();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();

                                        });
                                    });


                                $(document).ready(function () {
                                    $("#btnAgentMes1").click(function () {

                                            grafica_Agent_Month(PKAGENT, YEAR);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentMes2").click(function () {

                                        grafica02_Agent_Month(pkbus, PKAGENT, YEAR);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();




                                    });
                                });
                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(data1, options);
                },
                error: function () {
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Seccionado de Agente por Mes-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    var mes05 = "";
    var año05 = 0;
    var pkAgent05 = 0;
    function grafica02_Agent_Month(pk_business,pkAgent, año) {
        var parametros = {
            pkBusiness:pk_business,
            pkAgent: pkAgent,
            año: año
        }
        //
        urlAgenteMes = Report.Urls.reportAgentMonthDinamico;
        //

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlAgenteMes,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    //
                    var data1 = new google.visualization.DataTable();

                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "MONTH") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "MONTH") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);



                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").show();
                    $("#btnAgentMes2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        //hAxis: { textStyle: { fontSize: 15, color: 'black', bold: true }, viewWindowMode: 'maximized', gridlines: { count: 40 } },
                        //vAxis: { textStyle: { fontSize: 15, color: 'black' }, logScale: false, gridlines: { count: 40 }, format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#boss_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#boss_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAM02');
                   
                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + '<b>' + '«' + name_Agent + '»' + '</b>' + " " + "por meses de" + " " + '<b>' + parametros.año + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("boss_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                             MONTH = data1.getValue(select.row, 0);
                            //
                             AÑO = parametros.año;
                             Agent_id = parametros.pkAgent;
                             var pkbusiness = parametros.pkBusiness;
                             var namecontex = document.getElementById('AgentMonth').textContent;

                            if (pkbusiness!=""  && Agent_id!=0 && MONTH!="" && AÑO!="") {

                                    grafica03_Agent_Day(pkbusiness, Agent_id, MONTH, AÑO);


                                    document.getElementById("AgentDay").innerHTML = MONTH + " " + "del" + " " + AÑO;
                                    $("#agentDay").show();

                                    activaTab('ñññ');

                                    $(document).ready(function () {
                                        $("#AgentDay").click(function () {

                                            grafica_Agent_Day(Agent_id, MONTH, YEAR);

                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").show();
                                            $("#agentDay").show();
                                            $("#agentCall").hide();
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").show();
                                            $("#btnAgentDia2").show();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();


                                        });
                                    });



                                $(document).ready(function () {
                                    $("#btnAgentDia1").click(function () {

                                            grafica_Agent_Day(Agent_id, MONTH, AÑO);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#chart18AgentMonthDay").show();

                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnAgentDia2").click(function () {

                                        grafica03_Agent_Day(pkbusiness, Agent_id, MONTH, AÑO);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();



                                    });
                                });
                            }
                        }

                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(data1, options);
                },
                error: function () {

                    console.log(data);
                }
            })
        });
    }

</script>

<!--Seccionado de Agente por Dia-->
<script type="text/javascript">
    var pkAgent06 = 0;
    var dias06 = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica03_Agent_Day(pk_business,pkAgent, month, año) {
        var parametros = {
            pkBusiness: pk_business,
            pkAgent: pkAgent,
            month: month,
            año: año
        }
        //
        urlAgenteDia = Report.Urls.reportAgentDayDinamico;
        //

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlAgenteDia,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();

                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "DateCreated") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "DateCreated") {
                            var values = data[i].Value.toString();
                            var value = values.substring(0, 10);
                            result.push(value);
                        }


                    }
                    data1.addRow(result);
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").show();
                    $("#btnAgentDia2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        //hAxis: { textStyle: { fontSize: 15, color: 'black', bold: true }, viewWindowMode: 'maximized', gridlines: { count: 40 } },
                        //vAxis: { textStyle: { fontSize: 15, color: 'black' }, logScale: false, gridlines: { count: 40 }, format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#boss_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#boss_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    
                    activaTab('vistAD02');
                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + '<b>' + '«' + name_Agent + '»' + '</b>' + " por dias del mes " + '<b>' + parametros.month + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("boss_div_chart"));
                    function selectItem() {
                        var select = chart.getSelection()[0];
                         Agente_id = parametros.pkAgent;


                         var pkBusiness = parametros.pkBusiness;



                        $(document).ready(function () {
                            $("#btnAgentLlamada1").click(function () {

                                    Report_Call(Agente_id, Day);

                                    $("#btnBossAño1").hide();
                                    $("#btnBossAño2").hide();
                                    $("#btnAgentAño1").hide();
                                    $("#btnAgentAño2").hide();
                                    $("#btnBossMes1").hide();
                                    $("#btnBossMes2").hide();
                                    $("#btnBossDia1").hide();
                                    $("#btnBossDia2").hide();
                                    $("#btnAgentMes1").hide();
                                    $("#btnAgentMes2").hide();
                                    $("#btnAgentDia1").hide();
                                    $("#btnAgentDia2").hide();


                            });
                        });


                        $(document).ready(function () {
                            $("#btnAgentLlamada2").click(function () {

                                Report_Call_Segmentado(pkBusiness, Agente_id, Day);

                                    $("#btnBossAño1").hide();
                                    $("#btnBossAño2").hide();
                                    $("#btnAgentAño1").hide();
                                    $("#btnAgentAño2").hide();
                                    $("#btnBossMes1").hide();
                                    $("#btnBossMes2").hide();
                                    $("#btnBossDia1").hide();
                                    $("#btnBossDia2").hide();
                                    $("#btnAgentMes1").hide();
                                    $("#btnAgentMes2").hide();
                                    $("#btnAgentDia1").hide();
                                    $("#btnAgentDia2").hide();



                            });
                        });

                        if (select) {
                            Day = data1.getValue(select.row, 0);
                            if (pkBusiness!="" && Agente_id!=0 && Day!="") {

                                Report_Call_Segmentado(pkBusiness, Agente_id, Day);

                                    $("#agentCall").show();
                                    document.getElementById("AgentCall").innerHTML = "Llamadas del " + name_Agent + " " + "del" + " " + Day;

                                    $("#AgentCall").show();
                                    activaTab('yyy');
                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(data1, options);
                },
                error: function () {
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Seccionado de Agente por Llamada-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function Report_Call_Segmentado(pk_business,pkAgent, dias) {
        var parametros = {
            pkBusiness: pk_business,
            pkAgent: pkAgent,
            dias: dias
        };
        //
        urlAgenteLlamada = Report.Urls.reportAgentCallDinamico;
        //

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlAgenteLlamada,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    //
                    var data1 = new google.visualization.DataTable();

                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "hours") {
                            if (parseInt(data[i].Value) == 0.00) {
                                result.push(0);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "hours") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);
                    var view = new google.visualization.DataView(data1);

                    var j = data1.valueOf();

                    for (var i = 0; i < countReg ; i++) {

                        view.setColumns([0, 1,
                           {
                               calc: "stringify",
                               sourceColumn: 1,
                               type: "string",
                               role: "annotation"
                           }, 2,
                           {
                               calc: "stringify",
                               sourceColumn: 2,
                               type: "string",
                               role: "annotation"
                           }, 3,
                           {
                               calc: "stringify",
                               sourceColumn: 3,
                               type: "string",
                               role: "annotation"
                           }
                        ]);

                    }


                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").show();
                    $("#btnAgentLlamada2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,

                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection', showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        //hAxis: { textStyle: { fontSize: 15, color: 'black', bold: true }, viewWindowMode: 'maximized', gridlines: { count: 40 } },
                        //vAxis: { textStyle: { fontSize: 15, color: 'black' }, logScale: false, gridlines: { count: 40 }, format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },

                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},

                        yellowFrom: 75, yellowTo: 100,
                        greenFrom: 25, greenTo: 75,
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#boss_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#boss_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAL02');

                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + '<b>' + '«' + name_Agent + '»' + '</b>' + " de las llamadas del " + '<b>' + parametros.dias + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("boss_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        var pk_section01 = 0;
                        var namesection = data1.getColumnId(1);
                        var s = data1.getColumnLabel(1);

                        for (var i = 0; i < data.length; i++) {
                            if(data[i].name_secction1== s){
                                pk_section01 = data[i].pkSection01;
                            }

                        }

                        var hora = data1.getValue(select.row, 0);
                        var parame = {
                            pkAgent: parametros.pkAgent,
                            pkSection: pk_section01,
                            dias: parametros.dias,
                            hora: hora
                        };
                        var urlnamerule = Report.Urls.name_rule;
                        var name_rule = "";
                        $.ajax({
                            type: 'POST',
                            datatype: 'json',
                            url: urlnamerule,
                            data: { filtro: parame },
                            success: function (data) {

                                    if (select) {
                                        if (parametros.pkAgent!=0 && pk_section01!=0 && parametros.dias!="" && hora!="") {
                                            for (var i = 0; i < data.length; i++) {
                                                name_rule = data[i].name_rule;



                                            }
                                        }
                                    }


                            },
                            error: function (data) {
                                console.log(data);
                            }
                        });

                    }


                    google.visualization.events.addListener(chart, 'select',selectItem);
                    chart.draw(data1, options);
                },
                error: function () {
                    console.log(data);
                }
            });

        });
    }

</script>
