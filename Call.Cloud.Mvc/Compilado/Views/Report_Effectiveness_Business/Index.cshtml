@model Call.Cloud.Mvc.Models.Effectiveness.ListaReportBusiness
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<head>
    <script type="text/javascript">

		var CuentaBusinessYear = 0;
		var CuentareportBossYear = 0;

        var Report = Report || {};
        Report.Urls = Report.Urls || {};
        Report.Urls.baseUrl = '@Url.Action("~")';
        Report.Urls.reportBusiness = '@Url.Action("Chart_Business_Year_Vertical", "Report_Effectiveness_Business")';
        Report.Urls.reportMonthBusiness = '@Url.Action("Chart_Business_Month", "Report_Effectiveness_Business")';
        Report.Urls.reportDayBusiness = '@Url.Action("Chart_Business_Day", "Report_Effectiveness_Business")';
        Report.Urls.reportBoss = '@Url.Action("Chart_Boss_Year", "Report_Effectiveness_Business")';
        Report.Urls.reportMonthBoss = '@Url.Action("Chart_Boss_Month", "Report_Effectiveness_Business")';
        Report.Urls.reportDayBoss = '@Url.Action("Chart_Boss_Day", "Report_Effectiveness_Business")';
        Report.Urls.reportAgent = '@Url.Action("Chart_Agent_Year", "Report_Effectiveness_Business")';
        Report.Urls.reportMonthAgent = '@Url.Action("Chart_Agent_Month", "Report_Effectiveness_Business")';
        Report.Urls.reportDayAgent = '@Url.Action("Chart_Agent_Day", "Report_Effectiveness_Business")';
        Report.Urls.reportCallAgent = '@Url.Action("Agent_LLamada", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoBoss = '@Url.Action("Report_Effectiveness_Year", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoMonthBoss = '@Url.Action("Report_Effectiveness_Month", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoDayBoss = '@Url.Action("Report_Effectiveness_Day", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoAgent = '@Url.Action("Agent_Year", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoMonthAgent = '@Url.Action("Agent_Month", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoDayAgent = '@Url.Action("Agent_Day", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoCallAgent = '@Url.Action("Report_Agent_call", "Report_Effectiveness_Business")';
   
        //dinámico
        Report.Urls.reportBossDinamico = '@Url.Action("dinamico0001", "Report_Effectiveness_Business")';
        Report.Urls.reportBossMonthDinamico = '@Url.Action("dinamico_Boss_Month", "Report_Effectiveness_Business")';
        Report.Urls.reportBossDayDinamico = '@Url.Action("dinamico_Boss_Day", "Report_Effectiveness_Business")';
        Report.Urls.reportAgentYearDinamico = '@Url.Action("dinamico_agent_Year", "Report_Effectiveness_Business")';
        Report.Urls.reportAgentMonthDinamico = '@Url.Action("dinamico_agent_Month", "Report_Effectiveness_Business")';
        Report.Urls.reportAgentDayDinamico = '@Url.Action("dinamico_Agent_Day", "Report_Effectiveness_Business")';
        Report.Urls.reportAgentCallDinamico = '@Url.Action("dinamico_Agent_Call", "Report_Effectiveness_Business")';
    
     </script>

    <link href="~/Content/css/chartist.min.css" rel="stylesheet" />
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>

<div class="page animsition">
    <div class="page-header">
        <div class="form-group form-material">
            <div class="col-sm-12">
                <div class="col-sm-3" style="width:150px;height:40px;"></div>
                <div class="col-sm-3" style="width:150px;height:40px;">
                    <h5>@Html.Label("pkSubOffice", "SUB-OFFICE", htmlAttributes: new { @class = "control-label col-sm-2" })</h5>
                </div>
                <div class="col-sm-3 text-right" style="width:700px;height:40px;">
                    @Html.DropDownListFor(model => model.Filtro.pkSubOffice, Model.ListaSubOffice, new { @class = "form-control" })
                </div>
                <div class="col-sm-3 text-right" style="width:100px;height:40px;">
                    <button id="btnBuscar" class="btn btn-primary" type="button" onclick="grafica_Business_year();">Buscar</button>
                </div>
            </div>
        </div>
    </div>

    <!--Navegacion-->
    <div class="panel-body">
        <div class="form-group form-material">
            <h2 id="idEmpresa" style="text-align:center;color:chocolate"> </h2>
            <ul class="nav nav-tabs" style="float:left">
                <li id="businessYear"><a href="#aaa" id="BusinessYear" style="color:chocolate; border-bottom:groove"></a></li>
                <li id="bossYear"><a id="BossYear" href="#bbb" style="color:chocolate; border-bottom:groove"></a></li>
                <li id="agentYear"><a href="#ccc" id="AgentYear" style="color:chocolate; border-bottom:groove"></a></li>


                <li id="businessMonth"><a href="#nnn" id="BusinessMonth" style="color:darkred; border-bottom:groove"></a></li>
                <li id="businessDay"><a href="#mmm" id="BusinessDay" style="color:darkred; border-bottom:groove"></a></li>

                <li id="bossMonth"><a href="#ppp" id="BossMonth" style="color:darkred; border-bottom:groove"></a></li>
                <li id="bossDay"><a href="#sss" id="BossDay" style="color:darkred; border-bottom:groove"></a></li>

                <li id="agentMonth"><a href="#ttt" id="AgentMonth" style="color:darkred; border-bottom:groove"></a></li>
                <li id="agentDay"><a href="#ñññ" id="AgentDay" style="color:darkred; border-bottom:groove"></a></li>
                <li id="agentCall"><a href="#yyy" id="AgentCall" style="color:darkred; border-bottom:groove"></a></li>

            </ul>
        </div>

        <!--Los div donde se ven las barras-->
        <div class="form-group form-material">
            <div id="divGrid01" class="col-sm-12">
                <br />
                <div class="col-sm-1">
                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistBA01" data-toggle="tab" id="btnBossAño1" style="display:none; ">Vista1</a></li>
                        <li><a href="#vistBA02" data-toggle="tab" id="btnBossAño2" style="display: none;">Vista2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistBM01" data-toggle="tab" id="btnBossMes1" style="display:none; ">Vista1</a></li>
                        <li><a href="#vistBM02" data-toggle="tab" id="btnBossMes2" style="display:none; ">Vista2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistBD01" data-toggle="tab" id="btnBossDia1" style="display:none; ">Vista1</a></li>
                        <li><a href="#vistBD02" data-toggle="tab" id="btnBossDia2" style="display: none; ">Vist2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistAA01" data-toggle="tab" id="btnAgentAño1" style="display:none; ">Vista1</a></li>
                        <li><a href="#vistAA02" data-toggle="tab" id="btnAgentAño2" style="display: none; ">Vista2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistAM01" data-toggle="tab" id="btnAgentMes1" style="display:none; ">Vista1</a></li>
                        <li><a href="#vistAM02" data-toggle="tab" id="btnAgentMes2" style="display: none; ">Vista2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistAD01" data-toggle="tab" id="btnAgentDia1" style="display:none; ">Vista1</a></li>
                        <li><a href="#vistAD02" data-toggle="tab" id="btnAgentDia2" style="display: none; ">Vista2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistAL01" data-toggle="tab" id="btnAgentLlamada1" style="display:none; ">Vista1</a></li>
                        <li><a href="#vistAL02" data-toggle="tab" id="btnAgentLlamada2" style="display: none; ">Vista2</a></li>
                    </ul>
                </div>

                <div id="contenedor" class="tab-content" style="overflow-x:scroll; overflow-y:hidden">
                    <div class="col-sm-11">
                        <div id="business_div_chart" style="width:auto;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Activar tabs-->
<script>
    function activaTab(tab) {
        $('.nav-tabs a[href="#' + tab + '"]').tab('show');
    };
    function desactivartab(tab) {
        $('.nav-tabs a[href="#' + tab + '"]').tab('hide');
    }

</script>

<!--Ocultar navegacion-->
<script>
    $(document).ready(function () {
        document.getElementById("businessYear").style.display = 'none';
        document.getElementById("businessMonth").style.display = 'none';
        document.getElementById("businessDay").style.display = 'none';
        document.getElementById("bossYear").style.display = 'none';
        document.getElementById("bossMonth").style.display = 'none';
        document.getElementById("bossDay").style.display = 'none';
        document.getElementById("agentYear").style.display = 'none';
        document.getElementById("agentMonth").style.display = 'none';
        document.getElementById("agentDay").style.display = 'none';
        document.getElementById("agentCall").style.display = 'none';
        document.getElementById("contenedor").style.display = 'none';
    })
</script>

<!--Business por Año-->
<script type="text/javascript">
    var suboffice = 0;
    var pk_business07 = 0;
    var año07 = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Business_year() {
        suboffice = $("#Filtro_pkSubOffice").val();
        $("#contenedor").show();

        var parametros = {
            pkSubOffice: suboffice,
        }
        
        var urlYearBusiness = Report.Urls.reportBusiness;
        

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlYearBusiness,

                data: { filtro: parametros },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'Business');
                    data1.addColumn('number', 'Reporte de Eficacia por mes - Business');
                    data1.addColumn('number', 'Por debajo del criterio');

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].nameBusiness, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].nameBusiness, null, data[i].result]);
                            }
                        }
                    };

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    document.getElementById("BusinessYear").innerHTML = "Reporte de Negocios";
                    $("#businessYear").show();
                    document.getElementById("idEmpresa").innerHTML = "Reporte de Negocios";
                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);
					CuentaBusinessYear = 0;
                    $(document).ready(function () {
                        $("#BusinessYear").click(function () {
							CuentaBusinessYear = CuentaBusinessYear + 1;

							if(CuentaBusinessYear==1)
							{
								grafica_Business_year();
								$("#agentYear").hide();
								$("#businessMonth").hide();
								$("#businessDay").hide();
								$("#bossMonth").hide();
								$("#bossYear").hide();
								$("#bossDay").hide();
								$("#agentMonth").hide();
								$("#agentDay").hide();
								$("#agentCall").hide();
                            
								$("#btnBossAño1").hide();
								$("#btnBossAño2").hide();
								$("#btnBossMes1").hide();
								$("#btnBossMes2").hide();
								$("#btnBossDia1").hide();
								$("#btnBossDia2").hide();
								$("#btnAgentAño1").hide();
								$("#btnAgentAño2").hide();
								$("#btnAgentMes1").hide();
								$("#btnAgentMes2").hide();
								$("#btnAgentDia1").hide();
								$("#btnAgentDia2").hide();
								$("#btnAgentLlamada1").hide();
								$("#btnAgentLlamada2").hide();
							}

                        });
                    });

                    activaTab('aaa');
                    if (data.length <= 12) {
                        $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#business_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));

                    chart.setAction({
                        id: 'Boss',
                        text: 'Boss',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);

                            for (var i = 0; i < data.length; i++) {
                                var array = new Array();
                                if (data[i].nameBusiness == name) {
                                    pk_business07 = data[i].pkBusiness;
                                    año07 = data[i].año;
                                }
                            }

                            chart.draw(view, options);
                            if (pk_business07 != 0 && año07 != 0) {

                                grafica_Boss_Year(pk_business07, año07);
                                document.getElementById("BossYear").innerHTML = "Reporte de Supervisor del" + " " + año07;
                                document.getElementById("bossYear").style.display = 'inline';
                                document.getElementById("idEmpresa").innerHTML =
                                    "Reporte de Supervisores del " + " " + año07;
                                activaTab('bbb');

								CuentareportBossYear = 0;

                                $(document).ready(function () {
                                    $("#BossYear").click(function () {
										CuentareportBossYear = CuentareportBossYear + 1;
										//alert("88" + CuentareportBossYear.toString());

                                        grafica_Boss_Year(pk_business07, año07);
                                        $("#businessYear").show();
                                        $("#bossYear").show();
                                        $("#agentYear").hide();
                                        $("#agentCall").hide();
                                        $("#enterpriseMonth").hide();
                                        $("#enterpriseDay").hide();
                                        $("#officeMonth").hide();
                                        $("#officeDay").hide();
                                        $("#subOfficeMonth").hide();
                                        $("#subOfficeDay").hide();
                                        $("#businessMonth").hide();
                                        $("#businessDay").hide();
                                        $("#bossMonth").hide();
                                        $("#bossDay").hide();
                                        $("#agentMonth").hide();
                                        $("#agentDay").hide();
                                        
                                        $("#btnBossAño1").show();
                                        $("#btnBossAño2").show();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();
                                    });
                                });


                                $(document).ready(function () {
                                    
                                    $("#btnBossAño1").click(function () {

									   //alert("mensaje");
                                        grafica_Boss_Year(pk_business07, año07);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    
                                    $("#btnBossAño2").click(function () {
                                        

                                        grafica01BossSegmentado(pk_business07,año07);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();



                                    });
                                });
                            }
                        }

                    });
                    chart.setAction({
                        id: 'month',
                        text: 'Mes',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            for (var i = 0; i < data.length; i++) {

                                if (data[i].nameBusiness == name) {
                                    pk_business07 = data[i].pkBusiness;
                                    año07 = data[i].año;

                                }
                            }

                            chart.draw(view, options);
                            if (pk_business07 != 0 && año07 != 0) {

                                grafica_Business_Month(pk_business07, año07);

                                document.getElementById("idEmpresa").innerHTML =
                                    "Reporte del Negocio " + name + " " + "del" + " " + año07
                                    + " " + "por meses";
                                document.getElementById("businessMonth").style.display = 'inline';
                                document.getElementById("BusinessMonth").innerHTML = "Negocio " + " " + name;
                                activaTab('nnn');

                                $(document).ready(function () {
                                    $("#BusinessMonth").click(function () {

                                        grafica_Business_Month(pk_business07, año07);

                                        $("#businessYear").show();
                                        $("#bossYear").hide();
                                        $("#agentYear").hide();
                                        $("#agentCall").hide();
                                        $("#enterpriseMonth").hide();
                                        $("#enterpriseDay").hide();
                                        $("#officeMonth").hide();
                                        $("#officeDay").hide();
                                        $("#subOfficeMonth").hide();
                                        $("#subOfficeDay").hide();
                                        $("#businessMonth").show();
                                        $("#businessDay").hide();
                                        $("#bossMonth").hide();
                                        $("#bossDay").hide();
                                        $("#agentMonth").hide();
                                        $("#agentDay").hide();
                                        
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });
                            }
                        }
                    });
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Business por Mes-->
<script type="text/javascript">
    var mes07 = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Business_Month(pkBusiness, año) {
        
        var parametros = {
            pkBusiness: pkBusiness,
            año: año,
        }
        
        var urlMesBusiness = Report.Urls.reportMonthBusiness;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlMesBusiness,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Reporte de Eficacia por mes - Business');
                    data1.addColumn('number', 'Por debajo del criterio');

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);
                    
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };

                    $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            mes07 = data1.getValue(select.row, 0);
                            var name = "";
                            año07 = parametros.año;
                            pk_business07 = parametros.pkBusiness;
                            for (var i = 0; i < data.length; i++) {

                                if (data[i].pkBusiness == pk_business07) {
                                    name = [data[i].nameBusiness];

                                }
                            }
                            if (pk_business07 != 0 && mes07 != "" && año07 != 0) {

                                grafica_Business_Day(pk_business07, año07, mes07);
                                document.getElementById("idEmpresa").innerHTML = " Reporte del Negocio " + name + " " + "de" + " " + mes07 + " " + "del" + " " + año07;
                                document.getElementById("BusinessDay").innerHTML = mes07 + " " + "del" + " " + año07;
                                $("#businessDay").show();
                                activaTab('mmm');


                            }
                        }
                        console.log(parametros);
                        
                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Business por Dia-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Business_Day(pkBusiness, año, month) {
        
        var parametros = {
            pkBusiness: pkBusiness,
            año: año,
            month: month
        }
        
        var urlDiaBusiness = Report.Urls.reportDayBusiness;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDiaBusiness,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Reporte de Eficacia por dia - Business');
                    data1.addColumn('number', 'Por debajo del criterio');

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);
                    
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                            }
                        }
                    };

                    if (data.length <= 12) {
                        $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#business_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Boss por Año-->
<script type="text/javascript">
    var pkBoss00 = 0;
    var año00 = 0;
	var CuentareportBossYear = 0;

    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Boss_Year(pkBusiness, año) {
		CuentareportBossYear = CuentareportBossYear +1 ;
		//alert("CuentareportBossYearv2 " + CuentareportBossYear.toString());
        
        var parametros = {
            pkBusiness: pkBusiness,
            año: año
        }
        
        var urlYearBoss = Report.Urls.reportBoss;
        

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlYearBoss,
                data: { filtro: parametros },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'supervisor');
                    data1.addColumn('number', 'Reporte de Eficacia por Año - Boss');
                    data1.addColumn('number', 'Por debajo del criterio');

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].nameBoss, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].nameBoss, null, data[i].result]);
                            }
                        }
                    };

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    $("#btnBossAño1").show();
                    $("#btnBossAño2").show();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);

                    if (data.length <= 12) {
                        $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#business_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistBA01');

                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));

                    chart.setAction({
                        id: 'Agent',
                        text: 'Agente',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);

                            for (var i = 0; i < data.length; i++) {
                                array = new Array();
                                if (data[i].nameBoss == name) {
                                    pkBoss00 = data[i].pkBoss;
                                }
                            }

                            año00 = parametros.año;
                            chart.draw(view, options);
                            if (pkBoss00 != 0 && año00 != 0) {

                                grafica_Agent_Year(parametros.pkBusiness,pkBoss00, año00);
                                document.getElementById("AgentYear").innerHTML = " Reporte de Agentes del " + " " + año00;
                                $("#agentYear").show();
                                document.getElementById("idEmpresa").innerHTML =
                                    "Agentes del " + " " + año00;
                                activaTab('ccc');
                                activaTab('vistAA01');

                                $(document).ready(function () {
                                    $("#AgentYear").click(function () {
                                        grafica_Agent_Year(parametros.pkBusiness,pkBoss00, año00);
                                        activaTab('vistAA01');
                                        $("#businessYear").show();
                                        $("#bossYear").show();
                                        $("#agentYear").show();
                                        $("#agentCall").hide();
                                        $("#enterpriseMonth").hide();
                                        $("#enterpriseDay").hide();
                                        $("#officeMonth").hide();
                                        $("#officeDay").hide();
                                        $("#subOfficeMonth").hide();
                                        $("#subOfficeDay").hide();
                                        $("#businessMonth").hide();
                                        $("#businessDay").hide();
                                        $("#bossMonth").hide();
                                        $("#bossDay").hide();
                                        $("#agentMonth").hide();
                                        $("#agentDay").hide();
                                        
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").show();
                                        $("#btnAgentAño2").show();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentAño1").click(function () {

                                        grafica_Agent_Year(parametros.pkBusiness,pkBoss00, año00);



                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentAño2").click(function () {
                                        grafica01_Agent_Year(parametros.pkBusiness,pkBoss00, año00);
                                    });
                                });



                            }
                        }
                    });
                    chart.setAction({
                        id: 'month',
                        text: 'Mes',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);


                            for (var i = 0; i < data.length; i++) {
                                var array = new Array();
                                if (data[i].nameBoss == name) {
                                    pkBoss00 = data[i].pkBoss;


                                }
                            }
                            año00 = parametros.año;
                            chart.draw(view, options);
                            if (pkBoss00 != 0 && año00 != 0) {

                                Boss_Month(pkBoss00, año00);
                                document.getElementById("idEmpresa").innerHTML =
                                    "Reporte del Supervisor " + name + " " + "del" + " " + año00 + " " + "por meses";
                                document.getElementById("BossMonth").innerHTML = "Supervisor  " + " " + name;
                                $("#bossMonth").show();
                                activaTab('ppp');
                                activaTab('vistBM01');

                                $(document).ready(function () {
                                    $("#BossMonth").click(function () {
                                        Boss_Month(pkBoss00, año00);
                                        activaTab('vistBM01');
                                        $("#businessYear").show();
                                        $("#bossYear").show();
                                        $("#agentYear").hide();
                                        $("#agentCall").hide();
                                        $("#enterpriseMonth").hide();
                                        $("#enterpriseDay").hide();
                                        $("#officeMonth").hide();
                                        $("#officeDay").hide();
                                        $("#subOfficeMonth").hide();
                                        $("#subOfficeDay").hide();
                                        $("#businessMonth").hide();
                                        $("#businessDay").hide();
                                        $("#bossMonth").show();
                                        $("#bossDay").hide();
                                        $("#agentMonth").hide();
                                        $("#agentDay").hide();
                                        
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").show();
                                        $("#btnBossMes2").show();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnBossMes1").click(function () {

                                        Boss_Month(pkBoss00, año00);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();
                                        $("#chart14MonthBoss").show();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossMes1").click(function () {

                                        Boss_Month(pkBoss00, año00);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossMes2").click(function () {

                                        grafica02(parametros.pkBusiness,pkBoss00, año00);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();


                                    });
                                });
                            }
                        }
                    });

                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Boss por Mes-->
<script type="text/javascript">
    var month = "";
    var año = 0;
    var pk_Boss = 0;
    var pkBusiness = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function Boss_Month(pkBoss, año) {
        
        var parametros = {
            pkBoss: pkBoss,
            año: año,
        }
        
        var urlMesBoss = Report.Urls.reportMonthBoss;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlMesBoss,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Reporte de Eficacia por Mes - Boss');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnBossMes1").show();
                    $("#btnBossMes2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };

                    $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            var mes = data1.getValue(select.row, 0);
                            month = mes;
                            año = parametros.año;
                            pk_Boss = parametros.pkBoss;

                            for (var i = 0; i < data.length; i++) {
                                if (data[i].pkBoss == pk_Boss) {
                                    name = data[i].nameBoss;
                                    pkBusiness = data[i].pkBusiness;
                                }
                            }

                            if (parametros.pkBoss == pk_Boss && mes == month && parametros.año == año) {
                                grafica_Boss_Day(pk_Boss, month, año);
                                document.getElementById("idEmpresa").innerHTML = " Reporte del Supervisor " + name + " " + "de" + " " + mes + " " + "del" + " " + año;
                                document.getElementById("BossDay").innerHTML = mes + " " + "del" + " " + año;
                                $("#bossDay").show();
                                activaTab('sss');
                                activaTab('vistBD01');

                                $(document).ready(function () {
                                    $("#btnBossDia1").click(function () {


                                        grafica_Boss_Day(pk_Boss, month, año);


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossDia2").click(function () {

                                        grafica03(pkBusiness,pk_Boss, month, año);



                                    });
                                });

                            }
                        }

                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Boss por Día-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Boss_Day(pkBoss, month, año) {
        
        var parametros = {
            pkBoss: pkBoss,
            month: month,
            año: año
        }
        
        var urlDiaBoss = Report.Urls.reportDayBoss;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDiaBoss,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Reporte de Eficacia por dia - Boss');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").show();
                    $("#btnBossDia2").show();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);
                    
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                            }
                        }
                    };

                    if (data.length <= 12) {
                        $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#business_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Agente por Año-->
<script type="text/javascript">
    var YEAR = 0;
    var PKAGENT = 0;
    var pkBusiness = 0;
    var name_Agent = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Agent_Year(pkBusiness,pkBoss, año) {
        
        var parametros = {
            pkBoss: pkBoss,
            año: año,
            pkBusiness:pkBusiness
        }
        
        var urlAgente = Report.Urls.reportAgent;
        
        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlAgente,
                data: { filtro: parametros },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'Agent');
                    data1.addColumn('number', 'Reporte de Eficacia por Año - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');
                    $("#btnAgentAño1").show();
                    $("#btnAgentAño2").show();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();


                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].nameAgent, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].nameAgent, null, data[i].result]);
                            }
                        }
                    };
                    
                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);

                    if (data.length <= 12) {
                        $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#business_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {

                            var name = data1.getValue(select.row, 0);
                            name_Agent = name;

                            for (var i = 0; i < data.length; i++) {
                                if (data[i].nameAgent == name) {
                                    PKAGENT = data[i].pkAgent;
                                    pkBusiness = data[i].pkBusiness;
                                }
                            }
                            YEAR = parametros.año;
                            if (PKAGENT != 0 && YEAR != 0) {
                                grafica_Agent_Month(PKAGENT, YEAR);
                                document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + name + " " + "del" + " " + YEAR + " " + "por meses";
                                document.getElementById("AgentMonth").innerHTML = "Agente " + " " + name;
                                $("#agentMonth").show();
                                activaTab('ttt');
                                activaTab('vistAM01');

                                $(document).ready(function () {
                                    $("#AgentMonth").click(function () {
                                        grafica_Agent_Month(PKAGENT, YEAR);
                                        activaTab('vistAM01');
                                        $("#chart10BusinessAnio").hide();
                                        $("#chart11MonthBusiness").hide();
                                        $("#chart12BusinessMonthDay").hide();
                                        $("#chart13BossAnio").hide();
                                        $("#chart14MonthBoss").hide();
                                        $("#chart15BossMonthDay").hide();
                                        $("#chart16AgentAnio").hide();
                                        $("#chart17MonthAgent").show();
                                        $("#chart18AgentMonthDay").hide();
                                        $("#chart19CallAgent").hide();
                                        $("#chart01").hide();
                                        $("#chart02").hide();
                                        $("#chart03").hide();
                                        $("#chart04").hide();
                                        $("#chart05").hide();
                                        $("#chart06").hide();
                                        $("#chart07").hide();

                                        $("#businessYear").show();
                                        $("#bossYear").show();
                                        $("#agentYear").show();
                                        $("#agentCall").hide();

                                        $("#businessMonth").hide();
                                        $("#businessDay").hide();
                                        $("#bossMonth").hide();
                                        $("#bossDay").hide();
                                        $("#agentMonth").show();
                                        $("#agentDay").hide();
                                        
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnAgentMes1").show();
                                        $("#btnAgentMes2").show();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();



                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnAgentMes1").click(function () {

                                        grafica_Agent_Month(PKAGENT, YEAR);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentMes2").click(function () {

                                        grafica02_Agent_Month(pkBusiness,PKAGENT, YEAR);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();

                                    });
                                });

                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Agente por Mes-->
<script type="text/javascript">
    var AÑO = 0;
    var Agent_id = 0;
    var MONTH = "";
    var pkBusiness=0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Agent_Month(pkAgent, año) {
        
        var parametros = {
            pkAgent: pkAgent,
            año: año,
        }
        
        var urlMesAgent = Report.Urls.reportMonthAgent;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlMesAgent,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Reporte de Eficacia por Mes - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');


                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").show();
                    $("#btnAgentMes2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);
                    
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };

                    $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            var name = "";
                            var mes = data1.getValue(select.row, 0);
                            MONTH = mes
                            AÑO = parametros.año;
                            Agent_id = parametros.pkAgent;
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].pkAgent == Agent_id) {
                                    name = [data[i].nameAgent];
                                    pkBusiness = data[i].pkBusiness;
                                }
                            }
                            if (Agent_id != 0 && MONTH != "" && AÑO != 0) {

                                grafica_Agent_Day(Agent_id, MONTH, AÑO);
                                document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + name + " " + "de" + " " + MONTH + " " + "del" + " " + AÑO;
                                document.getElementById("AgentDay").innerHTML = MONTH + " " + "del" + " " + AÑO;
                                $("#agentDay").show();
                                activaTab('ñññ');
                                activaTab('vistAD01');

                                $(document).ready(function () {
                                    $("#AgentDay").click(function () {
                                        grafica_Agent_Day(Agent_id, MONTH, AÑO);
                                        activaTab('vistAD01');
                                        $("#businessYear").show();
                                        $("#bossYear").show();
                                        $("#agentYear").show();
                                        $("#agentCall").hide();

                                        $("#businessMonth").hide();
                                        $("#businessDay").hide();
                                        $("#bossMonth").hide();
                                        $("#bossDay").hide();
                                        $("#agentMonth").show();
                                        $("#agentDay").show();
                                        
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").show();
                                        $("#btnAgentDia2").show();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnAgentDia1").click(function () {

                                        grafica_Agent_Day(Agent_id, MONTH, AÑO);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();



                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnAgentDia2").click(function () {

                                        grafica03_Agent_Day(pkBusiness,Agent_id, MONTH, AÑO);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();


                                    });
                                });
                            }
                        }
                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Agente por Día-->
<script type="text/javascript">
    var Agente_id = 0;
    var Day = "";
    var pkBusiness = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Agent_Day(pkAgent, month, año) {
        var parametros = {
            pkAgent: pkAgent,
            month: month,
            año: año
        }
        
        var urlDiaAgent = Report.Urls.reportDayAgent;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDiaAgent,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Reporte de Eficacia por dia - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").show();
                    $("#btnAgentDia2").show();


                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);

                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);
                    
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                            }
                        }
                    };

                    if (data.length <= 12) {
                        $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#business_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));

                    function selectItem() {
                        var name = "";
                        Agente_id = parametros.pkAgent;
                        for (var i = 0; i < data.length; i++) {
                            if (data[i].pkAgent == Agente_id) {
                                name = data[i].nameAgent;
                                pkBusiness = data[i].pkBusiness;
                            }
                        };


                        var select = chart.getSelection()[0];
                        if (select) {

                            var dias = data1.getValue(select.row, 0);
                            Day = dias;
                            if (Agente_id != 0 && dias == Day) {

                                Report_Call(Agente_id, Day);
                                $("#agentCall").show();
                                document.getElementById("AgentCall").innerHTML = "Llamadas del agente " + name + " " + "del" + " " + dias;
                                activaTab('yyy');
                                activaTab('vistAL01');

                                $(document).ready(function () {
                                    $("#btnAgentLlamada1").click(function () {

                                        Report_Call(Agente_id, Day);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();


                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnAgentLlamada2").click(function () {

                                        Report_Call_Segmentado(pkBusiness,Agente_id, Day);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                    });
                                });


                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Agente por llamada-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function Report_Call(pkAgent, dias) {
        
        var parametros = {
            pkAgent: pkAgent,
            dias: dias
        };
        
        var urlCallAgent = Report.Urls.reportCallAgent;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlCallAgent,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'Call');
                    data1.addColumn('number', 'Reporte de Eficacia por Llamada - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").show();
                    $("#btnAgentLlamada2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);

                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }

                    ]);

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].hora, data[i].result, null]);
                                
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].hora, null, data[i].result]);
                            }
                        }
                    };

                    console.log(data);

                    if (data.length <= 12) {
                        $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#business_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));

                    chart.draw(view, options);
                    
                },
                error: function () {
                    
                    console.log(data);

                }

            })

        });
    }

</script>

<!--Seccionado por Boss-->
<!--Seccionado de Boss por Año-->
<script type="text/javascript">
    var name_Boss = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica01BossSegmentado(pkBusiness, año) {
        var parametros = {
            pkBusiness: pkBusiness,
            año: año,
        }
        
        urlBossAnio = Report.Urls.reportBossDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlBossAnio,
                data: { filtro: parametros },
                success: function (data) {

                    var data1 = new google.visualization.DataTable();

                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var countdata = countReg - 1;
                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "nameBoss") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            if (parseInt(data[i].Value) == "") {
                                data[i].Value = 0;

                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "nameBoss") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);

                    $("#btnBossAño1").show();
                    $("#btnBossAño2").show();






                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection', showColorCode: true, isHtml: false },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };
                
                    if (data1.getNumberOfRows() <= 12) {
                        $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#business_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistBA02');

                    document.getElementById("idEmpresa").innerHTML = "Reporte de Supervisores del " + " " + año07;
                    document.getElementById("BossYear").innerHTML = "Reporte de Supervisores";
                    document.getElementById("bossYear").style.display = 'inline';
                    
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));

                    chart.setAction({
                        id: 'Agent1',
                        text: 'Agent',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1) + 20);
                            var name = data1.getValue(chart.getSelection()[0].row, 0);

                            name_Boss = name;

                            for (var i = 0; i < data.length; i++) {

                                if (data[i].Header == "nameBoss") {
                                    if (data[i].Value == name) {
                                        pkBoss00 = data[i].pk_boss;
                                        año00 = data[i].year;
                                      
                                    }
                                }
                            }




                            chart.draw(data1, options);
                            if (pkBoss00 != 0 && año00 != 0) {

                                grafica01_Agent_Year(parametros.pkBusiness, pkBoss00, año00);


                                $("#agentYear").show();

                                document.getElementById("AgentYear").innerHTML = "Reporte de Agentes del" + " " + año00;
                                activaTab('ccc');

                                //regresar a agente

                                $(document).ready(function () {
                                    $("#AgentYear").click(function () {

                                        grafica_Agent_Year(parametros.pkBusiness,pkBoss00, año00);

                                        $("#bossMonth").hide();
                                        $("#bossDay").hide();
                                        $("#agentMonth").hide();
                                        $("#agentDay").hide();
                                        $("#AgentCall").hide();
                                        $("#agentCall").hide();

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").show();
                                        $("#btnAgentAño2").show();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

								
                                $(document).ready(function () {
                                    // btn 01
                                    $("#btnBossAño1").click(function () {
										CuentareportBossYear = CuentareportBossYear + 1;
										//alert("Boss Year 1");

                                        grafica_Boss_Year();
                                    });
                                    //btn 02
                                    $("#btnBossAño2").click(function () {
									CuentareportBossYear = CuentareportBossYear + 1;
										//alert("Boss Year 2");
                                        grafica01BossSegmentado(parametros.pkBusiness, año00);


                                    });

                                });


                            }
                        }

                    });
                    chart.setAction({
                        id: 'Month',
                        text: 'Month',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                            data1.getValue(chart.getSelection()[0].row, 1) - 20);
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            name_Boss = name;
                            for (var i = 0; i < data.length; i++) {

                                if (data[i].Header == "nameBoss") {
                                    if (data[i].Value == name) {
                                        pkBoss00 = data[i].pk_boss;
                                        año00 = data[i].year;
                                    }
                                }
                            }


                            chart.draw(data1, options);
                            if (pkBoss00 != 0 && año00 != 0) {


                                grafica02(parametros.pkBusiness, pkBoss00, año00);

                                document.getElementById("BossMonth").innerHTML = "Supervisor " + " " + name;
                                $("#bossMonth").show();
                                $("#monthBoss").show();
                                activaTab('ppp');

                                $(document).ready(function () {
                                    $("#BossMonth").click(function () {

                                        Boss_Month(pkBoss00, año00);
                                            $("#bossMonth").show();
                                            $("#bossDay").hide();
                                            $("#agentMonth").hide();
                                            $("#agentDay").hide();

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").show();
                                            $("#btnBossMes2").show();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();





                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnBossMes1").click(function () {

                                        Boss_Month(pkBoss00, año00);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossMes2").click(function () {
                                        if (business!=0) {
                                            grafica02(parametros.pkBusiness, pkBoss00, año00);
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                        }


                                    });
                                });


                            }

                        }
                    })

                    var view = new google.visualization.DataView(data1);

                    var countdata = countReg - 1;
                    var contador = 1;


                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }


                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Seccionado de Boss por Mes-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });

    function grafica02(pk_business,pkBoss, año) {
        var parametros = {
            pkBusiness: pk_business,
            pkBoss: pkBoss,
            año: año,
        };
        
        urlBossMes = Report.Urls.reportBossMonthDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlBossMes,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    var data1 = new google.visualization.DataTable();

                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', 'mes');
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "Month") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }


                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "Month") {

                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);



                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnBossMes1").show();
                    $("#btnBossMes2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#business_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistBM02');
                    
                    document.getElementById("idEmpresa").innerHTML = "Reporte del Supervisor " + '<b>' + '«' + name_Boss + '»' + '</b>' + " " + "por meses de" + " " + '<b>' + parametros.año + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));
                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            month = data1.getValue(select.row, 0);

                            año = parametros.año;
                            pk_Boss = parametros.pkBoss;
                            for (var i = 0; i < data.length; i++) {

                                if (data[i].pkBoss == pk_Boss) {
                                    name = data[i].nameBoss;

                                }
                            }

                            if ( pk_Boss != 0 && month != "" && año != 0) {

                                grafica03(parametros.pkBusiness ,pk_Boss, month, año);

                                $("#bossDay").show();

                                document.getElementById("BossDay").innerHTML = month + " " + "del" + " " + año;
                                activaTab('sss');

                                $(document).ready(function () {
                                    $("#btnBossDia1").click(function () {

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        grafica_Boss_Day(pk_Boss, month, año);

                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnBossDia2").click(function () {

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            grafica03(parametros.pkBusiness,pk_Boss, month, año);




                                    });
                                });

                            }
                        }

                    }

                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {

                    console.log(data);
                }
            })
        });
    }

</script>

<!--Seccionado de Boss por Dia-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica03( pk_busines, pkBoss, month, año) {
        var parametros = {
            pkBusiness: pk_busines,
            pkBoss: pkBoss,
            month: month,
            año: año
        };
        
        urlBossDia = Report.Urls.reportBossDayDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlBossDia,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();

                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', 'mes');
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "Datecreated") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }

                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "Datecreated") {

                            var value = data[i].Value.toString();
                            var rs = value.substring(0, 10);
                            result.push(rs);
                        }


                    }
                    data1.addRow(result);

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };



                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").show();
                    $("#btnBossDia2").show();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();


                    if (data1.getNumberOfRows() <= 12) {
                        $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#business_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistBD02');
                    document.getElementById("idEmpresa").innerHTML = "Reporte del Supervisor " + '<b>' + '«' + name_Boss + '»' + '</b>' + " por dias del mes " + '<b>' + parametros.month + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));

                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }

                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Seccionado por Agente-->
<!--Seccionado de Agente por Año-->
<script type="text/javascript">
    var name_Agent = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica01_Agent_Year(pk_business,pkBoss, año) {
        var parametros = {
            pkBusiness: pk_business,
            pkBoss: pkBoss,
            añoPa: año
        }
        
        urlAgenteanio = Report.Urls.reportAgentYearDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlAgenteanio,
                data: { filtro: parametros },
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "nameAgent") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "nameAgent") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);

                    $("#btnAgentAño1").show();
                    $("#btnAgentAño2").show();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();




                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection', showColorCode: true, isHtml: false },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };


                    if (data1.getNumberOfRows() <= 12) {
                        $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#business_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAA02');
                    document.getElementById("idEmpresa").innerHTML = "Reporte de Agentes del " + " " + parametros.añoPa;
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            var name = data1.getValue(select.row, 0);
                            name_Agent = name;
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].Header == "nameAgent") {
                                    if (data[i].Value == name) {
                                        PKAGENT = data[i].pk_agent;

                                    }
                                }
                            }


                            YEAR = parametros.añoPa;
                            if (  PKAGENT != 0 && YEAR != 0) {

                                grafica02_Agent_Month(parametros.pkBusiness, PKAGENT, YEAR);

                                document.getElementById("AgentMonth").innerHTML = "Agente " + " " + name;
                                $("#agentMonth").show();
                                activaTab('ttt');

                                $(document).ready(function () {
                                    $("#AgentMonth").click(function () {

                                        grafica_Agent_Month(PKAGENT, YEAR);

                                        $("#bossMonth").hide();
                                        $("#bossDay").hide();
                                        $("#agentMonth").show();
                                        $("#agentDay").hide();

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnAgentMes1").show();
                                        $("#btnAgentMes2").show();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentMes1").click(function () {

                                        grafica_Agent_Month(PKAGENT, YEAR);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();


                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnAgentMes2").click(function () {

                                        grafica02_Agent_Month(parametros.pkBusiness, PKAGENT, YEAR);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();






                                    });
                                });

                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);

                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }

                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Seccionado de Agente por Mes-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });

    function grafica02_Agent_Month(pk_business,pkAgent, año) {
        var parametros = {
            pkBusiness: pk_business,
            pkAgent: pkAgent,
            año: año
        }
        
        urlAgenteMes = Report.Urls.reportAgentMonthDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlAgenteMes,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "MONTH") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "MONTH") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").show();
                    $("#btnAgentMes2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#business_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAM02');

                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + '<b>' + '«' + name_Agent + '»' + '</b>' + " " + "por meses de" + " " + '<b>' + parametros.año + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            MONTH = data1.getValue(select.row, 0);
                            //
                            AÑO = parametros.año;
                            Agent_id = parametros.pkAgent;
                            for (var i = 0; i < data.length; i++) {
                                var array = new Array();
                                if (data[i].pkAgent == Agent_id) {
                                    name = data[i].nameAgent;


                                }
                            }

                            if ( Agent_id != 0 && MONTH != "" && AÑO != "") {

                                grafica03_Agent_Day( parametros.pkBusiness ,Agent_id, MONTH, AÑO);

                                document.getElementById("AgentDay").innerHTML = MONTH + " " + "del" + " " + AÑO;
                                $("#agentDay").show();
                                activaTab('ñññ');

                                $(document).ready(function () {
                                    $("#AgentDay").click(function () {

                                        grafica_Agent_Day(Agent_id, MONTH, YEAR);

                                        $("#bossMonth").hide();
                                        $("#bossDay").hide();
                                        $("#agentMonth").show();
                                        $("#agentDay").show();

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").show();
                                        $("#btnAgentDia2").show();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentDia1").click(function () {

                                        grafica_Agent_Day(Agent_id, MONTH, AÑO);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();


                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnAgentDia2").click(function () {

                                            grafica03_Agent_Day(parametros.pkBusiness ,Agent_id, MONTH, AÑO);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();





                                    });
                                });
                            }
                        }

                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);

                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }

                    chart.draw(view, options);
                },
                error: function () {

                    console.log(data);
                }
            })
        });
    }
        
</script>

<!--Seccionado de Agente por Dia-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica03_Agent_Day(pk_business,pkAgent, month, año) {
        var parametros = {
            pkBusiness: pk_business,
            pkAgent: pkAgent,
            month: month,
            año: año
        }
        
        urlAgenteDia = Report.Urls.reportAgentDayDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlAgenteDia,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "DateCreated") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "DateCreated") {
                            var values = data[i].Value.toString();
                            var value = values.substring(0, 10);
                            result.push(value);
                        }


                    }
                    data1.addRow(result);

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").show();
                    $("#btnAgentDia2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };


                    if (data1.getNumberOfRows() <= 12) {
                        $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#business_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAD02');
                   
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));
                    function selectItem() {
                        var select = chart.getSelection()[0];
                        Agente_id = parametros.pkAgent;
                        Day = data1.getValue(select.row, 0);
                        var name = "";

                        for (var i = 0; i < data.length; i++) {
                            var array = new Array();
                            if (data[i].pkAgent == Agente_id) {
                                name = data[i].nameAgent;

                            }
                        }
                        $(document).ready(function () {
                            $("#btnAgentLlamada1").click(function () {//PSF

                                Report_Call(Agente_id, Day);//PSF

                                $("#btnBossAño1").hide();
                                $("#btnBossAño2").hide();
                                $("#btnAgentAño1").hide();
                                $("#btnAgentAño2").hide();
                                $("#btnBossMes1").hide();
                                $("#btnBossMes2").hide();
                                $("#btnBossDia1").hide();
                                $("#btnBossDia2").hide();
                                $("#btnAgentMes1").hide();
                                $("#btnAgentMes2").hide();
                                $("#btnAgentDia1").hide();
                                $("#btnAgentDia2").hide();


                            });
                        });


                        $(document).ready(function () {
                            $("#btnAgentLlamada2").click(function () {//PSF 

                                Report_Call_Segmentado(parametros.pkBusiness, Agente_id, Day);//PSF

                                $("#btnBossAño1").hide();
                                $("#btnBossAño2").hide();
                                $("#btnAgentAño1").hide();
                                $("#btnAgentAño2").hide();
                                $("#btnBossMes1").hide();
                                $("#btnBossMes2").hide();
                                $("#btnBossDia1").hide();
                                $("#btnBossDia2").hide();
                                $("#btnAgentMes1").hide();
                                $("#btnAgentMes2").hide();
                                $("#btnAgentDia1").hide();
                                $("#btnAgentDia2").hide();



                            });
                        });
                        if (select) {
                            if ( Agente_id != 0 && Day != "") {

                                Report_Call_Segmentado(parametros.pkBusiness,Agente_id, Day);
                                $("#agentCall").show();
                                document.getElementById("AgentCall").innerHTML = "Llamadas del Agente  " + name + " " + "del" + " " + Day;

                                $("#agentCall").show();
                                activaTab('yyy');

                            }
                        }
                    }
                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + '<b>' + '«' + name_Agent + '»' + '</b>' + " por dias del mes " + '<b>' + parametros.month + '</b>';
                    google.visualization.events.addListener(chart, 'select', selectItem);

                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }

                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Seccionado de Agente por Llamada-->
<script type="text/javascript">
    var countReg = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function Report_Call_Segmentado(pk_business,pkAgent, dias) {
        var parametros = {
            pkBusiness: pk_business,
            pkAgent: pkAgent,
            dias: dias
        };
        
        urlAgenteLlamada = Report.Urls.reportAgentCallDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlAgenteLlamada,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();

                    countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "hours") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "hours") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);


                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").show();
                    $("#btnAgentLlamada2").show();


                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#business_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#business_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAL02');
                   
                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + '<b>' + '«' + name_Agent + '»' + '</b>' + " de las llamadas del " + '<b>' + parametros.dias + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("business_div_chart"));
                    
                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }

                    chart.draw(view, options);



                },
                error: function () {
                    console.log(data);
                }

            })

        });
    }

</script>