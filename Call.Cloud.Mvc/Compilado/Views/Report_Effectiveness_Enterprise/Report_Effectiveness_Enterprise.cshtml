@model Call.Cloud.Mvc.Models.Effectiveness.ListaReportEnterprise
@{
    ViewBag.Title = "Report_Effectiveness_Enterprise";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!--Url of Action with Controller-->
<head>

    <script type="text/javascript">
        
        var cuenta = 0;


        var Report = "";
        Report = Report || {};
        Report.Urls = Report.Urls || {};
        Report.Urls.baseUrl = '@Url.Action("~")';
        Report.Urls.report = '@Url.Action("Enterprise_Year", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportOFfice = '@Url.Action("Office_Year", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportMonth = '@Url.Action("Chart_Month", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportDayEnterprise = '@Url.Action("Chart_DayEnterprise", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportSubOffice = '@Url.Action("Chart_SubOffice_Year", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportMonthOffice = '@Url.Action("ChartOfficeMonth", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportDayOffice = '@Url.Action("chartOfficeDay", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportMonthSubOffice = '@Url.Action("Chart_SubOffice_Month", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportDaySubOffice = '@Url.Action("Chart_SubOffice_Day", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportBusiness = '@Url.Action("Chart_Business_Year", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportMonthBusiness = '@Url.Action("Chart_Business_Month", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportDayBusiness = '@Url.Action("Chart_Business_Day", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportBoss = '@Url.Action("Chart_Boss_Year", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportMonthBoss = '@Url.Action("Chart_Boss_Month", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportDayBoss = '@Url.Action("Chart_Boss_Day", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportAgent = '@Url.Action("Chart_Agent_Year", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportMonthAgent = '@Url.Action("Chart_Agent_Month", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportDayAgent = '@Url.Action("Chart_Agent_Day", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportCallAgent = '@Url.Action("Agent_LLamada", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportSegmentadoBoss = '@Url.Action("Report_Effectiveness_Year", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportSegmentadoMonthBoss = '@Url.Action("Report_Effectiveness_Month", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportSegmentadoDayBoss = '@Url.Action("Report_Effectiveness_Day", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportSegmentadoAgent = '@Url.Action("Agent_Year", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportSegmentadoMonthAgent = '@Url.Action("Agent_Month", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportSegmentadoDayAgent = '@Url.Action("Agent_Day", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportSegmentadoCallAgent = '@Url.Action("Report_Agent_call", "Report_Effectiveness_Enterprise")';

        //dinámico
        Report.Urls.reportBossDinamico = '@Url.Action("dinamico0001", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportBossMonthDinamico = '@Url.Action("dinamico_Boss_Month", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportBossDayDinamico = '@Url.Action("dinamico_Boss_Day", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportAgentYearDinamico = '@Url.Action("dinamico_agent_Year", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportAgentMonthDinamico = '@Url.Action("dinamico_agent_Month", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportAgentDayDinamico = '@Url.Action("dinamico_Agent_Day", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportAgentCallDinamico = '@Url.Action("dinamico_Agent_Call", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportNameRule = '@Url.Action("nameRule_name", "Report_Effectiveness_Enterprise")';
        Report.Urls.reportListaRule='@Url.Action("lista_rule", "Report_Effectiveness_Enterprise")'
        Report.Urls.idsection = '@Url.Action("id_section", "Report_Effectiveness_Enterprise")';

       

    </script>
    <link href="~/Content/css/chartist.min.css" rel="stylesheet" />
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>

</head>

<div class="page animsition">
    <!--Cabecera-->
    <div class="page-header">
        <div class="form-group form-material" style="text-align:center;">
            <div class="col-sm-12">
                <div class="col-sm-3" style="width:150px;height:40px;"></div>
                <div class="col-sm-3" style="width:150px; height:40px;">
                    <h5>@Html.Label("codigoEmpresa", "ENTERPRISE  ", htmlAttributes: new { @class = "control-label col-sm-2" })</h5>
                </div>
                <div class="col-sm-3" style="width:700px; height:40px;">
                    @Html.DropDownListFor(model => model.Filtro.pk_enterprise, Model.ListaEnterprise, new { @class = "form-control" })
                </div>
                <div class="col-sm-3" style="width:100px; height:40px;">
                    <button id="btnBuscar" class="btn btn-primary" type="button" onclick="grafica01();">Buscar</button>
                    <h6 id="idsection" style="display:inline"></h6>

                </div>
            </div>
        </div>
    </div>

    <!--Navegacion-->
    <div class="panel-body">
        <div class="form-group form-material">
            <h2 id="idEmpresa" style="text-align:center;color:chocolate"> </h2>
            <ul class="nav nav-tabs" style="float:left;">
                <li id="enterpriseYear"><a href="#aaa" data-toggle="tab" id="EnterpriseYear" style="color:chocolate; border-bottom:groove"></a></li>
                <li id="officeYear"><a href="#bbb" data-toggle="tab" id="OfficeYear" style="color:chocolate; border-bottom:groove"></a></li>
                <li id="subOfficeYear"><a href="#ccc" data-toggle="tab" id="SubOfficeYear" style="color:chocolate; border-bottom:groove"></a></li>
                <li id="businessYear"><a href="#ddd" data-toggle="tab" id="BusinessYear" style="color:chocolate; border-bottom:groove"></a></li>
                <li id="BossYear01"><a href="#eee" data-toggle="tab" id="BossYear" style="color:chocolate; border-bottom:groove"></a></li>
                <li id="agentYear"><a href="#rrr" data-toggle="tab" id="AgentYear" style="color:chocolate; border-bottom:groove"></a></li>

                <li id="enterpriseMonth"><a href="#www" data-toggle="tab" id="EnterpriseMonth" style="color:darkred; border-bottom:groove"></a></li>
                <li id="enterpriseDay"><a href="#fff" data-toggle="tab" id="EnterpriseDay" style="color:darkred; border-bottom:groove"></a></li>

                <li id="officeMonth"><a href="#hhh" data-toggle="tab" id="OfficeMonth" style="color:darkred; border-bottom:groove"></a></li>
                <li id="officeDay"><a href="#jjj" data-toggle="tab" id="OfficeDay" style="color:darkred; border-bottom:groove"></a></li>

                <li id="subOfficeMonth"><a href="#kkk" data-toggle="tab" id="SubOfficeMonth" style="color:darkred; border-bottom:groove"></a></li>
                <li id="subOfficeDay"><a href="#lll" data-toggle="tab" id="SubOfficeDay" style="color:darkred; border-bottom:groove"></a></li>

                <li id="businessMonth"><a href="#nnn" data-toggle="tab" id="BusinessMonth" style="color:darkred; border-bottom:groove"></a></li>
                <li id="businessDay"><a href="#mmm" data-toggle="tab" id="BusinessDay" style="color:darkred; border-bottom:groove"></a></li>

                <li id="bossMonth"><a href="#ppp" data-toggle="tab" id="BossMonth" style="color:darkred; border-bottom:groove"></a></li>
                <li id="bossDay"><a href="#sss" data-toggle="tab" id="BossDay" style="color:darkred; border-bottom:groove"></a></li>

                <li id="agentMonth"><a href="#ttt" data-toggle="tab" id="AgentMonth" style="color:darkred; border-bottom:groove"></a></li>
                <li id="agentDay"><a href="#ñññ" data-toggle="tab" id="AgentDay" style="color:darkred; border-bottom:groove"></a></li>
                <li id="agentCall"><a href="#yyy" data-toggle="tab" id="AgentCall" style="color:darkred; border-bottom:groove"></a></li>
            </ul>
        </div>

        <!--Los div donde se ven las barras-->
        <div class="form-group form-material">
            <div id="divGrid01" class="col-sm-12">
                <br />
                <div class="col-sm-1">
                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistBA01" data-toggle="tab" id="btnBossAño1" style="display:none; ">View1</a></li>
                        <li><a href="#vistBA02" data-toggle="tab" id="btnBossAño2" style="display: none;">View2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistBM01" data-toggle="tab" id="btnBossMes1" style="display:none; ">View1</a></li>
                        <li><a href="#vistBM02" data-toggle="tab" id="btnBossMes2" style="display:none; ">View2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistBD01" data-toggle="tab" id="btnBossDia1" style="display:none; ">View1</a></li>
                        <li><a href="#vistBD02" data-toggle="tab" id="btnBossDia2" style="display: none; ">View2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistAA01" data-toggle="tab" id="btnAgentAño1" style="display:none; ">View1</a></li>
                        <li><a href="#vistAA02" data-toggle="tab" id="btnAgentAño2" style="display: none; ">View2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistAM01" data-toggle="tab" id="btnAgentMes1" style="display:none; ">View1</a></li>
                        <li><a href="#vistAM02" data-toggle="tab" id="btnAgentMes2" style="display: none; ">View2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistAD01" data-toggle="tab" id="btnAgentDia1" style="display:none; ">View1</a></li>
                        <li><a href="#vistAD02" data-toggle="tab" id="btnAgentDia2" style="display: none; ">View2</a></li>
                    </ul>

                    <ul class="nav nav-tabs" style="float:left;">
                        <li><a href="#vistAL01" data-toggle="tab" id="btnAgentLlamada1" style="display:none; ">View1</a></li>
                        <li><a href="#vistAL02" data-toggle="tab" id="btnAgentLlamada2" style="display: none; ">View2</a></li>
                    </ul>
                </div>
                <div class="col-sm-11">
                    <div id="contenedor" class="tab-content" style="overflow-x:scroll; overflow-y:hidden">
                        <!-- Aquí va el contenido -->
                       <div id="div_chart">
                        </div>
                       
                        <!-- Fin del Contenido -->
                    </div>
                    <div id="GridView" style="display:none">
                        @Html.Partial("Grid_Rule");

                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<!--Activar tabs-->
<script>
    function activaTab(tab) {
        $('.nav-tabs a[href="#' + tab + '"]').tab('show');
    };

    function desactivartab(tab) {
        $('.nav-tabs a[href="#' + tab + '"]').tab('hide');
    }
</script>

<!--Ocultar navegacion-->
<script>
    $(document).ready(function () {
        document.getElementById("enterpriseYear").style.display = 'none';
        document.getElementById("enterpriseMonth").style.display = 'none';
        document.getElementById("enterpriseDay").style.display = 'none';
        document.getElementById("officeYear").style.display = 'none';
        document.getElementById("officeMonth").style.display = 'none';
        document.getElementById("officeDay").style.display = 'none';
        document.getElementById("subOfficeYear").style.display = 'none';
        document.getElementById("subOfficeMonth").style.display = 'none';
        document.getElementById("subOfficeDay").style.display = 'none';
        document.getElementById("businessYear").style.display = 'none';
        document.getElementById("businessMonth").style.display = 'none';
        document.getElementById("businessDay").style.display = 'none';
        document.getElementById("BossYear01").style.display = 'none';
        document.getElementById("bossMonth").style.display = 'none';
        document.getElementById("bossDay").style.display = 'none';
        document.getElementById("agentYear").style.display = 'none';
        document.getElementById("agentMonth").style.display = 'none';
        document.getElementById("agentDay").style.display = 'none';
        document.getElementById("agentCall").style.display = 'none';
        document.getElementById("contenedor").style.display = 'none';
    });
</script>

<!--Empresa por año-->
<script type="text/javascript">
    
    var año01 = 0;
    var pk_enterprise01 = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica01() {
        pk_enterprise01 = $("#Filtro_pk_enterprise").val();
        var parametros = {
            pk_enterprise: pk_enterprise01,
        };
        
        var urlReporteEnterprise = Report.Urls.report;
        
        //alert("Reporte Grafico 1");
        $(function () {
            
            $.ajax({
                url: urlReporteEnterprise,
                data: {
                    filtro: parametros
                },
                type: 'POST',
                dataType: 'json',
                success: function (data) {
                    //alert("Reporte Grafico 2");
                    var data1 = new google.visualization.DataTable();
                    // año es x
                    data1.addColumn('string', 'año');
                    // result es y
                    data1.addColumn('number', 'Efficiency Percentage by Company');
                    data1.addColumn('number', 'Below the criterion');

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };
                    // Para que no ingrese varias veces a la misma pagina.
                    cuenta = 0;
                    $(document).ready(function () {
                        $("#EnterpriseYear").click(function () {
                            cuenta = cuenta + 1;
                            alert("mensaje");
                            if (cuenta == 1) {
                                //alert("Condicion");
                                grafica01();
                                
                                $("#enterpriseYear").show();
                                $("#enterpriseMonth").hide();
                                $("#enterpriseDay").hide();
                                $("#officeYear").hide();
                                $("#officeMonth").hide();
                                $("#officeDay").hide();
                                $("#subOfficeYear").hide();
                                $("#subOfficeMonth").hide();
                                $("#subOfficeDay").hide();
                                $("#businessYear").hide();
                                $("#businessMonth").hide();
                                $("#businessDay").hide();
                                $("#BossYear01").hide();
                                $("#bossMonth").hide();
                                $("#bossDay").hide();
                                $("#agentYear").hide();
                                $("#agentMonth").hide();
                                $("#agentDay").hide();
                                $("#agentCall").hide();
                                $("#btnBossAño1").hide();
                                $("#btnBossAño2").hide();
                                $("#btnBossMes1").hide();
                                $("#btnBossMes2").hide();
                                $("#btnBossDia1").hide();
                                $("#btnBossDia2").hide();
                                $("#btnAgentAño1").hide();
                                $("#btnAgentAño2").hide();
                                $("#btnAgentMes1").hide();
                                $("#btnAgentMes2").hide();
                                $("#btnAgentDia1").hide();
                                $("#btnAgentDia2").hide();
                                $("#btnAgentLlamada1").hide();
                                $("#btnAgentLlamada2").hide();
                            }

                        });
                    });

                    var view = new google.visualization.DataView(data1);
                    
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,

                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].año, data[i].result, null]);
                                
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].año, null, data[i].result]);
                            }
                        }
                    };


                    for (var i = 0; i < data.length; i++) {
                        if (data[i].pk_enterprise == pk_enterprise01) {
                            año01 = data[i].año;
                            pk_enterprise01 = data[i].pk_enterprise;
                            var name = data[i].name_enterprise;
                            document.getElementById("EnterpriseYear").innerHTML = "Enterprise " + " " + name;
                            document.getElementById("idEmpresa").innerHTML = "Report of " + " " + name + " " + "by" + " " + "Year";

                            //alert("mensaje");
                            
                            $("#enterpriseYear").show();
                            $("#contenedor").show();
                        }
                    }
                    
                    activaTab('aaa');
                    if (data.length <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    chart.setAction({
                        id: 'btnoffice',
                        text: 'Office',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                                data1.getValue(chart.getSelection()[0].row, 1));
                            año01 = data1.getValue(chart.getSelection()[0].row, 0);
                            chart.draw(view, options);
                            pk_enterprise01 = parametros.pk_enterprise;

                            if (pk_enterprise01 != 0 && año01 != 0) {

                                graficaOffice(pk_enterprise01, año01);

                                document.getElementById("OfficeYear").innerHTML = "Office Report" + " " + año01;

                                document.getElementById("officeYear").style.display = 'inline';
                                document.getElementById("idEmpresa").innerHTML = "Office Report" + "of the " + año01;
                                activaTab('bbb');

                            }

                            $(document).ready(function () {
                                
                                $("#OfficeYear").click(function () {

                                    graficaOffice(pk_enterprise01, año01);

                                    $("#enterpriseYear").hide();
                                    $("#enterpriseMonth").hide();
                                    $("#enterpriseDay").hide();
                                    $("#officeYear").show();
                                    $("#officeMonth").hide();
                                    $("#officeDay").hide();
                                    $("#subOfficeYear").hide();
                                    $("#subOfficeMonth").hide();
                                    $("#subOfficeDay").hide();
                                    $("#businessYear").hide();
                                    $("#businessMonth").hide();
                                    $("#businessDay").hide();
                                    $("#BossYear01").hide();
                                    $("#bossMonth").hide();
                                    $("#bossDay").hide();
                                    $("#agentYear").hide();
                                    $("#agentMonth").hide();
                                    $("#agentDay").hide();
                                    $("#agentCall").hide();
                                    $("#btnBossAño1").hide();
                                    $("#btnBossAño2").hide();
                                    $("#btnBossMes1").hide();
                                    $("#btnBossMes2").hide();
                                    $("#btnBossDia1").hide();
                                    $("#btnBossDia2").hide();
                                    $("#btnAgentAño1").hide();
                                    $("#btnAgentAño2").hide();
                                    $("#btnAgentMes1").hide();
                                    $("#btnAgentMes2").hide();
                                    $("#btnAgentDia1").hide();
                                    $("#btnAgentDia2").hide();
                                    $("#btnAgentLlamada1").hide();
                                    $("#btnAgentLlamada2").hide();
                                    $("#GridView").hide();

                                })
                            });
                        }
                    });

                    chart.setAction({
                        id: 'mes',
                        text: 'Month',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                                data1.getValue(chart.getSelection()[0].row, 1));
                            var select = chart.getSelection()[0];
                            año01 = data1.getValue(select.row, 0);
                            pk_enterprise01 = parametros.pk_enterprise;
                            chart.draw(view, options);
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].pk_enterprise == pk_enterprise01) {
                                    var name = data[i].name_enterprise;
                                }
                            }
                            if (pk_enterprise01 != 0 && año01 != 0) {

                                graficaMonthEnterprise(pk_enterprise01, año01);

                                document.getElementById("EnterpriseMonth").innerHTML = "Report of the months of" + " " + año01;
                                document.getElementById("idEmpresa").innerHTML = "Report of" + " " + name + " " + "of the year " + " " + año01 + " " + "for months";
                                document.getElementById("enterpriseMonth").style.display = 'inline';
                                activaTab('www');
                            }


                            $(document).ready(function () {
                                $("#EnterpriseMonth").click(function () {

                                    graficaMonthEnterprise(pk_enterprise01, año01);

                                    $("#enterpriseYear").show();
                                    $("#enterpriseMonth").show();
                                    $("#enterpriseDay").hide();
                                    $("#officeYear").hide();
                                    $("#officeMonth").hide();
                                    $("#officeDay").hide();
                                    $("#subOfficeYear").hide();
                                    $("#subOfficeMonth").hide();
                                    $("#subOfficeDay").hide();
                                    $("#businessYear").hide();
                                    $("#businessMonth").hide();
                                    $("#businessDay").hide();
                                    $("#BossYear01").hide();
                                    $("#bossMonth").hide();
                                    $("#bossDay").hide();
                                    $("#agentYear").hide();
                                    $("#agentMonth").hide();
                                    $("#agentDay").hide();
                                    $("#agentCall").hide();
                                    $("#btnBossAño1").hide();
                                    $("#btnBossAño2").hide();
                                    $("#btnBossMes1").hide();
                                    $("#btnBossMes2").hide();
                                    $("#btnBossDia1").hide();
                                    $("#btnBossDia2").hide();
                                    $("#btnAgentAño1").hide();
                                    $("#btnAgentAño2").hide();
                                    $("#btnAgentMes1").hide();
                                    $("#btnAgentMes2").hide();
                                    $("#btnAgentDia1").hide();
                                    $("#btnAgentDia2").hide();
                                    $("#btnAgentLlamada1").hide();
                                    $("#btnAgentLlamada2").hide();

                                });
                            });
                        }
                    });

                    chart.draw(view, options);
                    
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Empresa por mes-->
<script type="text/javascript">
    var mes01 = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function graficaMonthEnterprise(pk_enterprise1, año1) {
        
        var parametros = {
            pk_enterprise: pk_enterprise1,
            año: año1
        };
        
        var urlMes = Report.Urls.reportMonth;
        
        $(function () {
            $.ajax({
                url: urlMes,
                data: {
                    filtro: parametros
                },
                type: 'POST',
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Percentage of Effectiveness per Month - Enterprise');
                    data1.addColumn('number', 'Below the criterion');

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);

                    for (var i = 0; i < data.length; i++) {
                        
                        if (data[i].result == -1 && data[i].quantityCall == -1) {


                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                                
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };


                    var name = "";
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].pk_enterprise == parametros.pk_enterprise) {
                            name = data[i].name;
                            
                        }
                    }

                    $("#div_chart").css({ "height": "400px", "width": "auto" });
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    function selectItems() {
                        var selectItem = chart.getSelection()[0];
                        if (selectItem) {
                            mes01 = data1.getValue(selectItem.row, 0);

                            pk_enterprise01 = parametros.pk_enterprise;
                            año01 = parametros.año;
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].pk_enterprise == pk_enterprise01) {
                                    var name = data[i].name_enterprise;
                                }
                            }

                            if (pk_enterprise01 != 0 && mes01 != "" && año01 != 0) {

                                grafica03EnterpriseDay(pk_enterprise01, mes01, año01);
                                
                                $("#enterpriseDay").show();
                                document.getElementById("EnterpriseDay").innerHTML = "Report of " + " " + mes01 + " " + "o f the" + " " + año01;
                                document.getElementById("idEmpresa").innerHTML = "Report of" + " " + name + " " + "of the year" + " " + año01 + " " + " of the month" + " " + mes01;
                                activaTab('fff');

                            }


                        }
                    }

                    google.visualization.events.addListener(chart, 'select', selectItems);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                    
                }
            })
        });
    }
</script>

<!--Empresa por dia-->
<script type="text/javascript">
    google.load('current', { 'packages': ['corechart'] });
    function grafica03EnterpriseDay(pk_enterprise, month, año) {
        
        var parametros = {
            pk_enterprise: pk_enterprise,
            month: month,
            año: año
        };
        

        var urlPorDiaEnterprise = Report.Urls.reportDayEnterprise;
        

        $(function () {
            $.ajax({
                url: urlPorDiaEnterprise,
                data: {
                    filtro: parametros
                },
                type: 'POST',
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Efficiency Percentage Per Day - Enterprise');
                    data1.addColumn('number', 'Below the criterion');

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dateCreate, data[i].result, null]);
                                
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dateCreate, null, data[i].result]);
                                
                            }
                        }
                    };

                    if (data.length <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }Nego
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                    

                    //alert('Error');
                }
            })
        })
    }
</script>

<!--Oficina año-->
<script type="text/javascript">
    var pk_office01 = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function graficaOffice(pk_enterprise, añoo) {
        
        var parametros = {
            pk_enterprise: pk_enterprise,
            año: añoo
        };

        var urlOffice = Report.Urls.reportOFfice;
        
        $(function () {
            $.ajax({
                url: urlOffice,
                data: {
                    filtro: parametros
                },
                type: 'POST',
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'year');
                    data1.addColumn('number', 'Percentage of Effectiveness by Office');
                    data1.addColumn('number', 'Below the criterion');

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].name_office, data[i].result, null]);
                                
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].name_office, null, data[i].result]);
                                
                            }
                        }
                    };

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,

                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }

                    ]);

                    if (data.length <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    chart.setAction({
                        id: 'suboffice',
                        text: 'SubOffice',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                                data1.getValue(chart.getSelection()[0].row, 1));
                            var select = chart.getSelection()[0];
                            var name = data1.getValue(select.row, 0);
                            año01 = parametros.año;

                            for (var i = 0; i < data.length; i++) {
                                if (data[i].name_office == name) {
                                    pk_office01 = data[i].pk_office;

                                }
                            }

                            
                            chart.draw(view, options);

                            if (pk_office01 != 0 && año01 != 0) {

                                graficaSubOfficeYear(pk_office01, año01);
                                document.getElementById("SubOfficeYear").innerHTML = "SubOffice Report of the" + " " + año01;
                                document.getElementById("subOfficeYear").style.display = 'inline';

                                document.getElementById("idEmpresa").innerHTML = "SubOffices Report" + " " + "of the" + " " + año01;
                                activaTab('ccc');

                                $(document).ready(function () {
                                    $("#SubOfficeYear").click(function () {

                                        graficaSubOfficeYear(pk_office01, año01);

                                        $("#officeYear").show();
                                        $("#subOfficeYear").show();
                                        $("#businessYear").hide();
                                        $("#BossYear01").hide();
                                        $("#agentYear").hide();
                                        $("#agentCall").hide();
                                        $("#enterpriseMonth").hide();
                                        $("#enterpriseDay").hide();
                                        $("#officeMonth").hide();
                                        $("#officeDay").hide();
                                        $("#subOfficeMonth").hide();
                                        $("#subOfficeDay").hide();
                                        $("#businessMonth").hide();
                                        $("#businessDay").hide();
                                        $("#bossMonth").hide();
                                        $("#bossDay").hide();
                                        $("#agentMonth").hide();
                                        $("#agentDay").hide();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();
                                        $("#GridView").hide();

                                    });
                                });
                            }

                        }
                    });
                    chart.setAction({
                        id: 'mes',
                        text: 'Month',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                                data1.getValue(chart.getSelection()[0].row, 1));
                            var select = chart.getSelection()[0];
                            var name = data1.getValue(select.row, 0);
                            año01 = parametros.año;

                            for (var i = 0; i < data.length; i++) {
                                if (data[i].name_office == name) {
                                    pk_office01 = data[i].pk_office;
                                }
                            }


                            if (pk_office01 != 0 && año01 != 0) {

                                graficaOfficeMonth(pk_office01, año01);
                                document.getElementById("idEmpresa").innerHTML =
                                    "Office Report " + name + " " + "of the" + " " + año01
                                    + " " + "for months";
                                document.getElementById("OfficeMonth").innerHTML = "Office " + " " + name;
                                document.getElementById("officeMonth").style.display = 'inline';
                                activaTab('hhh');
                            }
                            $(document).ready(function () {
                                $("#OfficeMonth").click(function () {

                                    graficaOfficeMonth(pk_office01, año01);

                                    $("#officeYear").show();
                                    $("#subOfficeYear").hide();
                                    $("#businessYear").hide();
                                    $("#bossYear").hide();
                                    $("#agentYear").hide();
                                    $("#agentCall").hide();
                                    $("#enterpriseMonth").hide();
                                    $("#enterpriseDay").hide();
                                    $("#officeMonth").show();
                                    $("#officeDay").hide();
                                    $("#subOfficeMonth").hide();
                                    $("#subOfficeDay").hide();
                                    $("#businessMonth").hide();
                                    $("#businessDay").hide();
                                    $("#bossMonth").hide();
                                    $("#bossDay").hide();
                                    $("#agentMonth").hide();
                                    $("#agentDay").hide();
                                    $("#btnBossAño1").hide();
                                    $("#btnBossAño2").hide();
                                    $("#btnBossMes1").hide();
                                    $("#btnBossMes2").hide();
                                    $("#btnBossDia1").hide();
                                    $("#btnBossDia2").hide();
                                    $("#btnAgentAño1").hide();
                                    $("#btnAgentAño2").hide();
                                    $("#btnAgentMes1").hide();
                                    $("#btnAgentMes2").hide();
                                    $("#btnAgentDia1").hide();
                                    $("#btnAgentDia2").hide();
                                    $("#btnAgentLlamada1").hide();
                                    $("#btnAgentLlamada2").hide();

                                });
                            });

                        }
                    });


                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Office Mes-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    var mes02 = "";
    function graficaOfficeMonth(pk_office1, año) {
        
        var parametros = {
            pk_office: pk_office1,
            año: año,
        }
        var urlmesOFfice = Report.Urls.reportMonthOffice;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlmesOFfice,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Percentage of Effectiveness per Month - Office');
                    data1.addColumn('number', 'Below the criterion');

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                                
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                                
                            }
                        }
                        
                    };

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,

                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);

                    $("#div_chart").css({ "height": "400px", "width": "auto" });
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));
                    function selectItem() {

                        var select = chart.getSelection()[0];
                        if (select) {
                            mes02 = data1.getValue(select.row, 0);

                            año01 = parametros.año;

                            pk_office01 = parametros.pk_office;

                            var name = "";
                            for (var i = 0; i < data.length; i++) {

                                if (data[i].pk_office == pk_office01) {
                                    name = data[i].name_office;
                                }
                            }
                            if (pk_office01 != 0 && mes02 != "" && año01 != 0) {

                                graficaOfficeDay(pk_office01, año01, mes02);

                                document.getElementById("idEmpresa").innerHTML = "Office Report" + name + " " + "of the" + " " + año01 + " " + "for months" + " " + mes02;
                                document.getElementById("OfficeDay").innerHTML = mes02 + " " + "of the" + " " + año01;
                                document.getElementById("officeDay").style.display = 'inline';
                                activaTab('jjj');

                            }
                        }

                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Office Dia-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function graficaOfficeDay(pk_office, año, month) {
        
        var parametros = {
            pk_office: pk_office,
            año: año,
            month: month
        }
        

        var urlDayOffice = Report.Urls.reportDayOffice;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDayOffice,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Efficacy Percentage per day- Office');
                    data1.addColumn('number', 'Below the criterion');

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                            }
                        }
                    };

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,

                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);

                    if (data.length <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));
                    chart.draw(view, options);

                },
                error: function () {
                    console.log(data);

                }
            })
        });
    }

</script>

<!--SubOffice por año-->
<script type="text/javascript">
    var pk_suboffice01 = 0;
    google.charts.load('current', { 'packages': ['corechart'] });;
    function graficaSubOfficeYear(pk_office, año) {
        
        var parametros = {
            pk_office: pk_office,
            año: año
        }
        
        var urlSubOffice = Report.Urls.reportSubOffice;
        
        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlSubOffice,
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'SubOffice');
                    data1.addColumn('number', 'Efficiency Percentage by SubOffice');
                    data1.addColumn('number', 'Below the criterion');

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].nameSubOffice, data[i].result, null]);
                                
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].nameSubOffice, null, data[i].result]);
                            }
                        }
                    };

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,

                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);

                    if (data.length <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    chart.setAction({
                        id: 'Business',
                        text: 'Business',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                                data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            año01 = parametros.año;

                            for (var i = 0; i < data.length; i++) {

                                if (data[i].nameSubOffice == name) {
                                    pk_suboffice01 = [data[i].pkSubOffice];

                                }
                            }

                            chart.draw(view, options);

                            if (pk_suboffice01 != 0 && año01 != 0) {

                                grafica_Business_year(pk_suboffice01, año01);
                                document.getElementById("BusinessYear").innerHTML =
                                    "Business Report of " + " " + año01;
                                document.getElementById("businessYear").style.display = 'inline';
                                document.getElementById("idEmpresa").innerHTML =
                                    "Business Reports of " + " " + año01;
                                activaTab('ddd');

                                $(document).ready(function () {
                                    $("#BusinessYear").click(function () {

                                        grafica_Business_year(pk_suboffice01, año01);

                                        $("#officeYear").show();
                                        $("#subOfficeYear").show();
                                        $("#businessYear").show();
                                        $("#BossYear01").hide();
                                        $("#agentYear").hide();
                                        $("#agentCall").hide();
                                        $("#enterpriseMonth").hide();
                                        $("#enterpriseDay").hide();
                                        $("#officeMonth").hide();
                                        $("#officeDay").hide();
                                        $("#subOfficeMonth").hide();
                                        $("#subOfficeDay").hide();
                                        $("#businessMonth").hide();
                                        $("#businessDay").hide();
                                        $("#bossMonth").hide();
                                        $("#bossDay").hide();
                                        $("#agentMonth").hide();
                                        $("#agentDay").hide();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();
                                        $("#GridView").hide();


                                    });
                                });
                            }

                        }

                    });

                    chart.setAction({
                        id: 'mes',
                        text: 'Month',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                                data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            año01 = parametros.año;


                            for (var i = 0; i < data.length; i++) {

                                if (data[i].nameSubOffice == name) {
                                    pk_suboffice01 = [data[i].pkSubOffice];
                                }
                            }

                            chart.draw(view, options);
                            if (pk_suboffice01 != 0 && año01 != 0) {

                                grafica_subOffice_month(pk_suboffice01, año01);
                                document.getElementById("idEmpresa").innerHTML =
                                    " SubOffice Report " + name + " " + "of the" + " "
                                    + año01 + " " + "for months";
                                document.getElementById("SubOfficeMonth").innerHTML =
                                    "SubOffice :" + " " + name;
                                document.getElementById("subOfficeMonth").style.display = 'inline'
                                activaTab('kkk');

                                $(document).ready(function () {
                                    $("#subOfficeMonth").click(function () {

                                        grafica_subOffice_month(pk_suboffice01, año01);

                                        $("#officeYear").show();
                                        $("#subOfficeYear").show();
                                        $("#businessYear").hide();
                                        $("#BossYear01").hide();
                                        $("#agentYear").hide();
                                        $("#agentCall").hide();
                                        $("#enterpriseMonth").hide();
                                        $("#enterpriseDay").hide();
                                        $("#officeMonth").hide();
                                        $("#officeDay").hide();
                                        $("#subOfficeMonth").show();
                                        $("#subOfficeDay").hide();
                                        $("#businessMonth").hide();
                                        $("#businessDay").hide();
                                        $("#bossMonth").hide();
                                        $("#bossDay").hide();
                                        $("#agentMonth").hide();
                                        $("#agentDay").hide();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });
                            }
                        }
                    });
                    chart.draw(view, options);
                    
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }
</script>

<!--SubOffice por Mes-->
<script type="text/javascript">
    var mes03 = "";

    google.charts.load('current', { 'packages': ['corechart'] });
    
    function grafica_subOffice_month(pkSubOffice, año) {
        var parametros = {
            pkSubOffice: pkSubOffice,
            año: año
        }
        
        var urlMesSubOffice = Report.Urls.reportMonthSubOffice;
        
        $(function () {
            $.ajax({
                type: 'POST',
                url: urlMesSubOffice,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Efficacy Percentage per Month - SubOffice');
                    data1.addColumn('number', 'Below the criterion');

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);
                    console.log(parametros);
                    
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };

                    $("#div_chart").css({ "height": "400px", "width": "auto" });
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            mes03 = data1.getValue(select.row, 0);

                            año01 = parametros.año;

                            pk_suboffice01 = parametros.pkSubOffice;

                            var name = "";
                            for (var i = 0; i < data.length; i++) {

                                if (data[i].pkSubOffice == pk_suboffice01) {
                                    name = data[i].name;
                                }
                            }
                            if (pk_suboffice01 != 0 && año01 != 0 && mes03 != "") {

                                graficasubOffice_Day(pk_suboffice01, año01, mes03);
                                if (document.getElementById("idEmpresa")) {
                                    document.getElementById("idEmpresa").innerHTML =
                                        " SubOffice Report " + name + " " + "of" + " "
                                        + mes + " " + "of the" + " " + año01;
                                    document.getElementById("SubOfficeDay").innerHTML = mes03
                                        + " " + "of the" + " " + año01;
                                    document.getElementById("subOfficeDay").style = "inline";
                                    activaTab('lll');
                                }
                            }
                        }
                        console.log(parametros);
                        
                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }
</script>

<!--SubOffice por dia-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function graficasubOffice_Day(pkSubOffice, año, month) {
        
        var parametros = {
            pkSubOffice: pkSubOffice,
            año: año,
            month: month
        }
        
        var urlDaySubOffice = Report.Urls.reportDaySubOffice;
        
        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDaySubOffice,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Percentage of Effectiveness per day - SubOffice');
                    data1.addColumn('number', 'Below the criterion');

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);
                    console.log(parametros);
                    
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                            }
                        }
                    };

                    if (data.length <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Business por Año-->
<script type="text/javascript">
    var pkbusiness01 = 0;
    var año01 = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Business_year(pkSubOffice, año) {
        
        var parametros = {
            pkSubOffice: pkSubOffice,
            año: año
        }
        
        var urlYearBusiness = Report.Urls.reportBusiness;
        

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlYearBusiness,

                data: { filtro: parametros },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'Business');
                    data1.addColumn('number', 'Efficiency Percentage by Business - Year');
                    data1.addColumn('number', 'Below the criterion');

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].nameBusiness, data[i].result, null]);
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].nameBusiness, null, data[i].result]);
                            }
                        }
                    };

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },// Tamaño de las barras.
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);

                    if (data.length <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    chart.setAction({
                        id: 'Boss',
                        text: 'Boss',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                                data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);


                            for (var i = 0; i < data.length; i++) {

                                if (data[i].nameBusiness == name) {
                                    pkbusiness01 = data[i].pkBusiness;
                                }
                            }
                            año01 = parametros.año;
                            chart.draw(view, options);
                            if (pkbusiness01 != 0 && año01 != 0) {

                                grafica_Boss_Year(pkbusiness01, año01);
                                document.getElementById("BossYear").innerHTML = "Boss Report" + " " + año01;
                                $("#BossYear01").show();
                                $("#BossYear").show();
                                document.getElementById("idEmpresa").innerHTML =
                                    "Boss Report" + " " + año01;
                                activaTab('eee');

                                $(document).ready(function () {
                                    $("#BossYear").click(function () {
                                        grafica_Boss_Year(pkbusiness01, año01);
                                        $("#agentYear").hide();
                                        $("#agentCall").hide();
                                        $("#agentDay").hide();
                                        $("#agentMonth").hide();
                                        $("#bossDay").hide();
                                        $("#bossMonth").hide();
                                        $("#officeYear").show();
                                        $("#subOfficeYear").show();
                                        $("#businessYear").show();
                                        $("#BossYear01").show();
                                        $("#btnBossMes1").show();
                                        $("#btnBossMes2").show();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();
                                        $("#GridView").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#BusinessMonth").click(function () {

                                        grafica_Business_Month(pkbusiness01, año01);

                                        $("#officeYear").show();
                                        $("#subOfficeYear").show();
                                        $("#businessYear").show();
                                        $("#businessMonth").show();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossAño1").click(function () {

                                        grafica_Boss_Year(pkbusiness01, año01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossAño2").click(function () {

                                        //alert(año01.toString());

                                        grafica01BossSegmentado(pkbusiness01, año01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                            }
                        }

                    });

                    chart.setAction({
                        id: 'month',
                        text: 'Mes',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                                data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            año01 = parametros.año;

                            for (var i = 0; i < data.length; i++) {

                                if (data[i].nameBusiness == name) {
                                    pkbusiness01 = data[i].pkBusiness;
                                }
                            }


                            chart.draw(view, options);
                            if (pkbusiness01 != 0 && año01 != 0) {

                                grafica_Business_Month(pkbusiness01, año01);
                                document.getElementById("idEmpresa").innerHTML =
                                    "Business Report" + name + " " + "of the" + " " + año01
                                    + " " + "for months";
                                document.getElementById("businessMonth").style.display = 'inline';
                                document.getElementById("BusinessMonth").innerHTML = "Business" + " " + name;
                                activaTab('nnn');
                            }



                        }
                    });
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Business por Mes-->
<script type="text/javascript">
    var mes04 = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Business_Month(pkBusiness, año) {
        
        var parametros = {
            pkBusiness: pkBusiness,
            año: año,
        }
        
        var urlMesBusiness = Report.Urls.reportMonthBusiness;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlMesBusiness,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Percentage of Effectiveness per Month - Business');
                    data1.addColumn('number', 'Below the criterion');

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };

                    $("#div_chart").css({ "height": "400px", "width": "auto" });
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            mes04 = data1.getValue(select.row, 0);

                            año01 = parametros.año;
                            pkbusiness01 = parametros.pkBusiness;
                            var name = "";
                            for (var i = 0; i < data.length; i++) {

                                if (data[i].pkBusiness == pkbusiness01) {
                                    name = data[i].nameBusiness;
                                }
                            }
                            if (pkbusiness01 != 0 && año01 != 0 && mes04 != "") {

                                grafica_Business_Day(pkbusiness01, año01, mes04);
                                document.getElementById("idEmpresa").innerHTML = " Business Report " + name + " " + "of" + " " + mes04 + " " + "of the" + " " + año01;
                                document.getElementById("BusinessDay").innerHTML = mes04 + " " + "of the" + " " + año01;
                                document.getElementById("businessDay").style.display = 'inline';
                                activaTab('mmm');
                            }
                        }
                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Business por Dia-->
<script type="text/javascript">

    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Business_Day(pkBusiness, año, month) {
        
        var parametros = {
            pkBusiness: pkBusiness,
            año: año,
            month: month
        }
        
        var urlDiaBusiness = Report.Urls.reportDayBusiness;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDiaBusiness,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Percentage of Effectiveness per day - Business');
                    data1.addColumn('number', 'Below the criterion');

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                            }
                        }
                    };

                    if (data.length <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Boss por Año-->
<script type="text/javascript">
    var pk_boss01 = 0;
    var name_boss = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Boss_Year(pkBusiness, año) {
        
        var parametros = {
            pkBusiness: pkBusiness,
            año: año
        }
        
        var urlYearBoss = Report.Urls.reportBoss;
        

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlYearBoss,
                data: { filtro: parametros },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'Boss');
                    data1.addColumn('number', 'Efficacy Percentage by Boss');
                    data1.addColumn('number', 'Below the criterion');

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].nameBoss, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].nameBoss, null, data[i].result]);
                            }
                        }
                    };

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    $("#btnBossAño1").show();
                    $("#btnBossAño2").show();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();
                    $("#GridView").hide();

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);

                    if (data.length <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistBA01');

                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    chart.setAction({
                        id: 'Agent',
                        text: 'Agent',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                                data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);

                            año01 = parametros.año;

                            for (var i = 0; i < data.length; i++) {

                                if (data[i].nameBoss == name) {
                                    pk_boss01 = data[i].pkBoss;
                                    name_boss = data[i].nameBoss;
                                }
                            }


                            chart.draw(view, options);
                            if (pk_boss01 != 0 && año01 != 0) {

                                grafica_Agent_Year(parametros.pkBusiness, pk_boss01, año01);
                                document.getElementById("AgentYear").innerHTML =
                                    "Agents Report" + " " + año01;
                                document.getElementById("agentYear").style.display = 'inline';
                                document.getElementById("idEmpresa").innerHTML =
                                    "Agents of " + " " + año01;
                                activaTab('rrr');
                                activaTab('vistAA01');

                                $(document).ready(function () {
                                    $("#AgentYear").click(function () {
                                        grafica_Agent_Year(parametros.pkBusiness, pk_boss01, año01);
                                        activaTab('vistAA01');
                                        $("#agentMonth").hide();
                                        $("#officeYear").show();
                                        $("#subOfficeYear").show();
                                        $("#businessYear").show();
                                        $("#BossYear01").show();
                                        $("#agentYear").show();

                                        $("#btnAgentAño1").show();
                                        $("#btnAgentAño2").show();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnAgentAño1").click(function () {

                                        grafica_Agent_Year(parametros.pkBusiness, pk_boss01, año01);


                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentAño2").click(function () {

                                        grafica01_Agent_Year(parametros.pkBusiness, pk_boss01, año01);


                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });


                            }
                        }
                    });
                    chart.setAction({
                        id: 'month',
                        text: 'Mes',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                                data1.getValue(chart.getSelection()[0].row, 1));
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            año01 = parametros.año;

                            for (var i = 0; i < data.length; i++) {

                                if (data[i].nameBoss == name) {
                                    pk_boss01 = [data[i].pkBoss];
                                }
                            }
                            chart.draw(view, options);
                            if (pk_boss01 != 0 && año01 != 0) {

                                Boss_Month(pk_boss01, año01);
                                document.getElementById("idEmpresa").innerHTML = "Report of Boss" + name + " " + "of the" + " " + año01 + " " + "for month";
                                document.getElementById("BossMonth").innerHTML = "Boss "
                                    + " " + name;
                                document.getElementById("bossMonth").style.display = 'inline';
                                activaTab('ppp');
                                activaTab('vistBM01');
                                $(document).ready(function () {
                                    $("#BossMonth").click(function () {
                                        Boss_Month(pk_boss01, año01);
                                        activaTab('vistBM01');
                                        $("#bossDay").hide();
                                        $("#subOfficeYear").show();
                                        $("#businessYear").show();
                                        $("#BossYear01").show();

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").show();
                                        $("#btnBossMes2").show();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossMes1").click(function () {

                                        Boss_Month(pk_boss01, año01);


                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossMes2").click(function () {
                                        grafica02(parametros.pkBusiness, pk_boss01, año01);
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });
                            }
                        }
                    });

                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Boss por Mes-->
<script type="text/javascript">
    var mes05 = "";
    var pkbusiness = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function Boss_Month(pkBoss, año) {
        
        var parametros = {
            pkBoss: pkBoss,
            año: año,
        }
        
        var urlMesBoss = Report.Urls.reportMonthBoss;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlMesBoss,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Efficacy Percentage per Month - Boss');
                    data1.addColumn('number', 'Below the criterion');

                    $("#btnBossMes1").show();
                    $("#btnBossMes2").show();

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };

                    $("#div_chart").css({ "height": "400px", "width": "auto" });
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            mes05 = data1.getValue(select.row, 0);

                            año01 = parametros.año;

                            pk_boss01 = parametros.pkBoss;

                            var name = "";
                            for (var i = 0; i < data.length; i++) {

                                if (data[i].pkBoss == pk_boss01) {
                                    name = data[i].nameBoss;
                                    pkbusiness = data[i].pkBusiness;
                                }
                            }

                            if (pk_boss01 != 0 && mes05 != "" && año01 != 0) {

                                grafica_Boss_Day(pk_boss01, mes05, año01);
                                document.getElementById("idEmpresa").innerHTML =
                                    " Report of Boss " + name + " " + "of" + " " + mes05
                                    + " " + "of the" + " " + año01;
                                document.getElementById("BossDay").innerHTML = mes05 + " "
                                    + "of the" + " " + año01;
                                document.getElementById("bossDay").style.display = 'inline';
                                activaTab('sss');
                                activaTab('vistBD01');
                                $(document).ready(function () {
                                    $("#btnBossDia1").click(function () {

                                        grafica_Boss_Day(pk_boss01, mes05, año01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossDia2").click(function () {

                                        grafica03(pkbusiness, pk_boss01, mes05, año01);
                                        
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                            }
                        }

                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Boss por Día-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Boss_Day(pkBoss, month, año) {
        
        var parametros = {
            pkBoss: pkBoss,
            month: month,
            año: año
        }
        
        var urlDiaBoss = Report.Urls.reportDayBoss;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDiaBoss,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Efficacy Percentage by day - Boss');
                    data1.addColumn('number', 'Below the criterion');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();
                    $("#btnBossDia1").show();
                    $("#btnBossDia2").show();
                    $("#GridView").hide();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);
                    console.log(parametros);
                    

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                            }
                        }
                    };

                    if (data.length <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));
                    chart.draw(view, options);

                },
                error: function () {
                    
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Agente por Año-->
<script type="text/javascript">
    var pk_agente01 = 0;
    var name_agent = "";
    var pkBusiness = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Agent_Year(pkBusiness, pkBoss, año) {
        
        var parametros = {
            pkBoss: pkBoss,
            año: año,
            pkBusiness: pkBusiness
        }
        
        var urlAgente = Report.Urls.reportAgent;
        
        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlAgente,
                data: { filtro: parametros },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'Agent');
                    data1.addColumn('number', 'Efficiency Percentage by Agent');
                    data1.addColumn('number', 'Below the criterion');

                    $("#btnAgentAño1").show();
                    $("#btnAgentAño2").show();

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();
                    $("#GridView").hide();

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].nameAgent, data[i].result, null]);
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].nameAgent, null, data[i].result]);
                            }
                        }
                    };

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);

                    if (data.length <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            año01 = parametros.año;
                            var name = data1.getValue(select.row, 0);
                            name_agent = name;
                            for (var i = 0; i < data.length; i++) {

                                if (data[i].nameAgent == name) {
                                    pk_agente01 = data[i].pkAgent;
                                    pkBusiness = data[i].pkBusiness;
                                }
                            }

                            if (pk_agente01 != 0 && año01 != 0) {

                                grafica_Agent_Month(pk_agente01, año01);
                                document.getElementById("idEmpresa").innerHTML =
                                    "Agent Report " + name + " " + "of the" + " " + año01
                                    + " " + "by months";
                                document.getElementById("AgentMonth").innerHTML = "Agent "
                                    + " " + name;
                                document.getElementById("agentMonth").style.display = 'inline';
                                activaTab('ttt');
                                activaTab('vistAM01');

                                $(document).ready(function () {
                                    $("#AgentMonth").click(function () {
                                        grafica_Agent_Month(pk_agente01, año01);
                                        activaTab('vistAM01');
                                        $("#agentDay").hide();
                                        $("#officeYear").show();
                                        $("#subOfficeYear").show();
                                        $("#businessYear").show();
                                        $("#BossYear01").show();
                                        $("#agentYear").show();
                                        $("#agentMonth").show();
                                        $("#btnAgentMes1").show();
                                        $("#btnAgentMes2").show();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();



                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentMes1").click(function () {

                                        grafica_Agent_Month(pk_agente01, año01);
                                        //           $("#agent_div_month").show();
                                        $("#div_chart").show();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentMes2").click(function () {

                                        grafica02_Agent_Month(pkBusiness, pk_agente01, año01);
                                        
                                        $("#div_chart").show();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Agente por Mes-->
<script type="text/javascript">
    var mes06 = "";
    var pkbusiness = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Agent_Month(pkAgent, año) {
        
        var parametros = {
            pkAgent: pkAgent,
            año: año,
        }
        
        var urlMesAgent = Report.Urls.reportMonthAgent;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlMesAgent,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Efficacy Percentage by Month - Agent');
                    data1.addColumn('number', 'Below the criterion');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();
                    $("#btnAgentMes1").show();
                    $("#btnAgentMes2").show();
                    $("#GridView").hide();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);
                    console.log(parametros);
                    

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };

                    $("#div_chart").css({ "height": "400px", "width": "auto" });
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            mes06 = data1.getValue(select.row, 0);

                            año01 = parametros.año;
                            pk_agente01 = parametros.pkAgent;
                            var name = "";
                            for (var i = 0; i < data.length; i++) {

                                if (data[i].pkAgent == pk_agente01) {
                                    name = data[i].nameAgent;
                                    pkbusiness = data[i].pkBusiness;
                                }
                            }

                            
                            if (pk_agente01 != 0 && mes06 != "" && año01 != 0) {

                                grafica_Agent_Day(pk_agente01, mes06, año01);
                                document.getElementById("idEmpresa").innerHTML =
                                    "Agent Report " + name + " " + "of" + " " + mes06
                                    + " " + "of the" + " " + año01;
                                document.getElementById("AgentDay").innerHTML = mes06 + " "
                                    + "of the" + " " + año01;
                                document.getElementById("agentDay").style.display = 'inline';
                                activaTab('ñññ');
                                activaTab('vistAD01');

                                //modificado
                                $(document).ready(function () {
                                    $("#AgentDay").click(function () {

                                        grafica_Agent_Day(pk_agente01, mes06, año01);


                                        $("#officeYear").show();
                                        $("#subOfficeYear").show();
                                        $("#businessYear").show();
                                        $("#bossYear").show();
                                        $("#agentYear").show();
                                        $("#agentCall").hide();
                                        $("#enterpriseMonth").hide();
                                        $("#enterpriseDay").hide();
                                        $("#officeMonth").hide();
                                        $("#officeDay").hide();
                                        $("#subOfficeMonth").hide();
                                        $("#subOfficeDay").hide();
                                        $("#businessMonth").hide();
                                        $("#businessDay").hide();
                                        $("#bossMonth").hide();
                                        $("#bossDay").hide();
                                        $("#agentMonth").show();
                                        $("#agentDay").show();
                                        $("#dayCall").hide();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").show();
                                        $("#btnAgentDia2").show();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();
                                        $("#GridView").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentDia1").click(function () {

                                        grafica_Agent_Day(pk_agente01, mes06, año01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();



                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentDia1").click(function () {

                                        grafica_Agent_Day(pk_agente01, mes06, año01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentDia2").click(function () {

                                        grafica03_Agent_Day(pkbusiness, pk_agente01, mes06, año01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();



                                    });
                                });


                            }
                        }
                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Agente por Día-->
<script type="text/javascript">
    var pkBusiness = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    var dia01 = "";
    function grafica_Agent_Day(pkAgent, month, año) {
        var parametros = {
            pkAgent: pkAgent,
            month: month,
            año: año
        }
        
        var urlDiaAgent = Report.Urls.reportDayAgent;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDiaAgent,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Efficacy Percentage by day- Agent');
                    data1.addColumn('number', 'Below the criterion');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();
                    $("#btnAgentDia1").show();
                    $("#btnAgentDia2").show();
                    $("#GridView").hide();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);

                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }
                    ]);
                    console.log(parametros);
                    
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1 && data[i].quantityCall == -1) {
                            data[i].result = null;
                            data[i].quantityCall == null;
                        }

                        if (data[i].result == 0.00 && data[i].quantityCall == -1) {
                            data[i].result = 0;
                            data[i].quantityCall = null;
                        }

                        if (data[i].result == -1 && data[i].quantityCall == 0) {
                            data[i].result = null;
                            data[i].quantityCall = 0;
                        }

                        if (data[i].result != -1 || data[i].quantityCall != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                                
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                                
                            }
                        }
                    };

                    console.log(data);

                    if (data.length <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    function selectItem() {
                        var name = "";
                        pk_agente01 = parametros.pkAgent;
                        for (var i = 0; i < data.length; i++) {

                            if (data[i].pkAgent == pk_agente01) {
                                name = data[i].nameAgent;
                                pkBusiness = data[i].pkBusiness;
                            }
                        };

                        var select = chart.getSelection()[0];
                        if (select) {


                            dia01 = data1.getValue(select.row, 0);

                            if (pk_agente01 != 0 && dia01 != "") {

                                Report_Call(pk_agente01, dia01);
                                
                                document.getElementById("agentCall").style.display = 'inline';
                                document.getElementById("AgentCall").innerHTML =
                                    "Agent Calls " + name + " " +
                                    "of the " + " " + dia01;
                                activaTab('yyy');
                                activaTab('vistAL01');

                                $(document).ready(function () {
                                    $("#btnAgentLlamada1").click(function () {

                                        Report_Call(pk_agente01, dia01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentLlamada2").click(function () {

                                        Report_Call_Segmentado(pkBusiness, pk_agente01, dia01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();
                                        $("#GridView").hide();

                                    });
                                });

                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Agente por llamada-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function Report_Call(pkAgent, dias) {
        
        var parametros = {
            pkAgent: pkAgent,
            dias: dias
        };
        
        var urlCallAgent = Report.Urls.reportCallAgent;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlCallAgent,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'Call');
                    data1.addColumn('number', 'Efficacy Percentage by Call - Agent');
                    data1.addColumn('number', 'Below the criterion');


                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").show();
                    $("#btnAgentLlamada2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    /* PK_AUDIO 04102017 */
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));
                    var fuenteData = data;
                    
                    var name = "";
                    for (var i = 0; i < data.length; i++) {

                        //if (data[i].pkAgent == pk_agente01) {
                            name = data[i].PK_Audio;
                        //}
                    }

                    //alert(name.toString());


                    //alert("Name pk_audio" + name.toString());
                    /** FINNNNNNNNNNNNN 04102017 */

                    var view = new google.visualization.DataView(data1);

                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        },

                    ], chbh = 40, 19, 100);

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {
                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].hora, data[i].result, null]);
                                
                            }
                            if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].hora, null, data[i].result]);
                            }
                        }
                    };

                    if (data.length <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }


                    if (eventoListener) {
                        google.visualization.events.removeListener(eventoListener);
                    }

                    chart.draw(view, options);

                    eventoListener = google.visualization.events.addListener(chart, 'select', function (e) {
                        var selection = chart.getSelection();
                        var indice = selection[0].row;
                         //alert(fuenteData[indice].pkAudio);
                        
                        var paramet = {
                            pkSection: 1,
                            pkAudio: fuenteData[indice].pkAudio
                        };

                        var urllistarNameRule = Report.Urls.reportNameRule;
                        //alert(paramet.pkAudio.toString());
                        //alert(urllistarNameRule.toString());

                        $.ajax({
                            type: 'POST',
                            url: urllistarNameRule,
                            data: {
                                filtro: paramet
                            },

                        }).done(function (data, textStatus, jqXhr) {
                            $("#GridView").html(data);
                            $("#GridView").show();
                        }).fail(function (data, textStatus, jqXhr) {
                            console.log(data);
                        });
                        
                        //recargar tabla
                    });
                    
                },
                error: function () {
                    
                    console.log(data);

                }

            })

        });
    }
    var eventoListener;

</script>

<!--Seccionado por Boss-->
<!--Seccionado de Boss por Año-->
<script type="text/javascript">

    //var año01 = 0;

    google.load("visualization", "1", { packages: ['corechart'] });
    function grafica01BossSegmentado(pkBusiness, año) {
        var parametros = {
            pkBusiness: pkBusiness,
            año: año,
        }
        //alert(año01.toString());
        
        urlBossAnio = Report.Urls.reportBossDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlBossAnio,
                data: { filtro: parametros },
                success: function (data) {

                    var data1 = new google.visualization.DataTable();


                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var countdata = countReg - 1;
                    var result = [];
                    var totl = countReg;
                    //Ingresa los datos
                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "nameBoss") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            if (parseInt(data[i].Value) == "") {
                                data[i].Value = 0;

                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "nameBoss") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);

                    $("#btnBossAño1").show();
                    $("#btnBossAño2").show();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();




                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection', showColorCode: true, isHtml: false },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'out',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistBA02');

                    document.getElementById("idEmpresa").innerHTML = "Report of Boss by year";
                    document.getElementById("BossYear").innerHTML = "Report of Boss by year";
                    $("#BossYear01").show();

                    document.getElementById("idEmpresa").innerHTML = "Report of Boss of the " + " " + '<b>' + año01 + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    chart.setAction({
                        id: 'Agent1',
                        text: 'Agent',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                                data1.getValue(chart.getSelection()[0].row, 1) + 20);
                            var name = data1.getValue(chart.getSelection()[0].row, 0);

                            for (var i = 0; i < data.length; i++) {

                                if (data[i].Header == "nameBoss") {
                                    if (data[i].Value == name) {
                                        pk_boss01 = data[i].pk_boss;
                                        año01 = data[i].year;
                                    }
                                }
                            }

                            chart.draw(data1, options);
                            if (parametros.pkBusiness != 0 && pk_boss01 != 0 && año01 != 0) {

                                grafica01_Agent_Year(parametros.pkBusiness, pk_boss01, año01);


                                document.getElementById("AgentYear").innerHTML = "Agents Report" + " " + año01;
                                document.getElementById("agentYear").style.display = 'inline';
                                activaTab('rrr');

                                $(document).ready(function () {
                                    $("#AgentYear").click(function () {

                                        grafica_Agent_Year(parametros.pkBusiness, pk_boss01, año01);

                                        $("#agentMonth").hide();
                                        $("#officeYear").show();
                                        $("#subOfficeYear").show();
                                        $("#businessYear").show();
                                        $("#BossYear01").show();
                                        $("#agentYear").show();
                                        $("#agentCall").hide();
                                        $("#btnAgentAño1").show();
                                        $("#btnAgentAño2").show();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();



                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnAgentAño1").click(function () {

                                        grafica_Agent_Year(parametros.pkBusiness, pk_boss01, año01);


                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentAño2").click(function () {

                                        grafica01_Agent_Year(parametros.pkBusiness, pk_boss01, año01);


                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });


                            }
                        }

                    });
                    chart.setAction({
                        id: 'Month',
                        text: 'Mes',
                        action: function () {
                            data1.setCell(chart.getSelection()[0].row, 1,
                                data1.getValue(chart.getSelection()[0].row, 1) - 20);
                            var name = data1.getValue(chart.getSelection()[0].row, 0);
                            name_boss = name;
                            for (var i = 0; i < data.length; i++) {

                                if (data[i].Header == "nameBoss") {
                                    if (data[i].Value == name) {
                                        pk_boss01 = data[i].pk_boss;
                                        año01 = data[i].year;
                                    }
                                }
                            }



                            chart.draw(data1, options);
                            if (pk_boss01 != 0 && año01 != "") {

                                grafica02(parametros.pkBusiness, pk_boss01, año01);

                                document.getElementById("BossMonth").innerHTML = "Boss " + " " + name_boss;
                                document.getElementById("bossMonth").style.display = 'inline';
                                activaTab('ppp');

                                $(document).ready(function () {
                                    $("#BossMonth").click(function () {

                                        Boss_Month(pk_boss01, año01);
                                        $("#bossDay").hide();
                                        $("#subOfficeYear").show();
                                        $("#businessYear").show();
                                        $("#BossYear01").show();

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").show();
                                        $("#btnBossMes2").show();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossMes1").click(function () {

                                        Boss_Month(pk_boss01, año01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").show();
                                        $("#btnBossMes2").show();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossMes2").click(function () {

                                        grafica02(parametros.pkBusiness, pk_boss01, año01);


                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").show();
                                        $("#btnBossMes2").show();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });
                            }

                        }
                    })

                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Seccionado de Boss por Mes-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica02(pkBusiness, pkBoss, año) {
        var parametros = {
            pkBusiness: pkBusiness,
            pkBoss: pkBoss,
            año: año,
        };
        
        urlBossMes = Report.Urls.reportBossMonthDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlBossMes,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    var data1 = new google.visualization.DataTable();

                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', 'mes');
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "Month") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }


                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "Month") {

                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);

                    $("#btnBossMes1").show();
                    $("#btnBossMes2").show();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistBM02');

                    document.getElementById("idEmpresa").innerHTML = "Report of Boss " + '<b>' + '«' + name_boss + '»' + '</b>' + " for months " + " " + '<b>' + parametros.año + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));
                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            mes05 = data1.getValue(select.row, 0);

                            año01 = parametros.año;
                            pk_boss01 = parametros.pkBoss;

                            for (var i = 0; i < data.length; i++) {

                                if (data[i].pkBoss == pk_boss01) {
                                    var name = data[i].nameBoss;
                                }
                            }
                            if (pk_boss01 != 0 && mes05 != "" && año01 != 0) {

                                grafica03(parametros.pkBusiness, pk_boss01, mes05, año01);


                                document.getElementById("BossDay").innerHTML = mes05 + " " + "of the" + " " + año01;
                                document.getElementById("bossDay").style.display = 'inline';
                                activaTab('sss');



                                $(document).ready(function () {
                                    $("#btnBossDia1").click(function () {

                                        grafica_Boss_Day(pk_boss01, mes05, año01);


                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").show();
                                        $("#btnBossDia2").show();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnBossDia2").click(function () {

                                        grafica03(parametros.pkBusiness, pk_boss01, mes05, año01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").show();
                                        $("#btnBossDia2").show();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                            }
                        }

                    }

                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    chart.draw(view, options);
                    google.visualization.events.addListener(chart, 'select', selectItem);
                },
                error: function () {

                    console.log(data);
                }
            })
        });
    }

</script>

<!--Seccionado de Boss por Dia-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica03(pk_business, pkBoss, month, año) {
        var parametros = {
            pkBusiness: pk_business,
            pkBoss: pkBoss,
            month: month,
            año: año
        };
        
        urlBossDia = Report.Urls.reportBossDayDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlBossDia,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();

                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', 'mes');
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "Datecreated") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }

                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "Datecreated") {

                            var value = data[i].Value.toString();
                            var rs = value.substring(0, 10);
                            result.push(rs);
                        }


                    }
                    data1.addRow(result);


                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };


                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();
                    $("#btnBossDia1").show();
                    $("#btnBossDia2").show();




                    if (data1.getNumberOfRows() <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }
                    activaTab('vistBD02');
                    document.getElementById("idEmpresa").innerHTML = "Business Report " + '<b>' + '«' + name_boss + '»' + '</b>' + " for days of the month " + " " + '<b>' + parametros.month + '</b>' + " of the " + '<b>' + parametros.año + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Seccionado por Agente-->
<!--Seccionado de Agente por Año-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica01_Agent_Year(BusinessId, pkBoss, año) {
        var parametros = {
            pkBusiness: BusinessId,
            pkBoss: pkBoss,
            añoPa: año
        }
        
        urlAgenteanio = Report.Urls.reportAgentYearDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlAgenteanio,
                data: { filtro: parametros },
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "nameAgent") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "nameAgent") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);


                    $("#btnAgentAño1").show();
                    $("#btnAgentAño2").show();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();


                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection', showColorCode: true, isHtml: false },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    activaTab('vistAA02');

                    if (data1.getNumberOfRows() <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }
                    document.getElementById("idEmpresa").innerHTML = "Agents Report " + " " + '<b>' + parametros.añoPa + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));
                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            año01 = parametros.añoPa;

                            var name = data1.getValue(select.row, 0);
                            name_agent = name;

                            for (var i = 0; i < data.length; i++) {
                                if (data[i].Header == "nameAgent") {
                                    if (data[i].Value == name) {
                                        pk_agente01 = data[i].pk_agent;

                                    }
                                }
                            }



                            if (pk_agente01 != 0 && año01 != 0) {


                                grafica02_Agent_Month(parametros.pkBusiness, pk_agente01, año01);

                                document.getElementById("AgentMonth").innerHTML = "Agent " + " " + name_agent;
                                document.getElementById("agentMonth").style.display = 'inline';
                                activaTab('ttt');


                                $(document).ready(function () {
                                    $("#AgentMonth").click(function () {

                                        grafica_Agent_Month(pk_agente01, año01);
                                        $("#agentDay").hide();
                                        $("#officeYear").show();
                                        $("#subOfficeYear").show();
                                        $("#businessYear").show();
                                        $("#BossYear01").show();
                                        $("#agentYear").show();
                                        $("#agentMonth").show();
                                        $("#btnAgentMes1").show();
                                        $("#btnAgentMes2").show();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();



                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentMes1").click(function () {

                                        grafica_Agent_Month(pk_agente01, año01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentMes2").click(function () {

                                        grafica02_Agent_Month(parametros.pkBusiness, pk_agente01, año01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();



                                    });
                                });

                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Seccionado de Agente por Mes-->
<script type="text/javascript">
    var name_agent = "";
    google.charts.load('current', { 'packages': ['corechart'] });

    function grafica02_Agent_Month(IdBusiness, pkAgent, año) {
        var parametros = {
            pkBusiness: IdBusiness,
            pkAgent: pkAgent,
            año: año
        }
        
        urlAgenteMes = Report.Urls.reportAgentMonthDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlAgenteMes,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "MONTH") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "MONTH") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);


                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();
                    $("#btnAgentMes1").show();
                    $("#btnAgentMes2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    activaTab('vistAM02');

                    if (data1.getNumberOfRows() <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }

                    document.getElementById("idEmpresa").innerHTML = "Agent Report " + '<b>' + '«' + name_agent + '»' + '</b>' + " by months " + " " + '<b>' + parametros.año + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            mes06 = data1.getValue(select.row, 0);

                            año01 = parametros.año;
                            pk_agente01 = parametros.pkAgent;

                            for (var i = 0; i < data.length; i++) {

                                if (data[i].pkAgent == pk_agente01) {
                                    name_agent = data[i].nameAgent;


                                }
                            }
                            if (pk_agente01 != 0 && mes06 != "" && año01 != 0) {

                                grafica03_Agent_Day(parametros.pkBusiness, pk_agente01, mes06, año01);


                                document.getElementById("AgentDay").innerHTML = mes06 + " "
                                    + "of the" + " " + año01;
                                document.getElementById("agentDay").style.display = 'inline';
                                activaTab('ñññ');


                                //modificado
                                $(document).ready(function () {
                                    $("#AgentDay").click(function () {

                                        grafica_Agent_Day(pk_agente01, mes06, año01);


                                        $("#officeYear").show();
                                        $("#subOfficeYear").show();
                                        $("#businessYear").show();
                                        $("#bossYear").show();
                                        $("#agentYear").show();
                                        $("#agentCall").hide();
                                        $("#enterpriseMonth").hide();
                                        $("#enterpriseDay").hide();
                                        $("#officeMonth").hide();
                                        $("#officeDay").hide();
                                        $("#subOfficeMonth").hide();
                                        $("#subOfficeDay").hide();
                                        $("#businessMonth").hide();
                                        $("#businessDay").hide();
                                        $("#bossMonth").hide();
                                        $("#bossDay").hide();
                                        $("#agentMonth").show();
                                        $("#agentDay").show();
                                        $("#dayCall").hide();
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").show();
                                        $("#btnAgentDia2").show();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentDia1").click(function () {

                                        grafica_Agent_Day(pk_agente01, mes06, año01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();



                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnAgentDia1").click(function () {

                                        grafica_Agent_Day(pk_agente01, mes06, año01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();



                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentDia2").click(function () {

                                        grafica03_Agent_Day(parametros.pkBusiness, pk_agente01, mes06, año01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();



                                    });
                                });
                            }
                        }

                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);

                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    chart.draw(view, options);

                    chart.draw(view, options);
                },
                error: function () {

                    console.log(data);
                }
            })
        });
    }

</script>

<!--Seccionado de Agente por Dia-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica03_Agent_Day(pk_Business, pkAgent, month, año) {
        var parametros = {
            pkBusiness: pk_Business,
            pkAgent: pkAgent,
            month: month,
            año: año
        }
        
        urlAgenteDia = Report.Urls.reportAgentDayDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlAgenteDia,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "DateCreated") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "DateCreated") {
                            var values = data[i].Value.toString();
                            var value = values.substring(0, 10);
                            result.push(value);
                        }


                    }
                    data1.addRow(result);


                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();
                    $("#btnAgentDia1").show();
                    $("#btnAgentDia2").show();


                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };





                    if (data1.getNumberOfRows() <= 12) {
                        $("#div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#div_chart").css({ "height": "400px", "width": ancho });
                    }
                    activaTab('vistAD02');
                    document.getElementById("idEmpresa").innerHTML = "Agent Report " + '<b>' + '«' + name_agent + '»' + '</b>' + " for days of the month " + " " + '<b>' + parametros.month + '</b>' + " of the " + '<b>' + parametros.año + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));
                    function selectItem() {
                        var select = chart.getSelection()[0];
                        
                        var name = "";
                        for (var i = 0; i < data.length; i++) {

                            if (data[i].pkAgent == pk_agente01) {
                                name = data[i].nameAgent;
                            }
                        }

                        if (select) {
                            pk_agente01 = parametros.pkAgent;
                            dia01 = data1.getValue(select.row, 0);
                            if (pk_agente01 != 0 && dia01 != "") {

                                Report_Call_Segmentado(parametros.pkBusiness, pk_agente01, dia01);
                                document.getElementById("agentCall").style.display = 'inline';
                                document.getElementById("AgentCall").innerHTML = "Agent Calls " + name + " " +
                                    "del " + " " + dia01;
                                activaTab('yyy');

                                $(document).ready(function () {
                                    $("#btnAgentLlamada1").click(function () {

                                        Report_Call(pk_agente01, dia01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentLlamada2").click(function () {

                                        Report_Call_Segmentado(parametros.pkBusiness, pk_agente01, dia01);

                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();
                                        $("#btnAgentLlamada1").hide();
                                        $("#btnAgentLlamada2").hide();


                                    });
                                });

                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);

                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Seccionado de Agente por Llamada-->
<script type="text/javascript">
    var pkaudio = 0;
    var nameSEc = "";
    var namesection = "";
    var sectionid = 0;
    var hora = "";
    var dataRule = [];


    var NumAccesosBd = 0
    NumAccesosBd += 1;

    if (NumAccesosBd == 1) {
        google.charts.load('current', { 'packages': ['corechart'] });
        function Report_Call_Segmentado(pkBusiness, pkAgent, dias) {
            var parametros = {
                pkBusiness: pkBusiness,
                pkAgent: pkAgent,
                dias: dias
            };

            urlAgenteLlamada = Report.Urls.reportAgentCallDinamico;

            $(function () {
                $.ajax({
                    type: 'POST',
                    url: urlAgenteLlamada,
                    data: {
                        filtro: parametros
                    },
                    dataType: 'json',
                    success: function (data) {
                        var data1 = new google.visualization.DataTable();

                        var countReg = data[0].TotalColumn;

                        for (var i = 0; i < countReg; i++) {
                            if (i == 0) {
                                data1.addColumn('string', data[i].Value);
                            }
                            else {
                                //var tamaño = data[i].Header.length;
                                //nameSEc = data[i].Header.substring(0, tamaño - 1);
                                //sectionid = data[i].Header.substring(tamaño - 1, tamaño);
                                //dataRule = [nameSEc,sectionid];
                                data1.addColumn('number', data[i].Header);
                            }
                        }

                        console.log(dataRule);

                        var result = [];
                        var totl = countReg;

                        for (var i = 0; i < data.length; i++) {

                            if (totl == i) {
                                totl += countReg;
                                data1.addRow(result);
                                result = [];
                            }
                            if (data[i].Header != "hours") {
                                if (parseInt(data[i].Value) == 0) {
                                    result.push(null);
                                }
                                else {
                                    result.push(parseFloat(data[i].Value));
                                }
                            } else if (data[i].Header == "hours") {
                                result.push(data[i].Value);
                            }


                        }
                        data1.addRow(result);

                        $("#btnBossAño1").hide();
                        $("#btnBossAño2").hide();
                        $("#btnAgentAño1").hide();
                        $("#btnAgentAño2").hide();
                        $("#btnBossMes1").hide();
                        $("#btnBossMes2").hide();
                        $("#btnBossDia1").hide();
                        $("#btnBossDia2").hide();
                        $("#btnAgentMes1").hide();
                        $("#btnAgentMes2").hide();
                        $("#btnAgentDia1").hide();
                        $("#btnAgentDia2").hide();
                        $("#btnAgentLlamada1").show();
                        $("#btnAgentLlamada2").show();


                        var options = {
                            chartArea: { width: '100%', height: '70%', left: 49, top: 50 },

                            backgroundColor: 'transparent',
                            curveType: "function",
                            fontSize: "12",
                            isStacked: true,
                            legend: { position: 'top', maxLines: 15 },
                            //pointShape: 'square',
                            displayAnnotations: true,
                            tooltip: { trigger: 'selection', showColorCode: true, isHtml: true },
                            vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                            bar: { groupWidth: 40 },
                            //animation: {
                            //    duration: 2000,
                            //    easing: 'linear',
                            //    startup: true
                            //},
                            annotations: {
                                boxStyle: {
                                    stroke: '#888',
                                    strokeWidth: 1,
                                    rx: 10,
                                    ry: 10,
                                    gradient: {
                                        color1: '#fbf6a7',
                                        color2: '#33b679',
                                        x1: '0%', y1: '0%',
                                        x2: '100%', y2: '100%',
                                        useObjectBoundingBoxUnits: true
                                    }
                                }
                            },

                        };






                        if (data1.getNumberOfRows() <= 12) {
                            $("#div_chart").css({ "height": "400px", "width": "auto" });
                        }
                        else if (data1.getNumberOfRows() > 12) {
                            var ancho = 100 * data1.getNumberOfRows();
                            $("#div_chart").css({ "height": "400px", "width": ancho });
                        }

                        activaTab('vistAL02');
                        document.getElementById("idEmpresa").innerHTML = "Agent Report " + '<b>' + '«' + name_agent + '»' + '</b>' + " of calls from " + '<b>' + parametros.dias + '</b>';
                        var chart = new google.visualization.ColumnChart(document.getElementById("div_chart"));

                        var id_section = 0;

                        google.visualization.events.addListener(chart, 'select', function () {
                            var selects = chart.getSelection();
                            for (var i = 0; i < selects.length; i++) {
                                var item = selects[i];
                                //alert("::" + item.column);
                                //alert("==>" + item.row);
                                //alert("pk" + item.pkAudio.toString())
                                if (item.row != null && item.column != null) {
                                    var index = item.column;
                                    hora = data1.getValue(item.row, 0);

                                    ///alert("&&&&&&" + data1.getValue(item.row, i.toString()));
                                    
                                    //alert("&&&&&&1" + data1.getValue(item.row, 1));
                                    //alert("&&&&&&2" +data1.getValue(item.row, 2));
                                    //alert("&&&&&&3" +data1.getValue(item.row, 3));

                                    namesection = data1.getColumnLabel(index);

                                }
                            }
                        });


                        for (var i = 1; i < data.length; i++) {

                            var tamaño = data[i].Header.length;
                            nameSEc = data[i].Header.substring(0, tamaño - 1);
                            sectionid = data[i].Header.substring(tamaño - 1, tamaño);

                            data: dataRule,
                                (data.columns = [
                                    { title: "NameSection" },
                                    { title: "PkSection" }
                                ])
                            dataRule = [[nameSEc], [sectionid]];
                            //alert("rugledataRule);
                        }


                        var urlIDseecton = Report.Urls.idsection;
                        $.ajax({
                            type: 'POST',
                            url: urlIDseecton,
                            data: {},
                            dataType: 'json',
                            success: function (data) {
                                for (var i = 0; i < data.length; i++) {
                                    var length = data[i].name.length;
                                    if (data[i].name == namesection) {
                                        id_section = data[i].pkSection;
                                        document.getElementById("idsection").innerHTML = id_section;


                                    }
                                }
                            },

                            error: function (data) {
                                console.log(data);
                            }

                        });

                        var pkSection_id = document.getElementById("idsection").textContent;

                        for (var i = 0; i < data.length; i++) {
                            if (data[i].Value == hora) {
                                pkaudio = data[i].pkAudio;
                            }
                        }

                        //alert(pkSection_id.toString());
                        //alert("Audio" + pkaudio.toString());

                        var paramet = {
                            pkSection: pkSection_id,
                            pkAudio: pkaudio
                        };

                        var urllist_rule = Report.Urls.reportListaRule;
                        $.ajax({
                            type: 'POST',
                            url: urllist_rule,
                            data: {
                                filtro: parametros
                            },
                            dataType: 'json',
                            success: function (data) {
                                for (var i = 0; i < data.length; i++) {
                                    var name_section
                                }
                            },
                            error: function (data) {
                                console.log(data);
                            }

                        });

                        var urllistarNameRule = Report.Urls.reportNameRule;
                        //alert(" Url ::::" + Report.Urls.reportNameRule.toString());

                        $.ajax({
                            type: 'POST',
                            url: urllistarNameRule,
                            data: {
                                filtro: paramet
                            },

                        }).done(function (data, textStatus, jqXhr) {
                            $("#GridView").html(data);
                            $("#GridView").show();
                        }).fail(function (data, textStatus, jqXhr) {
                            console.log(data);
                        });

                        var view = new google.visualization.DataView(data1);

                        if (countReg == 1) {
                            view.setColumns([0
                            ]);
                        }
                        if (countReg == 2) {
                            view.setColumns([0, 1,
                                {
                                    calc: "stringify",
                                    sourceColumn: 1,
                                    type: "string",
                                    role: "annotation"
                                }
                            ]);
                        }
                        if (countReg == 3) {
                            view.setColumns([0, 1,
                                {
                                    calc: "stringify",
                                    sourceColumn: 1,
                                    type: "string",
                                    role: "annotation"
                                }, 2,
                                {
                                    calc: "stringify",
                                    sourceColumn: 2,
                                    type: "string",
                                    role: "annotation"
                                }
                            ]);
                        }
                        if (countReg == 4) {

                            view.setColumns([0, 1,
                                {
                                    calc: "stringify",
                                    sourceColumn: 1,
                                    type: "string",
                                    role: "annotation"
                                }, 2,
                                {
                                    calc: "stringify",
                                    sourceColumn: 2,
                                    type: "string",
                                    role: "annotation"
                                }, 3,
                                {
                                    calc: "stringify",
                                    sourceColumn: 3,
                                    type: "string",
                                    role: "annotation"
                                }
                            ]);
                        }
                        if (countReg == 5) {

                            view.setColumns([0, 1,
                                {
                                    calc: "stringify",
                                    sourceColumn: 1,
                                    type: "string",
                                    role: "annotation"
                                }, 2,
                                {
                                    calc: "stringify",
                                    sourceColumn: 2,
                                    type: "string",
                                    role: "annotation"
                                }, 3,
                                {
                                    calc: "stringify",
                                    sourceColumn: 3,
                                    type: "string",
                                    role: "annotation"
                                }, 4,
                                {
                                    calc: "stringify",
                                    sourceColumn: 4,
                                    type: "string",
                                    role: "annotation"
                                }
                            ]);
                        }
                        if (countReg == 6) {
                            //alert("6" + countReg.toString());
                            view.setColumns([0, 1,
                                {
                                    calc: "stringify",
                                    sourceColumn: 1,
                                    type: "string",
                                    role: "annotation"
                                }, 2,
                                {
                                    calc: "stringify",
                                    sourceColumn: 2,
                                    type: "string",
                                    role: "annotation"
                                }, 3,
                                {
                                    calc: "stringify",
                                    sourceColumn: 3,
                                    type: "string",
                                    role: "annotation"
                                }, 4,
                                {
                                    calc: "stringify",
                                    sourceColumn: 4,
                                    type: "string",
                                    role: "annotation"
                                }, 5,
                                {
                                    calc: "stringify",
                                    sourceColumn: 5,
                                    type: "string",
                                    role: "annotation"
                                }
                            ]);
                        }
                        if (countReg == 7) {
                            //alert("6" + countReg.toString());
                            view.setColumns([0, 1,
                                {
                                    calc: "stringify",
                                    sourceColumn: 1,
                                    type: "string",
                                    role: "annotation"
                                }, 2,
                                {
                                    calc: "stringify",
                                    sourceColumn: 2,
                                    type: "string",
                                    role: "annotation"
                                }, 3,
                                {
                                    calc: "stringify",
                                    sourceColumn: 3,
                                    type: "string",
                                    role: "annotation"
                                }, 4,
                                {
                                    calc: "stringify",
                                    sourceColumn: 4,
                                    type: "string",
                                    role: "annotation"
                                }, 5,
                                {
                                    calc: "stringify",
                                    sourceColumn: 5,
                                    type: "string",
                                    role: "annotation"
                                }, 6,
                                {
                                    calc: "stringify",
                                    sourceColumn: 6,
                                    type: "string",
                                    role: "annotation"
                                }
                            ]);
                        }
                        if (countReg == 8) {
                            //alert("6" + countReg.toString());
                            view.setColumns([0, 1,
                                {
                                    calc: "stringify",
                                    sourceColumn: 1,
                                    type: "string",
                                    role: "annotation"
                                }, 2,
                                {
                                    calc: "stringify",
                                    sourceColumn: 2,
                                    type: "string",
                                    role: "annotation"
                                }, 3,
                                {
                                    calc: "stringify",
                                    sourceColumn: 3,
                                    type: "string",
                                    role: "annotation"
                                }, 4,
                                {
                                    calc: "stringify",
                                    sourceColumn: 4,
                                    type: "string",
                                    role: "annotation"
                                }, 5,
                                {
                                    calc: "stringify",
                                    sourceColumn: 5,
                                    type: "string",
                                    role: "annotation"
                                }, 6,
                                {
                                    calc: "stringify",
                                    sourceColumn: 6,
                                    type: "string",
                                    role: "annotation"
                                }, 7,
                                {
                                    calc: "stringify",
                                    sourceColumn: 7,
                                    type: "string",
                                    role: "annotation"
                                }
                            ]);
                        }
                        if (countReg == 9) {
                            //alert("6" + countReg.toString());
                            view.setColumns([0, 1,
                                {
                                    calc: "stringify",
                                    sourceColumn: 1,
                                    type: "string",
                                    role: "annotation"
                                }, 2,
                                {
                                    calc: "stringify",
                                    sourceColumn: 2,
                                    type: "string",
                                    role: "annotation"
                                }, 3,
                                {
                                    calc: "stringify",
                                    sourceColumn: 3,
                                    type: "string",
                                    role: "annotation"
                                }, 4,
                                {
                                    calc: "stringify",
                                    sourceColumn: 4,
                                    type: "string",
                                    role: "annotation"
                                }, 5,
                                {
                                    calc: "stringify",
                                    sourceColumn: 5,
                                    type: "string",
                                    role: "annotation"
                                }, 6,
                                {
                                    calc: "stringify",
                                    sourceColumn: 6,
                                    type: "string",
                                    role: "annotation"
                                }, 7,
                                {
                                    calc: "stringify",
                                    sourceColumn: 7,
                                    type: "string",
                                    role: "annotation"
                                }
                                , 8,
                                {
                                    calc: "stringify",
                                    sourceColumn: 8,
                                    type: "string",
                                    role: "annotation"
                                }
                            ]);
                        }
                        if (countReg == 10) {
                            //alert("6" + countReg.toString());
                            view.setColumns([0, 1,
                                {
                                    calc: "stringify",
                                    sourceColumn: 1,
                                    type: "string",
                                    role: "annotation"
                                }, 2,
                                {
                                    calc: "stringify",
                                    sourceColumn: 2,
                                    type: "string",
                                    role: "annotation"
                                }, 3,
                                {
                                    calc: "stringify",
                                    sourceColumn: 3,
                                    type: "string",
                                    role: "annotation"
                                }, 4,
                                {
                                    calc: "stringify",
                                    sourceColumn: 4,
                                    type: "string",
                                    role: "annotation"
                                }, 5,
                                {
                                    calc: "stringify",
                                    sourceColumn: 5,
                                    type: "string",
                                    role: "annotation"
                                }, 6,
                                {
                                    calc: "stringify",
                                    sourceColumn: 6,
                                    type: "string",
                                    role: "annotation"
                                }, 7,
                                {
                                    calc: "stringify",
                                    sourceColumn: 7,
                                    type: "string",
                                    role: "annotation"
                                }
                                , 8,
                                {
                                    calc: "stringify",
                                    sourceColumn: 8,
                                    type: "string",
                                    role: "annotation"
                                }
                                , 9,
                                {
                                    calc: "stringify",
                                    sourceColumn: 9,
                                    type: "string",
                                    role: "annotation"
                                }
                            ]);

                        }
                        chart.draw(view, options);
                    },
                    error: function () {
                        console.log(data);
                    }
                }
                )
            });
        }

    }


</script>
