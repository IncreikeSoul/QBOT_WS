@model Call.Cloud.Mvc.Models.Effectiveness.ListaReportAgent
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<head>
    <script type="text/javascript">
        var Report = Report || {};
        Report.Urls = Report.Urls || {};
        Report.Urls.baseUrl = '@Url.Action("~")';
        Report.Urls.reportAgent = '@Url.Action("Chart_Agent_Year_Vertical", "Report_Effectiveness_Agent")';
        Report.Urls.reportMonthAgent = '@Url.Action("Chart_Agent_Month", "Report_Effectiveness_Agent")';
        Report.Urls.reportDayAgent = '@Url.Action("Chart_Agent_Day", "Report_Effectiveness_Agent")';
        Report.Urls.reportCallAgent = '@Url.Action("Agent_LLamada", "Report_Effectiveness_Agent")';
        Report.Urls.reportSegmentadoAgent = '@Url.Action("Agent_Year", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoMonthAgent = '@Url.Action("Agent_Month", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoDayAgent = '@Url.Action("Agent_Day", "Report_Effectiveness_Business")';
        Report.Urls.reportSegmentadoCallAgent = '@Url.Action("Report_Agent_call", "Report_Effectiveness_Business")';
        //dinámico
        Report.Urls.reportAgentYearDinamico = '@Url.Action("dinamico_agent_Year", "Report_Effectiveness_Agent")';
        Report.Urls.reportAgentMonthDinamico = '@Url.Action("dinamico_agent_Month", "Report_Effectiveness_Agent")';
        Report.Urls.reportAgentDayDinamico = '@Url.Action("dinamico_Agent_Day", "Report_Effectiveness_Agent")';
        Report.Urls.reportAgentCallDinamico = '@Url.Action("dinamico_Agent_Call", "Report_Effectiveness_Agent")';
    
    
    </script>

    <link href="~/Content/css/chartist.min.css" rel="stylesheet" />
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>

<div class="page animsition">
    <div class="page-header">          
        <div class="form-group form-material">
            <div class="col-sm-12">
                <div class="col-sm-3" style="width:150px;height:40px;"></div>
               <div class="col-sm-3" style="width:150px;height:40px;">
                    <h5>@Html.Label("pkBoss", "Boss", htmlAttributes: new { @class = "control-label col-sm-2" })</h5>
               </div>
                <div class="col-sm-3 text-right" style="width:700px;height:40px;">
                    @Html.DropDownListFor(model => model.Filtro.pkAgent, Model.ListarBoss, new { @class = "form-control" })
                </div>
                <div class="col-sm-3 text-right" style="width:100px;height:40px;">
                    <button id="btnBuscar" class="btn btn-primary" type="button" onclick="grafica_Agent_Year();">Buscar</button>
                </div> 
            </div>
         </div>
     </div>         

    <!--Navegacion-->
    <div class="panel-body">
        <div class="form-group form-material">
            <h2 id="idEmpresa" style="text-align:center;color:chocolate"> </h2>                   
            <ul class="nav nav-tabs" style="float:left;">
                <li id="agentYear"><a href="#aaa" id="AgentYear" style="color:chocolate; border-bottom:groove"></a></li>
                <li id="agentMonth"><a href="#bbb" id="AgentMonth" style="color:darkred; border-bottom:groove"></a></li>
                <li id="agentDay"><a href="#ccc" id="AgentDay" style="color:darkred; border-bottom:groove"></a></li>
                <li id="agentCall"><a href="#ddd" id="AgentCall" style="color:chocolate; border-bottom:groove"></a></li>

            </ul>
        </div>

        <!--Los div donde se ven las barras-->
            <div class="form-group form-material">
                <div id="divGrid01" class="col-sm-12">
                    <br />
                    <div class="col-sm-1">
                        <ul class="nav nav-tabs" style="float:left;">
                            <li><a href="#vistAA01" data-toggle="tab" id="btnAgentAño1" style="display:none; ">Vista1</a></li>
                            <li><a href="#vistAA02" data-toggle="tab" id="btnAgentAño2" style="display: none; ">Vista2</a></li>
                        </ul>

                        <ul class="nav nav-tabs" style="float:left;">
                            <li><a href="#vistAM01" data-toggle="tab" id="btnAgentMes1" style="display:none; ">Vista1</a></li>
                            <li><a href="#vistAM02" data-toggle="tab" id="btnAgentMes2" style="display: none; ">Vista2</a></li>
                        </ul>

                        <ul class="nav nav-tabs" style="float:left;">
                            <li><a href="#vistAD01" data-toggle="tab" id="btnAgentDia1" style="display:none; ">Vista1</a></li>
                            <li><a href="#vistAD02" data-toggle="tab" id="btnAgentDia2" style="display: none; ">Vista2</a></li>
                        </ul>

                        <ul class="nav nav-tabs" style="float:left;">
                            <li><a href="#vistAL01" data-toggle="tab" id="btnAgentLlamada1" style="display:none; ">Vista1</a></li>
                            <li><a href="#vistAL02" data-toggle="tab" id="btnAgentLlamada2" style="display: none; ">Vista2</a></li>
                        </ul>
                    </div>

                    <div id="contenedor" class="tab-content" style="overflow-x:scroll; overflow-y:hidden">
                        <div class="col-sm-11">
                            <div id="agent_div_chart" style="width:auto;"></div>

                        </div>
                    </div>
        </div>
     </div>
  </div>
</div>

<!--Activa tabs-->
<script>
    function activaTab(tab) {
        $('.nav-tabs a[href="#' + tab + '"]').tab('show');
    };
    function desactivartab(tab) {
        $('.nav-tabs a[href="#' + tab + '"]').tab('hide');
    }

</script>

<!--Ocultar navegacion-->
<script>
    $(document).ready(function () {
        document.getElementById("agentYear").style.display = 'none';
        document.getElementById("agentMonth").style.display = 'none';
        document.getElementById("agentDay").style.display = 'none';
        document.getElementById("agentCall").style.display = 'none';
        document.getElementById("contenedor").style.display = 'none';
    })
</script>

<!--Agente por Año-->
<script type="text/javascript">
    var YEAR = 0;
    var PKAGENT = 0;
    var Boss = 0;
    var pkBusiness = 0;
    var name_Agent = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Agent_Year() {
        
        Boss= $("#Filtro_pkAgent").val();
        $("#contenedor").show();

        var parametros = {
            pkAgent: Boss
        }
        
        var urlAgente = Report.Urls.reportAgent;
        
        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlAgente,
                data: { filtro: parametros },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'Agent');
                    data1.addColumn('number', 'Reporte de Eficacia por Año - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');
                    $("#btnAgentAño1").show();
                    $("#btnAgentAño2").show();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").hide();
                    $("#btnAgentLlamada2").hide();

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].nameAgent, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].nameAgent, null, data[i].result]);
                            }
                        }
                    };


                    $(document).ready(function () {
                        $("#AgentYear").click(function () {
                                grafica_Agent_Year();
                                $("#agentMonth").hide();
                                $("#agentDay").hide();
                                $("#agentCall").hide();
                                $("#btnBossAño1").hide();
                                $("#btnBossAño2").hide();
                                $("#btnBossMes1").hide();
                                $("#btnBossMes2").hide();
                                $("#btnBossDia1").hide();
                                $("#btnBossDia2").hide();
                                $("#btnAgentAño1").show();
                                $("#btnAgentAño2").show();
                                $("#btnAgentMes1").hide();
                                $("#btnAgentMes2").hide();
                                $("#btnAgentDia1").hide();
                                $("#btnAgentDia2").hide();
                                $("#btnAgentLlamada1").hide();
                                $("#btnAgentLlamada2").hide();

                        });
                    });

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].pkBoss==Boss) {
                            YEAR = data[i].año;
                            pkBusiness = data[i].pkBusiness;
                        }

                    }

                    $(document).ready(function () {
                        $("#btnAgentAño1").click(function () {
                            grafica_Agent_Year();
                            $("#btnBossAño1").hide();
                            $("#btnBossAño2").hide();
                        });
                    });
                    $(document).ready(function () {
                        $("#btnAgentAño2").click(function () {
                            if (Boss!=0) {
                                grafica01_Agent_Year(pkBusiness,Boss, YEAR);
                            }
                            $("#btnBossAño1").hide();
                            $("#btnBossAño2").hide();
                        });
                    });
                  
                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection' },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    document.getElementById("AgentYear").innerHTML = "Reporte de Agentes";
                    $("#agentYear").show();
                    document.getElementById("idEmpresa").innerHTML = "Reporte de Agentes";
                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);

                    activaTab('aaa');

                    if (data.length <= 12) {
                        $("#agent_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#agent_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAA01');

                    var chart = new google.visualization.ColumnChart(document.getElementById("agent_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            var name = data1.getValue(select.row, 0);
                            name_Agent = name;
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].nameAgent == name) {
                                    PKAGENT = data[i].pkAgent;
                                    YEAR = data[i].año;
                                    
                                }
                            }


                            if (PKAGENT != 0 && YEAR != 0) {
                                    grafica_Agent_Month(PKAGENT, YEAR);
                                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + name + " " + "del" + " " + YEAR + " " + "por meses";
                                    document.getElementById("AgentMonth").innerHTML = "Agente " + " " + name;
                                    $("#agentMonth").show();
                                    activaTab('bbb');
                                    activaTab('vistAM01');
                                $(document).ready(function () {
                                    $("#AgentMonth").click(function () {
                                        grafica_Agent_Month(PKAGENT, YEAR);
                                        activaTab('vistAM01');
                                            $("#agentMonth").show();
                                            $("#agentDay").hide();                                            
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").show();
                                            $("#btnAgentMes2").show();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();
                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnAgentMes1").click(function () {
                                        grafica_Agent_Month(PKAGENT, YEAR);

                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnAgentMes2").click(function () {
                                        grafica02_Agent_Month(pkBusiness,PKAGENT, YEAR);
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                    });
                                });


                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Agente por Mes-->
<script type="text/javascript">
    var AÑO = 0;
    var Agent_id = 0;
    var MONTH = "";
    var pkBusiness = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Agent_Month(pkAgent, año) {
        
        var parametros = {
            pkAgent: pkAgent,
            año: año,
        }
        
        var urlMesAgent = Report.Urls.reportMonthAgent;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlMesAgent,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'month');
                    data1.addColumn('number', 'Reporte de Eficacia por Mes - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").show();
                    $("#btnAgentMes2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);
                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);


                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].month, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].month, null, data[i].result]);
                            }
                        }
                    };

                    $("#agent_div_chart").css({ "height": "400px", "width": "auto" });
                    var chart = new google.visualization.ColumnChart(document.getElementById("agent_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            var name = "";
                            var mes = data1.getValue(select.row, 0);
                            MONTH = mes
                            AÑO = parametros.año;
                            Agent_id = parametros.pkAgent;
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].pkAgent == Agent_id) {
                                    name = [data[i].nameAgent];
                                    pkBusiness=data[i].pkBusiness;
                                }
                            }


                            if (Agent_id != 0 && MONTH != "" && AÑO != 0) {

                                    grafica_Agent_Day(Agent_id, MONTH, AÑO);
                                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + name + " " + "de" + " " + MONTH + " " + "del" + " " + AÑO;
                                    document.getElementById("AgentDay").innerHTML = MONTH + " " + "del" + " " + AÑO;
                                    $("#agentDay").show();
                                    activaTab('ccc');
                                    activaTab('vistAD01');

                                $(document).ready(function () {
                                    $("#AgentDay").click(function () {

                                            grafica_Agent_Day(Agent_id, MONTH, AÑO);
                                            activaTab('vistAD01');
                                            $("#bossMonth").hide();
                                            $("#bossDay").hide();
                                            $("#agentMonth").show();
                                            $("#agentDay").show();                                            
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").show();
                                            $("#btnAgentDia2").show();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();

                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnAgentDia1").click(function () {

                                            grafica_Agent_Day(Agent_id, MONTH, AÑO);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();



                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentDia2").click(function () {

                                        grafica03_Agent_Day(pkBusiness,Agent_id, MONTH, AÑO);
                                            $("#Agent_div_Day").show();
                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();


                                    });
                                });

                            }
                        }
                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);
                }
            })
        });
    }

</script>

<!--Agente por Día-->
<script type="text/javascript">
    var Agente_id = 0;
    var Day = "";
    var pkBusiness = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica_Agent_Day(pkAgent, month, año) {
        var parametros = {
            pkAgent: pkAgent,
            month: month,
            año: año
        }
        
        var urlDiaAgent = Report.Urls.reportDayAgent;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlDiaAgent,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'day');
                    data1.addColumn('number', 'Reporte de Eficacia por dia - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").show();
                    $("#btnAgentDia2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);

                    view.setColumns([0, 1,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 1,
                                        type: "string",
                                        role: "annotation"
                                    }, 2,
                                    {
                                        calc: "stringify",
                                        sourceColumn: 2,
                                        type: "string",
                                        role: "annotation"
                                    }
                    ]);

                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].dias, data[i].result, null]);
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].dias, null, data[i].result]);
                            }
                        }
                    };

                    if (data.length <= 12) {
                        $("#agent_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data.length > 12) {
                        var ancho = 100 * data.length;
                        $("#agent_div_chart").css({ "height": "400px", "width": ancho });
                    }
                    var chart = new google.visualization.ColumnChart(document.getElementById("agent_div_chart"));

                    function selectItem() {
                        var name = "";
                        for (var i = 0; i < data.length; i++) {
                            if (data[i].pkAgent == parametros.pkAgent) {
                                name = data[i].nameAgent;
                                pkBusiness = data[i].pkBusiness;
                            }
                        };

                        var select = chart.getSelection()[0];
                        if (select) {
                            Agente_id = parametros.pkAgent;
                            Day = data1.getValue(select.row, 0);

                            if (Agente_id != 0 && Day != "") {

                                Report_Call(Agente_id, Day);
                                document.getElementById("agentCall").style.display = 'inline';
                                document.getElementById("AgentCall").innerHTML = "Llamadas del agente " + parametros.pkAgent + " " + "del mes" + " " + Day;
                                
                                activaTab('ddd');
                                activaTab('vistAL01');

                                $(document).ready(function () {
                                    $("#btnAgentLlamada1").click(function () {
                                        Report_Call(Agente_id, Day);
                                        $("#btnBossAño1").hide();
                                        $("#btnBossAño2").hide();
                                        $("#btnAgentAño1").hide();
                                        $("#btnAgentAño2").hide();
                                        $("#btnBossMes1").hide();
                                        $("#btnBossMes2").hide();
                                        $("#btnBossDia1").hide();
                                        $("#btnBossDia2").hide();
                                        $("#btnAgentMes1").hide();
                                        $("#btnAgentMes2").hide();
                                        $("#btnAgentDia1").hide();
                                        $("#btnAgentDia2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentLlamada2").click(function () {

                                        Report_Call_Segmentado(pkBusiness, Agente_id, Day);

                                            $("#btnBossAño1").hide();
                                            $("#btnBossAño2").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnBossMes1").hide();
                                            $("#btnBossMes2").hide();
                                            $("#btnBossDia1").hide();
                                            $("#btnBossDia2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();



                                    });
                                });

                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    chart.draw(view, options);
                },
                error: function () {
                    
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Agente por llamada-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function Report_Call(pkAgent, dias) {
        
        var parametros = {
            pkAgent: pkAgent,
            dias: dias
        };
        
        var urlCallAgent = Report.Urls.reportCallAgent;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlCallAgent,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    data1.addColumn('string', 'Call');
                    data1.addColumn('number', 'Reporte de Eficacia por Llamada - Agent');
                    data1.addColumn('number', 'Por debajo del criterio');

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").show();
                    $("#btnAgentLlamada2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    var view = new google.visualization.DataView(data1);

                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        }, 2,
                        {
                            calc: "stringify",
                            sourceColumn: 2,
                            type: "string",
                            role: "annotation"
                        }

                    ]);


                    for (var i = 0; i < data.length; i++) {
                        if (data[i].result == -1) {
                            data[i].result = null;
                        }

                        if (data[i].result == 0.00) {
                            data[i].result = 0;
                        }

                        if (data[i].result != -1) {

                            if (data[i].result >= data[i].criterio) {
                                data1.addRow([data[i].hora, data[i].result, null]);
                                
                            }
                            else if (data[i].result < data[i].criterio) {
                                data1.addRow([data[i].hora, null, data[i].result]);
                            }
                        }
                    };

                    console.log(data);

                    if (data.length <= 10) {
                        $("#agent_div_chart").css({ "height": "500px", "width": "auto" });
                    }
                    else if (data.length > 10) {
                        var ancho = 100 * data.length;
                        $("#agent_div_chart").css({ "height": "500px", "width": ancho });
                    }

                    var chart = new google.visualization.ColumnChart(document.getElementById("agent_div_chart"));
                    chart.draw(view, options);
                    
                },
                error: function () {
                    
                    console.log(data);

                }

            })

        });
    }

</script>

<!--Seccionado por Agente-->
<!--Seccionado de Agente por Año-->
<script type="text/javascript">
    var Year04 = 0;
    var pk_agent04 = 0;
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica01_Agent_Year(pk_business,pkBoss, año) {
        var parametros = {
            pkBusiness: pk_business,
            pkBoss: pkBoss,
            añoPa: año
        }
        
        urlAgenteanio = Report.Urls.reportAgentYearDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: urlAgenteanio,
                data: { filtro: parametros },
                success: function (data) {
                    var data1 = new google.visualization.DataTable();

                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "nameAgent") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "nameAgent") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);

                    $("#btnAgentAño1").show();
                    $("#btnAgentAño2").show();
                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();



                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { trigger: 'selection', showColorCode: true, isHtml: false },

                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };


                    $(document).ready(function () {
                        $("#AgentYear").click(function () {

                            grafica_Agent_Year();


                            $("#agentMonth").hide();
                            $("#agentDay").hide();
                            $("#agentCall").hide();

                            $("#btnBossAño1").hide();
                            $("#btnBossAño2").hide();
                            $("#btnBossMes1").hide();
                            $("#btnBossMes2").hide();
                            $("#btnBossDia1").hide();
                            $("#btnBossDia2").hide();
                            $("#btnAgentAño1").show();
                            $("#btnAgentAño2").show();
                            $("#btnAgentMes1").hide();
                            $("#btnAgentMes2").hide();
                            $("#btnAgentDia1").hide();
                            $("#btnAgentDia2").hide();
                            $("#btnAgentLlamada1").hide();
                            $("#btnAgentLlamada2").hide();

                        });
                    });


                    if (data1.getNumberOfRows() <= 12) {
                        $("#agent_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#agent_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAA02');
                    document.getElementById("idEmpresa").innerHTML = "Reporte de Agentes " + parametros.añoPa;
                    var chart = new google.visualization.ColumnChart(document.getElementById("agent_div_chart"));
                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                            YEAR = parametros.añoPa;
                            var name = data1.getValue(select.row, 0);
                            name_Agent = name;
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].Header == "nameAgent") {
                                    if (data[i].Value == name) {
                                        PKAGENT = data[i].pk_agent;
                                        YEAR = data[i].year;
                                    }
                                }
                            }



                            if (PKAGENT != 0 && YEAR != 0) {


                                grafica02_Agent_Month(parametros.pkBusiness, PKAGENT, YEAR);

                                    document.getElementById("AgentMonth").innerHTML = "Agente " + " " + name;
                                    $("#agentMonth").show();
                                    activaTab('bbb');


                                $(document).ready(function () {
                                    $("#AgentMonth").click(function () {

                                        grafica_Agent_Month(PKAGENT, YEAR);


                                            $("#agentMonth").show();
                                            $("#agentDay").hide();


                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").show();
                                            $("#btnAgentMes2").show();
                                            $("#btnAgentDia1").hide();
                                            $("#btnAgentDia2").hide();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();

                                    });
                                });

                                $(document).ready(function () {
                                    $("#btnAgentMes1").click(function () {

                                            grafica_Agent_Month(PKAGENT, YEAR);


                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();


                                    });
                                });
                                $(document).ready(function () {
                                    $("#btnAgentMes2").click(function () {

                                        grafica02_Agent_Month(parametros.pkBusiness, PKAGENT, YEAR);

                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();

                                    });
                                });
                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    //chart.draw(data1, options);
                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    chart.draw(view, options);

                },
                error: function () {
                    console.log(data);
                }
            })
        });
    }
</script>

<!--Seccionado de Agente por Mes-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    var mes05 = "";
    var año05 = 0;
    var pkAgent05 = 0;
    function grafica02_Agent_Month(pk_business,pkAgent, año) {
        var parametros = {
            pkBusiness: pk_business,
            pkAgent: pkAgent,
            año: año
        };
        
        urlAgenteMes = Report.Urls.reportAgentMonthDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlAgenteMes,
                dataType: 'json',
                data: {
                    filtro: parametros
                },
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "MONTH") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "MONTH") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);

                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnAgentMes1").show();
                    $("#btnAgentMes2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };
                    
                    if (data1.getNumberOfRows() <= 12) {
                        $("#agent_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#agent_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAM02');
                
                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + '<b>' + '«' + name_Agent + '»' + '</b>' + " " + "por meses de" + " " + '<b>' + parametros.año + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("agent_div_chart"));

                    function selectItem() {
                        var select = chart.getSelection()[0];
                        if (select) {
                             MONTH = data1.getValue(select.row, 0);

                            AÑO = parametros.año;
                            Agent_id = parametros.pkAgent;
                            for (var i = 0; i < data.length; i++) {
                                var array = new Array();
                                if (data[i].pkAgent == Agent_id) {
                                    name = data[i].nameAgent;


                                }
                            }

                            if (Agent_id != 0 && MONTH != "" && AÑO != "") {

                                    grafica03_Agent_Day(parametros.pkBusiness, Agent_id, MONTH, AÑO);

                                    document.getElementById("AgentDay").innerHTML = MONTH + " " + "del" + " " + AÑO;
                                    $("#agentDay").show();
                                    activaTab('ccc');

                                $(document).ready(function () {
                                    $("#AgentDay").click(function () {

                                            grafica_Agent_Day(Agent_id, MONTH, AÑO);



                                            $("#agentMonth").show();
                                            $("#agentDay").show();
                                            $("#agentCall").hide();
                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();
                                            $("#btnAgentDia1").show();
                                            $("#btnAgentDia2").show();
                                            $("#btnAgentLlamada1").hide();
                                            $("#btnAgentLlamada2").hide();


                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnAgentDia1").click(function () {


                                            grafica_Agent_Day(Agent_id, MONTH, AÑO);


                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();


                                    });
                                });


                                $(document).ready(function () {
                                    $("#btnAgentDia2").click(function () {

                                        grafica03_Agent_Day(parametros.pkBusiness, Agent_id, MONTH, AÑO);


                                            $("#btnAgentAño1").hide();
                                            $("#btnAgentAño2").hide();
                                            $("#btnAgentMes1").hide();
                                            $("#btnAgentMes2").hide();



                                    });
                                });


                            }
                        }

                    }

                    google.visualization.events.addListener(chart, 'select', selectItem);
                    //chart.draw(data1, options);
                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    chart.draw(view, options);

                },
                error: function () {

                    console.log(data);
                }
            })
        });
    }

</script>

<!--Seccionado de Agente por Dia-->
<script type="text/javascript">
    var pkAgent06 = 0;
    var dias06 = "";
    google.charts.load('current', { 'packages': ['corechart'] });
    function grafica03_Agent_Day(pk_business,pkAgent, month, año) {
        var parametros = {
            pkBusiness: pk_business,
            pkAgent: pkAgent,
            month: month,
            año: año
        }
        
        urlAgenteDia = Report.Urls.reportAgentDayDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlAgenteDia,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "DateCreated") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "DateCreated") {
                            var values = data[i].Value.toString();
                            var value = values.substring(0, 10);
                            result.push(value);
                        }


                    }
                    data1.addRow(result);


                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").show();
                    $("#btnAgentDia2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#agent_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#agent_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAD02');
              
                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + '<b>' + '«' + name_Agent + '»' + '</b>' + " por dias del mes " + '<b>' + parametros.month + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("agent_div_chart"));
                    function selectItem() {
                        var select = chart.getSelection()[0];
                        Agente_id = parametros.pkAgent;
                        Day = data1.getValue(select.row, 0);
                        var name = "";
                        for (var i = 0; i < data.length; i++) {
                            var array = new Array();
                            if (data[i].pkAgent == Agente_id) {
                                name = data[i].nameAgent;

                            }
                        }

                        $(document).ready(function () {
                            $("#btnAgentLlamada1").click(function () {

                                    Report_Call(Agente_id, Day);


                                    $("#btnAgentAño1").hide();
                                    $("#btnAgentAño2").hide();
                                    $("#btnBossMes1").hide();
                                    $("#btnBossMes2").hide();
                                    $("#btnBossDia1").hide();
                                    $("#btnBossDia2").hide();
                                    $("#btnAgentMes1").hide();
                                    $("#btnAgentMes2").hide();
                                    $("#btnAgentDia1").hide();
                                    $("#btnAgentDia2").hide();


                            });
                        });


                        $(document).ready(function () {
                            $("#btnAgentLlamada2").click(function () {

                                    Report_Call_Segmentado( parametros.pkBusiness,Agente_id, Day);


                                    $("#btnAgentAño1").hide();
                                    $("#btnAgentAño2").hide();
                                    $("#btnBossMes1").hide();
                                    $("#btnBossMes2").hide();
                                    $("#btnBossDia1").hide();
                                    $("#btnBossDia2").hide();
                                    $("#btnAgentMes1").hide();
                                    $("#btnAgentMes2").hide();
                                    $("#btnAgentDia1").hide();
                                    $("#btnAgentDia2").hide();



                            });
                        });


                        if (select) {
                            if (Agente_id != 0 && Day != "") {

                                    Report_Call_Segmentado(parametros.pkBusiness,Agente_id, Day);
                                    document.getElementById("AgentCall").innerHTML = "Llamadas del Agente " +name_Agent + " " + "del" + " " + Day;
                                    document.getElementById("agentCall").style.display = 'inline';

                                  activaTab('ddd');

                            }
                        }
                    }
                    google.visualization.events.addListener(chart, 'select', selectItem);
                    //chart.draw(data1, options);
                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    chart.draw(view, options);

                },
                error: function () {
                    console.log(data);

                }
            })
        });
    }

</script>

<!--Seccionado de Agente por Llamada-->
<script type="text/javascript">
    google.charts.load('current', { 'packages': ['corechart'] });
    function Report_Call_Segmentado(pk_business,pkAgent, dias) {
        var parametros = {
            pkBusiness: pk_business,
            pkAgent: pkAgent,
            dias: dias
        };
        
        urlAgenteLlamada = Report.Urls.reportAgentCallDinamico;
        

        $(function () {
            $.ajax({
                type: 'POST',
                url: urlAgenteLlamada,
                data: {
                    filtro: parametros
                },
                dataType: 'json',
                success: function (data) {
                    
                    var data1 = new google.visualization.DataTable();
                    var countReg = data[0].TotalColumn;

                    for (var i = 0; i < countReg; i++) {
                        if (i == 0) {
                            data1.addColumn('string', data[i].Value);
                        }
                        else {
                            data1.addColumn('number', data[i].Header);
                        }
                    }


                    var result = [];
                    var totl = countReg;

                    for (var i = 0; i < data.length; i++) {

                        if (totl == i) {
                            totl += countReg;
                            data1.addRow(result);
                            result = [];
                        }
                        if (data[i].Header != "hours") {
                            if (parseInt(data[i].Value) == 0) {
                                result.push(null);
                            }
                            else {
                                result.push(parseFloat(data[i].Value));
                            }
                        } else if (data[i].Header == "hours") {
                            result.push(data[i].Value);
                        }


                    }
                    data1.addRow(result);

                    $("#btnBossAño1").hide();
                    $("#btnBossAño2").hide();
                    $("#btnAgentAño1").hide();
                    $("#btnAgentAño2").hide();
                    $("#btnBossMes1").hide();
                    $("#btnBossMes2").hide();
                    $("#btnBossDia1").hide();
                    $("#btnBossDia2").hide();
                    $("#btnAgentMes1").hide();
                    $("#btnAgentMes2").hide();
                    $("#btnAgentDia1").hide();
                    $("#btnAgentDia2").hide();
                    $("#btnAgentLlamada1").show();
                    $("#btnAgentLlamada2").show();

                    var options = {
                        chartArea: { width: '100%', height: '70%', left: 49, top: 50 },
                        backgroundColor: 'transparent',
                        curveType: "function",
                        fontSize: "12",
                        isStacked: true,
                        legend: { position: 'top', maxLines: 15 },
                        tooltip: { showColorCode: true, isHtml: false },
                        vAxis: { format: '#\'%\'', ticks: [0, 20, 40, 60, 80, 100] },
                        //bar: { groupWidth: 40 },
                        //animation: {
                        //    duration: 2000,
                        //    easing: 'linear',
                        //    startup: true
                        //},
                        annotations: {
                            boxStyle: {
                                stroke: '#888',
                                strokeWidth: 1,
                                rx: 10,
                                ry: 10,
                                gradient: {
                                    color1: '#fbf6a7',
                                    color2: '#33b679',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%',
                                    useObjectBoundingBoxUnits: true
                                }
                            }
                        },

                    };

                    if (data1.getNumberOfRows() <= 12) {
                        $("#agent_div_chart").css({ "height": "400px", "width": "auto" });
                    }
                    else if (data1.getNumberOfRows() > 12) {
                        var ancho = 100 * data1.getNumberOfRows();
                        $("#agent_div_chart").css({ "height": "400px", "width": ancho });
                    }

                    activaTab('vistAL02');
                  
                    document.getElementById("idEmpresa").innerHTML = "Reporte del Agente " + '<b>' + '«' + name_Agent + '»' + '</b>' + " de las llamadas del " + '<b>' + parametros.dias + '</b>';
                    var chart = new google.visualization.ColumnChart(document.getElementById("agent_div_chart"));
                    //chart.draw(data1, options);
                    var view = new google.visualization.DataView(data1);

                    if (countReg == 1) {
                        view.setColumns([0
                        ]);
                    }
                    if (countReg == 2) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 3) {
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 4) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 5) {

                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 6) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 7) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 8) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 9) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    if (countReg == 10) {
                        //alert("6" + countReg.toString());
                        view.setColumns([0, 1,
                            {
                                calc: "stringify",
                                sourceColumn: 1,
                                type: "string",
                                role: "annotation"
                            }, 2,
                            {
                                calc: "stringify",
                                sourceColumn: 2,
                                type: "string",
                                role: "annotation"
                            }, 3,
                            {
                                calc: "stringify",
                                sourceColumn: 3,
                                type: "string",
                                role: "annotation"
                            }, 4,
                            {
                                calc: "stringify",
                                sourceColumn: 4,
                                type: "string",
                                role: "annotation"
                            }, 5,
                            {
                                calc: "stringify",
                                sourceColumn: 5,
                                type: "string",
                                role: "annotation"
                            }, 6,
                            {
                                calc: "stringify",
                                sourceColumn: 6,
                                type: "string",
                                role: "annotation"
                            }, 7,
                            {
                                calc: "stringify",
                                sourceColumn: 7,
                                type: "string",
                                role: "annotation"
                            }
                            , 8,
                            {
                                calc: "stringify",
                                sourceColumn: 8,
                                type: "string",
                                role: "annotation"
                            }
                            , 9,
                            {
                                calc: "stringify",
                                sourceColumn: 9,
                                type: "string",
                                role: "annotation"
                            }
                        ]);
                    }
                    chart.draw(view, options);

                },
                error: function () {
                    console.log(data);
                }

            })

        });
    }

</script>

<!--extraccion de id de negocio-->
<script>

    //pk_Busines
    $("#Filtro_pkAgent").change(function () {
        var selecte = this.value;
        var pk_business = 0;
        $.ajax({
            ype: 'POST',
            url: '@Url.Action("list_IDBusiness_agent", "Report_Effectiveness_Agent")',
            data: {},
            dataType: 'json',
            success: function (data) {
                for (var i = 0; i < data.length; i++) {
                    if (data[i].pkBoss == selecte) {
                        pk_business = data[i].pkBusiness;
                        document.getElementById("id_business").innerHTML = pk_business;
                    }
                }
            },
            error: function (data) {
                console.log(data);
            }

        })

    })
</script>